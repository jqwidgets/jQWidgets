/*
jQWidgets v5.0.0 (2017-Aug)
Copyright (c) 2011-2017 jQWidgets.
License: http://jqwidgets.com/license/
*/
!function(e){e.extend(e.jqx._jqxGrid.prototype,{savestate:function(t){var i=this.getstate();return void 0===t||e.isEmptyObject(t)||(-1==t.indexOf("sort")&&(delete i.sortcolumn,delete i.sortdirection),-1==t.indexOf("pager")&&(delete i.pagenum,delete i.pagesizeoptions,delete i.pagesize),-1==t.indexOf("selection")&&(delete i.selectedcells,delete i.selectedrowindexes,delete i.selectedrowindex),-1==t.indexOf("grouping")&&delete i.groups,-1==t.indexOf("filter")&&delete i.filters,e.each(this.columns.records,function(e){var s=i.columns[this.datafield];-1==t.indexOf("hidden_columns")&&delete s.hidden,-1==t.indexOf("reorder")&&delete s.index,-1==t.indexOf("columns_width")&&delete s.width,-1==t.indexOf("columns_text")&&delete s.text,-1==t.indexOf("alignment")&&(delete s.align,delete s.cellsalign)})),window.localStorage&&(window.localStorage["jqxGrid"+this.element.id]=this._stringify(i)),this._savedstate=i,i},loadstate:function(t,i){s="";if(void 0!=t&&void 0!=t.width)s=t;else if(window.localStorage){if(window.localStorage["jqxGrid"+this.element.id])s=e.parseJSON(window.localStorage["jqxGrid"+this.element.id])}else if(this._savedstate)var s=this._savedstate;if(null!=s&&""!==s){(this.virtualmode||this.source._source.url&&""!=this.source._source.url)&&this.source.beginUpdate();var r=s;if(void 0!==r.width&&(this.width=r.width),void 0!==r.height&&(this.height=r.height),this.pageable&&(void 0!=r.pagesize&&(this.pagesize=r.pagesize,this.dataview.pagesize=r.pagesize),void 0!=r.pagenum&&(this.dataview.pagenum=r.pagenum),void 0!=r.pagesizeoptions&&(this.pagesizeoptions=r.pagesizeoptions),this.pagesizeoptions)){for(var o=0,l=0;l<this.pagesizeoptions.length;l++)this.pagesize>=this.pagesizeoptions[l]&&(o=l);this.pagershowrowscombo&&this.pagershowrowscombo.jqxDropDownList({selectedIndex:o})}if(this.sortable)if(this._loading&&(this._loading=!1),r.sortdirection){if(r.sortdirection.ascending||r.sortdirection.descending){this.dataview.sortfield=r.sortcolumn;var a=r.sortdirection.ascending?"asc":"desc";this.dataview.sortfielddirection=a,this.source.sortcolumn=r.sortcolumn,this.source.sortdirection=a,this.sortby(r.sortcolumn,a)}}else null==this.dataview.sortfield||"asc"!=this.dataview.sortfielddirection&&"desc"!=this.dataview.sortfielddirection||this.sortby(this.dataview.sortfield,null);this.groupable&&r.groups&&(this.dataview.groups=r.groups,this.groups=r.groups),this.loadingstate=!0,this.virtualsizeinfo&&this._loadselectionandcolumnwidths(r),this.loadingstate=!1,(this.virtualmode||this.source._source.url&&""!=this.source._source.url)&&(1==i?this.source.endUpdate(!1):(this.source.endUpdate(!1),(this.virtualmode||this.source._source.filter||this.source._source.sort)&&this.updatebounddata("state")))}},_loadselectionandcolumnwidths:function(t){this.loadingstate=!0;i="";if(void 0!=t&&void 0!=t.width)i=t;else if(window.localStorage){if(window.localStorage["jqxGrid"+this.element.id])i=e.parseJSON(window.localStorage["jqxGrid"+this.element.id])}else if(this._savedstate)var i=this._savedstate;if(null!=i&&""!=i){var s=this._loading;this._loading=!1;var r=i,o=this,l=!1,a=[];a.length=0;if(e.each(this.columns.records,function(e){var t=r.columns[this.datafield];if(void 0!=t){if(this.text!=t.text&&(l=!0),this.hidden!=t.hidden&&(l=!0),void 0!==t.width&&(this.width=t.width,this._width&&(this._width=null),this._percentagewidth&&(this._percentagewidth=null)),void 0!==t.hidden&&(this.hidden=t.hidden),void 0!==t.pinned&&(this.pinned=t.pinned),void 0!==t.groupable&&(this.groupable=t.groupable),void 0!==t.resizable&&(this.resizable=t.resizable),this.draggable=t.draggable,void 0!==t.text&&(this.text=t.text),void 0!==t.align&&(this.align=t.align),void 0!==t.cellsalign&&(this.cellsalign=t.cellsalign),o._columns)for(var i=0;i<o._columns.length;i++)o._columns[i].datafield==this.datafield&&(void 0!==t.hidden&&(o._columns[i].hidden=t.hidden),void 0!==t.width&&(o._columns[i].width=t.width));void 0!==t.index&&(a[this.datafield]=t.index,a.length++)}}),a.length>0){if(this.setcolumnindex){this.rowdetails;this.groupable?this.groups.length:0;for(var n=new Array,d=0;d<this.columns.records.length;d++)n.push(this.columns.records[d]);for(var h=0,c=new Array,d=0;d<n.length;d++){var f=n[d],u=a[f.datafield];if(this.groupable&&f.grouped)h++;else if(0==d&&this.rowdetails)h++;else if(d!==u||this.groupable||this.rowdetails){var g=h+u;c.push({column:f,key:g})}}c.sort(function(e,t){return e.key<t.key?-1:e.key>t.key?1:0}),c.reverse(),e.each(c,function(e,t){var i=this.key;o.setcolumnindex(this.column.datafield,i,!1)})}this.prerenderrequired=!0,this.groupable&&this._refreshdataview(),this.rendergridcontent(!0),this._updatefilterrowui&&this.filterable&&this.showfilterrow&&this._updatefilterrowui(),this._renderrows(this.virtualsizeinfo)}if(this.filterable&&void 0!==r.filters){this.clearfilters&&(this._loading=!1,this.clearfilters(!1));for(var p="",v=new e.jqx.filter,d=0;d<r.filters.filterscount;d++){var w=r.filters["filtercondition"+d],m=r.filters["filterdatafield"+d],f=this.getcolumn(m);if(m!=p&&(v=new e.jqx.filter),p=m,f&&f.filterable){var x=r.filters["filtervalue"+d],_=r.filters["filteroperator"+d];if("datefilter"==(z=r.filters["filtertype"+d]))D=v.createfilter(z,x,w,null,f.cellsformat,this.gridlocalization);else D=v.createfilter(z,x,w);if(v.addfilter(_,D),this.showfilterrow){var b=f._filterwidget,y=f._filterwidget.parent();if(null!=b)switch(f.filtertype){case"number":if(y.find("input").val(x),this.host.jqxDropDownList){var j=v.getoperatorsbyfiltertype("numericfilter");b.find(".filter").jqxDropDownList("selectIndex",j.indexOf(w))}break;case"date":this.host.jqxDateTimeInput?e(y.children()[0]).jqxDateTimeInput("setDate",x):b.val(x);break;case"range":if(this.host.jqxDateTimeInput){var q=r.filters["filtervalue"+(d+1)],z=r.filters["filtertype"+d],D=v.createfilter(z,q,"LESS_THAN_OR_EQUAL");v.addfilter(_,D);var O=new Date(x),k=new Date(q);isNaN(O)&&(O=e.jqx.dataFormat.tryparsedate(x)),isNaN(k)&&(k=e.jqx.dataFormat.tryparsedate(x)),e(y.children()[0]).jqxDateTimeInput("setRange",O,k),d++}else b.val(x);break;case"textbox":case"default":b.val(x),o["_oldWriteText"+b[0].id]=x;break;case"list":if(this.host.jqxDropDownList){var S=e(y.children()[0]).jqxDropDownList("getItems"),u=-1;e.each(S,function(e){if(this.value==x)return u=e,!1}),e(y.children()[0]).jqxDropDownList("selectIndex",u)}else b.val(x);break;case"checkedlist":this.host.jqxDropDownList||b.val(x);break;case"bool":case"boolean":this.host.jqxCheckBox?e(y.children()[0]).jqxCheckBox({checked:x}):b.val(x)}}this.addfilter(m,v)}}r.filters&&r.filters.filterscount>0&&(this.applyfilters(),this.showfilterrow&&e.each(this.columns.records,function(){if("checkedlist"==this.filtertype&&this.filterable&&o.host.jqxDropDownList){var t=this,i=t._filterwidget,s=(i.jqxDropDownList("getItems"),i.jqxDropDownList("listBox"));if(s.checkAll(!1),t.filter){s.uncheckAll(!1);for(var r=t.filter.getfilters(),l=0;l<s.items.length;l++){var a=s.items[l].label;e.each(r,function(){if("NOT_EQUAL"==this.condition)return!0;a==this.value&&s.checkIndex(l,!1,!1)})}s._updateCheckedItems();var n=s.getCheckedItems().length;s.items.length!=n&&n>0&&s.host.jqxListBox("indeterminateIndex",0,!0,!1)}}})),this.pageable&&void 0!==r.pagenum&&(this.gotopage&&!this.virtualmode?(this.dataview.pagenum=-1,this.gotopage(r.pagenum)):this.gotopage&&this.virtualmode&&this.gotopage(r.pagenum))}if(r.selectedrowindexes&&r.selectedrowindexes&&r.selectedrowindexes.length>0&&(this.selectedrowindexes=r.selectedrowindexes,this.selectedrowindex=r.selectedrowindex,"checkbox"===this.selectionmode&&this._updatecheckboxselection()),r.selectedcells&&this._applycellselection&&e.each(r.selectedcells,function(){o._applycellselection(this.rowindex,this.datafield,!0,!1)}),this.groupable&&void 0!==r.groups)return this._refreshdataview(),this.render(),this._loading=s,void(this.loadingstate=!1);if(l){if(this.prerenderrequired=!0,this.rendergridcontent(!0),this._loading=s,this.loadingstate=!1,this.updating())return!1}else this._loading=s,this._updatecolumnwidths(),this._updatecellwidths(),this.loadingstate=!1;this.loadingstate=!1,this._loading=s,this._renderrows(this.virtualsizeinfo)}this.loadingstate=!1},getstate:function(){var t=this.getdatainformation(),i={};if(i.width=this.width,i.height=this.height,i.pagenum=t.paginginformation.pagenum,i.pagesize=t.paginginformation.pagesize,i.pagesizeoptions=this.pagesizeoptions,i.sortcolumn=t.sortinformation.sortcolumn,i.sortdirection=t.sortinformation.sortdirection,null!=this.selectionmode&&this.getselectedcells)if(-1!=this.selectionmode.toString().indexOf("cell")){var s=this.getselectedcells(),r=new Array;e.each(s,function(){r.push({datafield:this.datafield,rowindex:this.rowindex})}),i.selectedcells=r}else{var o=this.getselectedrowindexes();i.selectedrowindexes=o,i.selectedrowindex=this.selectedrowindex}var l={},a=0;if(this.dataview.filters)for(var n=0;n<this.dataview.filters.length;n++){var d=this.dataview.filters[n].datafield,h=this.dataview.filters[n].filter,c=h.getfilters();l[d+"operator"]=h.operator;for(var f=0;f<c.length;f++){if(c[f].datafield=d,"datefilter"==c[f].type)if(c[f].value&&c[f].value.toLocaleString){var u=this.getcolumn(c[f].datafield);if(u.cellsformat){var g=this.source.formatDate(c[f].value,u.cellsformat,this.gridlocalization);l["filtervalue"+a]=g||c[f].value.toLocaleString()}else l["filtervalue"+a]=c[f].value.toLocaleString()}else l["filtervalue"+a]=c[f].value;else l["filtervalue"+a]=c[f].value;l["filtercondition"+a]=c[f].condition,l["filteroperator"+a]=c[f].operator,l["filterdatafield"+a]=d,l["filtertype"+a]=c[f].type,a++}}l.filterscount=a,i.filters=l,i.groups=this.groups,i.columns={};var p=0;return this.columns.records&&e.each(this.columns.records,function(e,t){if(!this.datafield)return!0;var s={};s.width=this.width,s.hidden=this.hidden,s.pinned=this.pinned,s.groupable=this.groupable,s.resizable=this.resizable,s.draggable=this.draggable,s.text=this.text,s.align=this.align,s.cellsalign=this.cellsalign,s.index=p++,i.columns[this.datafield]=s}),i},_stringify:function(e){if(window.JSON&&"function"==typeof window.JSON.stringify){var t=this,i="";try{i=window.JSON.stringify(e)}catch(i){return t._str("",{"":e})}return i}return i=this._str("",{"":e})},_quote:function(e){var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return'"'+e.replace(t,function(e){var t=i[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"'},_stringifyArray:function(e){for(var t=e.length,i=[],s=0;s<t;s++)i.push(this._str(s,e)||"null");return"["+i.join(",")+"]"},_stringifyObject:function(e){var t,i,s=[],r=this;for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i=r._str(t,e))&&s.push(r._quote(t)+":"+i);return"{"+s.join(",")+"}"},_stringifyReference:function(e){switch(Object.prototype.toString.call(e)){case"[object Array]":return this._stringifyArray(e)}return this._stringifyObject(e)},_stringifyPrimitive:function(e,t){switch(t){case"string":return this._quote(e);case"number":return isFinite(e)?e:"null";case"boolean":return e}return"null"},_str:function(e,t){var i=t[e],s=typeof i;return i&&"object"==typeof i&&"function"==typeof i.toJSON&&(s=typeof(i=i.toJSON(e))),/(number|string|boolean)/.test(s)||!i&&"object"===s?this._stringifyPrimitive(i,s):this._stringifyReference(i)}})}(jqxBaseFramework);


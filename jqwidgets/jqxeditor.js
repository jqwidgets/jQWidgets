/*
jQWidgets v5.0.0 (2017-Aug)
Copyright (c) 2011-2017 jQWidgets.
License: http://jqwidgets.com/license/
*/
!function(e){e.jqx.jqxWidget("jqxEditor","",{}),e.extend(e.jqx._jqxEditor.prototype,{defineInstance:function(){var t={width:null,height:null,disabled:!1,pasteMode:"html",editable:!0,lineBreak:"default",changeType:null,toolbarPosition:"top",fontFamily:"sans-serif",commands:{bold:{tooltip:"Bold",command:"bold",type:"toggleButton"},italic:{tooltip:"Italic",command:"italic",type:"toggleButton"},underline:{tooltip:"Underline",command:"underline",type:"toggleButton"},format:{placeHolder:"Format Block",tooltip:"Format Block",command:"formatblock",value:[{value:"p",label:"Paragraph"},{value:"h1",label:"Header 1"},{value:"h2",label:"Header 2"},{value:"h3",label:"Header 3"},{value:"h4",label:"Header 4"}],type:"list",width:120,dropDownWidth:190,height:25},font:{placeHolder:"Font",tooltip:"Font Name",command:"fontname",value:[{label:"Arial",value:"Arial, Helvetica, sans-serif"},{label:"Comic Sans MS",value:'"Comic Sans MS", cursive, sans-serif'},{label:"Courier New",value:'"Courier New", Courier, monospace'},{label:"Georgia",value:"Georgia,serif"},{label:"Impact",value:"Impact,Charcoal,sans-serif"},{label:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{label:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{label:"Times New Roman",value:"'Times New Roman',Times,serif"},{label:"Trebuchet MS",value:'"Trebuchet MS",Helvetica,sans-serif'},{label:"Verdana",value:"Verdana,Geneva,sans-serif"}],type:"list",width:160,height:25,dropDownWidth:160},size:{placeHolder:"Size",tooltip:"Font Size",command:"fontsize",value:[{label:"1 (8pt)",value:"xx-small"},{label:"2 (10pt)",value:"x-small"},{label:"3 (12pt)",value:"small"},{label:"4 (14pt)",value:"medium"},{label:"5 (18pt)",value:"large"},{label:"6 (24pt)",value:"x-large"},{label:"7 (36pt)",value:"xx-large"}],type:"list",width:45,height:25,dropDownWidth:160},color:{tooltip:"Text Color",command:"forecolor",value:"#000",type:"colorPicker"},background:{tooltip:"Fill Color",command:"backcolor",value:"#fff",type:"colorPicker"},left:{tooltip:"Align Left",command:"justifyleft",type:"toggleButton"},center:{tooltip:"Align Center",command:"justifycenter",type:"toggleButton"},right:{tooltip:"Align Right",command:"justifyright",type:"toggleButton"},outdent:{tooltip:"Indent Less",command:"outdent",type:"button"},indent:{tooltip:"Indent More",command:"indent",type:"button"},ul:{tooltip:"Insert unordered list",command:"insertunorderedlist",type:"toggleButton"},ol:{tooltip:"Insert ordered list",command:"insertorderedlist",type:"toggleButton"},image:{tooltip:"Insert image",command:"insertimage",type:"button"},link:{tooltip:"Insert link",command:"createlink",type:"toggleButton"},html:{tooltip:"View source",command:"viewsource",type:"toggleButton"},clean:{tooltip:"Remove Formatting",command:"removeformat",type:"button"}},createCommand:null,defaultLocalization:{bold:"Bold",italic:"Italic",underline:"Underline",format:"Format Block",font:"Font Name",size:"Font Size",color:"Text Color",background:"Fill Color",left:"Align Left",center:"Align Center",right:"Align Right",outdent:"Indent Less",indent:"Indent More",ul:"Insert unordered list",ol:"Insert ordered list",image:"Insert image",link:"Insert link",html:"View source",clean:"Remove Formatting",Remove:"Remove",Ok:"Ok",Cancel:"Cancel",Change:"Change","Go to link":"Go to link","Open in a new window/tab":"Open in a new window/tab",Align:"Align",VSpace:"VSpace",HSpace:"HSpace",Width:"Width",Height:"Height",Title:"Title",URL:"URL","Insert Image":"Insert Image","Insert Link":"Insert Link","Alt Text":"Alt Text","not set":"&ltnot set&gt",Left:"Left",Right:"Right",Paragraph:"Paragraph",Header:"Header",Arial:"Arial","Comic Sans MS":"Comic Sans MS","Courier New":"Courier New",Georgia:"Georgia",Impact:"Impact","Lucida Console":"Lucida Console",Tahoma:"Tahoma","Times New Roman":"Times New Roman","Trebuchet MS":"Trebuchet MS",Verdana:"Verdana"},localization:null,tools:"bold italic underline | format font size | color background | left center right | outdent indent | ul ol | image | link | clean | html",readOnly:!1,stylesheets:new Array,rtl:!1,colorPickerTemplate:'<div class="jqx-editor-color-picker"><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (0, 0, 0)"><div title="RGB (0, 0, 0)" style="background-color: rgb(0, 0, 0);"></div></td><td aria-label="RGB (68, 68, 68)"><div title="RGB (68, 68, 68)" style="background-color: rgb(68, 68, 68);"></div></td><td aria-label="RGB (102, 102, 102)"><div title="RGB (102, 102, 102)" style="background-color: rgb(102, 102, 102);"></div></td><td aria-label="RGB (153, 153, 153)"><div title="RGB (153, 153, 153)" style="background-color: rgb(153, 153, 153);"></div></td><td aria-label="RGB (204, 204, 204)"><div title="RGB (204, 204, 204)" style="background-color: rgb(204, 204, 204);"></div></td><td aria-label="RGB (238, 238, 238)"><div title="RGB (238, 238, 238)" style="background-color: rgb(238, 238, 238);"></div></td><td aria-label="RGB (243, 243, 243)"><div title="RGB (243, 243, 243)" style="background-color: rgb(243, 243, 243);"></div></td><td aria-label="RGB (255, 255, 255)"><div title="RGB (255, 255, 255)" style="background-color: rgb(255, 255, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (255, 0, 0)"><div title="RGB (255, 0, 0)" style="background-color: rgb(255, 0, 0);"></div></td><td aria-label="RGB (255, 153, 0)"><div title="RGB (255, 153, 0)" style="background-color: rgb(255, 153, 0);"></div></td><td aria-label="RGB (255, 255, 0)"><div title="RGB (255, 255, 0)" style="background-color: rgb(255, 255, 0);"></div></td><td aria-label="RGB (0, 255, 0)"><div title="RGB (0, 255, 0)" style="background-color: rgb(0, 255, 0);"></div></td><td aria-label="RGB (0, 255, 255)"><div title="RGB (0, 255, 255)" style="background-color: rgb(0, 255, 255);"></div></td><td aria-label="RGB (0, 0, 255)"><div title="RGB (0, 0, 255)" style="background-color: rgb(0, 0, 255);"></div></td><td aria-label="RGB (153, 0, 255)"><div title="RGB (153, 0, 255)" style="background-color: rgb(153, 0, 255);"></div></td><td aria-label="RGB (255, 0, 255)"><div title="RGB (255, 0, 255)" style="background-color: rgb(255, 0, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (244, 204, 204)"><div title="RGB (244, 204, 204)" style="background-color: rgb(244, 204, 204);"></div></td><td aria-label="RGB (252, 229, 205)"><div title="RGB (252, 229, 205)" style="background-color: rgb(252, 229, 205);"></div></td><td aria-label="RGB (255, 242, 204)"><div title="RGB (255, 242, 204)" style="background-color: rgb(255, 242, 204);"></div></td><td aria-label="RGB (217, 234, 211)"><div title="RGB (217, 234, 211)" style="background-color: rgb(217, 234, 211);"></div></td><td aria-label="RGB (208, 224, 227)"><div title="RGB (208, 224, 227)" style="background-color: rgb(208, 224, 227);"></div></td><td aria-label="RGB (207, 226, 243)"><div title="RGB (207, 226, 243)" style="background-color: rgb(207, 226, 243);"></div></td><td aria-label="RGB (217, 210, 233)"><div title="RGB (217, 210, 233)" style="background-color: rgb(217, 210, 233);"></div></td><td aria-label="RGB (234, 209, 220)"><div title="RGB (234, 209, 220)" style="background-color: rgb(234, 209, 220);"></div></td></tr><tr><td id="T-Kw-Jn88" aria-label="RGB (234, 153, 153)"><div title="RGB (234, 153, 153)" style="background-color: rgb(234, 153, 153);"></div></td><td aria-label="RGB (249, 203, 156)"><div title="RGB (249, 203, 156)" style="background-color: rgb(249, 203, 156);"></div></td><td aria-label="RGB (255, 229, 153)"><div title="RGB (255, 229, 153)" style="background-color: rgb(255, 229, 153);"></div></td><td aria-label="RGB (182, 215, 168)"><div title="RGB (182, 215, 168)" style="background-color: rgb(182, 215, 168);"></div></td><td aria-label="RGB (162, 196, 201)"><div title="RGB (162, 196, 201)" style="background-color: rgb(162, 196, 201);"></div></td><td aria-label="RGB (159, 197, 232)"><div title="RGB (159, 197, 232)" style="background-color: rgb(159, 197, 232);"></div></td><td aria-label="RGB (180, 167, 214)"><div title="RGB (180, 167, 214)" style="background-color: rgb(180, 167, 214);"></div></td><td aria-label="RGB (213, 166, 189)"><div title="RGB (213, 166, 189)" style="background-color: rgb(213, 166, 189);"></div></td></tr><tr><td aria-label="RGB (224, 102, 102)"><div title="RGB (224, 102, 102)" style="background-color: rgb(224, 102, 102);"></div></td><td aria-label="RGB (246, 178, 107)"><div title="RGB (246, 178, 107)" style="background-color: rgb(246, 178, 107);"></div></td><td aria-label="RGB (255, 217, 102)"><div title="RGB (255, 217, 102)" style="background-color: rgb(255, 217, 102);"></div></td><td aria-label="RGB (147, 196, 125)"><div title="RGB (147, 196, 125)" style="background-color: rgb(147, 196, 125);"></div></td><td aria-label="RGB (118, 165, 175)"><div title="RGB (118, 165, 175)" style="background-color: rgb(118, 165, 175);"></div></td><td aria-label="RGB (111, 168, 220)"><div title="RGB (111, 168, 220)" style="background-color: rgb(111, 168, 220);"></div></td><td aria-label="RGB (142, 124, 195)"><div title="RGB (142, 124, 195)" style="background-color: rgb(142, 124, 195);"></div></td><td aria-label="RGB (194, 123, 160)"><div title="RGB (194, 123, 160)" style="background-color: rgb(194, 123, 160);"></div></td></tr><tr><td id="T-Kw-Jn104" aria-label="RGB (204, 0, 0)"><div title="RGB (204, 0, 0)" style="background-color: rgb(204, 0, 0);"></div></td><td aria-label="RGB (230, 145, 56)"><div title="RGB (230, 145, 56)" style="background-color: rgb(230, 145, 56);"></div></td><td aria-label="RGB (241, 194, 50)"><div title="RGB (241, 194, 50)" style="background-color: rgb(241, 194, 50);"></div></td><td aria-label="RGB (106, 168, 79)"><div title="RGB (106, 168, 79)" style="background-color: rgb(106, 168, 79);"></div></td><td aria-label="RGB (69, 129, 142)"><div title="RGB (69, 129, 142)" style="background-color: rgb(69, 129, 142);"></div></td><td aria-label="RGB (61, 133, 198)"><div title="RGB (61, 133, 198)" style="background-color: rgb(61, 133, 198);"></div></td><td aria-label="RGB (103, 78, 167)"><div title="RGB (103, 78, 167)" style="background-color: rgb(103, 78, 167);"></div></td><td aria-label="RGB (166, 77, 121)"><div title="RGB (166, 77, 121)" style="background-color: rgb(166, 77, 121);"></div></td></tr><tr><td aria-label="RGB (153, 0, 0)"><div title="RGB (153, 0, 0)" style="background-color: rgb(153, 0, 0);"></div></td><td aria-label="RGB (180, 95, 6)"><div title="RGB (180, 95, 6)" style="background-color: rgb(180, 95, 6);"></div></td><td aria-label="RGB (191, 144, 0)"><div title="RGB (191, 144, 0)" style="background-color: rgb(191, 144, 0);"></div></td><td aria-label="RGB (56, 118, 29)"><div title="RGB (56, 118, 29)" style="background-color: rgb(56, 118, 29);"></div></td><td aria-label="RGB (19, 79, 92)"><div title="RGB (19, 79, 92)" style="background-color: rgb(19, 79, 92);"></div></td><td aria-label="RGB (11, 83, 148)"><div title="RGB (11, 83, 148)" style="background-color: rgb(11, 83, 148);"></div></td><td aria-label="RGB (53, 28, 117)"><div title="RGB (53, 28, 117)" style="background-color: rgb(53, 28, 117);"></div></td><td aria-label="RGB (116, 27, 71)"><div title="RGB (116, 27, 71)" style="background-color: rgb(116, 27, 71);"></div></td></tr><tr><td aria-label="RGB (102, 0, 0)"><div title="RGB (102, 0, 0)" style="background-color: rgb(102, 0, 0);"></div></td><td aria-label="RGB (120, 63, 4)"><div title="RGB (120, 63, 4)" style="background-color: rgb(120, 63, 4);"></div></td><td aria-label="RGB (127, 96, 0)"><div title="RGB (127, 96, 0)" style="background-color: rgb(127, 96, 0);"></div></td><td aria-label="RGB (39, 78, 19)"><div title="RGB (39, 78, 19)" style="background-color: rgb(39, 78, 19);"></div></td><td aria-label="RGB (12, 52, 61)"><div title="RGB (12, 52, 61)" style="background-color: rgb(12, 52, 61);"></div></td><td aria-label="RGB (7, 55, 99)"><div title="RGB (7, 55, 99)" style="background-color: rgb(7, 55, 99);"></div></td><td aria-label="RGB (32, 18, 77)"><div title="RGB (32, 18, 77)" style="background-color: rgb(32, 18, 77);"></div></td><td aria-label="RGB (76, 17, 48)"><div title="RGB (76, 17, 48)" style="background-color: rgb(76, 17, 48);"></div></td></tr></tbody></table></div></div>',touchMode:!1,keyPressed:null,events:["change"]};return this===e.jqx._jqxEditor.prototype?t:(e.extend(!0,this,t),this.localization=this.defaultLocalization,t)},createInstance:function(o){var i=this;i.textArea=i.host;var n=i.host.attr("contenteditable");if(i.host.addClass(i.toThemeProperty("jqx-widget")),1==n||"true"==n){i.inline=!0,i.widget=i.host,i.editorDocument=document,i.selection=new t(i.editorDocument);var r=e("<div class='jqx-editor-toolbar-container' unselectable='on' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div>");r.insertBefore(i.host),i.toolbarContainer=r,i.toolbar=r.find(".jqx-editor-toolbar"),i.editor=i.host,i.contentEditableElement=i.element}else{var a=e("<div class='jqx-editor'><div class='jqx-editor-container'><div class='jqx-editor-toolbar-container' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div></div><div class='jqx-editor-content'><iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe></div></div></div>");i.widget=a,i.widget[0].className=i.widget[0].className+" "+i.element.className;try{i.widget[0].style=i.element.style}catch(e){}var l=e.trim(i.host.html())+"&#8203;";"default"==i.lineBreak||"div"==i.lineBreak?l="<div>"+l+"</div>":"p"==i.lineBreak&&(l="<p>"+l+"</p>"),l=l.replace(/&lt;/gi,"<"),l=l.replace(/&gt;/gi,">"),i.host.css("display","none"),i.host.after(a),a.find("iframe").after(i.host),i.container=a.find(".jqx-editor-container"),i.toolbarContainer=a.find(".jqx-editor-toolbar-container"),i.toolbar=a.find(".jqx-editor-toolbar"),i.iframe=a.find("iframe"),i.content=a.find(".jqx-editor-content");var d=function(){i.editorDocument=i.iframe[0].contentWindow.document,i.selection=new t(i.editorDocument);var o=0;i.addHandler(i.iframe,"load",function(){if(++o>1){i.iframe.off("load"),i.content.find("iframe").remove();e("<iframe  src='javascript:\"<html></html>\"' allowtransparency='true' frameborder='0'></iframe>").appendTo(i.content);i.iframe=a.find("iframe"),d()}}),e.jqx.browser.mozilla||(i.editorDocument.designMode="On"),i.editorDocument.open();var n=i.rtl?"direction:rtl;":"",r=e.jqx.browser.msie?"::selection{color: #fff; background: #328EFD;};::-moz-selection{color: #fff; background: #328eD;};::selection:window-inactive {background: #c7c7c7; color: #000;}::-moz-selection:window-inactive {background: #c7c7c7; color: #000;}html{font-size:13px; height:100%;}body{padding-top:1px;margin-top:-1px; padding-right: 1px; overflow-x: hidden;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;":"";if(i.editorDocument.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0; margin:0; font-size: 13px; font-family: "+i.fontFamily+"; background:#fff; min-height:100%; "+n+"}"+r+"}h1{font-size:2em;margin:.67em 0}h2{font-size: 1.5em; margin: .75em 0}h3{font-size: 1.17em; margin: .83em 0}h4{font-size:1em; margin: 1.12em 0 }h5{font-size: .83em; margin: 1.5em 0}h6{font-size: .75em; margin: 1.67em 0}p{margin: 0px;padding:0 .2em}ul,ol{padding-left:2.5em}a{color:#00a}code{font-size:1.23em}.jqx-editor-paste-element {position: absolute; left: -1000px; height: 1px; overflow: hidden; top: -1000px;}.jqx-editor-focus {border: 1px solid #aaa !important;}</style>"+e.map(i.stylesheets,function(e){return"<link rel='stylesheet' href='"+e+"'>"}).join("")+"</head><body autocorrect='off' contenteditable='true'></body></html>"),i.contentEditableElement=i.editorDocument.body,i.host.is("textarea"))i._textArea=i.element,(s=i.host.data()).jqxEditor.host=a,s.jqxEditor.element=a[0],i.element=a[0],a[0].id=i._textArea.id,i._textArea.id=i._textArea.id+"TextArea",e(i.element).addClass(i.toThemeProperty("jqx-widget")),i.host=e(i.element),i.host.data(s);else{var s=i.host.data();s.jqxEditor.host=a,s.jqxEditor.element=a[0],i.element=a[0],i.host=e(i.element),i.host.data(s)}try{i.editorDocument.execCommand("useCSS",!1,!1),i.editorDocument.execCommand("enableInlineTableEditing",null,!1)}catch(e){}try{i.editorDocument.execCommand("styleWithCSS",0,!0)}catch(e){}i.editorDocument.close(),i.editor=e(i.editorDocument.body),i.editor.html(l).attr("spellcheck",!1).attr("autocorrect","off")};d(),e.jqx.utilities.resize(i.host,function(){i.widget.css("width",i.width),i.widget.css("height",i.height),i._arrange()})}},focus:function(){var t=this;e.jqx.browser.mozilla&&(t.focused||(t.iframe&&t.iframe.focus(),t.selection.selectNode(t.editor[0].firstChild,!0),t.selection.getRange().collapse(!0))),t.editor.focus();var o=null!=t.range?t.range:t.getRange();t.selectRange(o)},print:function(){var e=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");e.document.open(),e.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+this.val()+"</body></html>"),e.document.close()},refresh:function(t){var o=this;e.each(this.defaultLocalization,function(e,t){o.localization[e]||(o.localization[e]=t)}),o._removeHandlers(),o.toolbar.addClass(o.toThemeProperty("jqx-widget-header")),o.content?(o.widget.css("width",o.width),o.widget.css("height",o.height),o.widget.addClass(o.toThemeProperty("jqx-editor")),o.widget.addClass(o.toThemeProperty("jqx-widget")),o.widget.addClass(o.toThemeProperty("jqx-rc-all")),o.widget.addClass(o.toThemeProperty("jqx-widget-header")),o.content.addClass(o.toThemeProperty("jqx-widget-content")),o.container.addClass(o.toThemeProperty("jqx-editor-container"))):(o.toolbarContainer.addClass(o.toThemeProperty("jqx-widget-header")),o.toolbarContainer.addClass(o.toThemeProperty("jqx-editor-toolbar-inline")),o.toolbarContainer.addClass(o.toThemeProperty("jqx-widget")),o.toolbarContainer.addClass(o.toThemeProperty("jqx-rc-all")),o.toolbarContainer.hide(),o.toolbarContainer.css("position","absolute"),o.editor.addClass(o.toThemeProperty("jqx-editor-inline")),o.toolbarContainer.css("width",o.host.outerWidth()+"px"));var i=o.toolbarContainer.index();if("top"==o.toolbarPosition&&0!=i||"bottom"==o.toolbarPosition&&1!=i)switch(o.toolbarPosition){case"bottom":o.toolbarContainer.insertAfter(o.content);break;case"top":default:o.toolbarContainer.insertBefore(o.content)}var n=o.tools;if(!1!==n){var r=n.split(" "),a=n.split(" | "),l=function(t,i){e.each(i,function(n,r){var a=o.commands[this];if(a){if(o.createCommand){var l=o.createCommand(this.toString());a=e.extend(a,l)}}else{if(!o.createCommand)return!0;if(!(a=o.createCommand(this.toString())))return!0;o.commands[this]||(o.commands[this]=a)}switch(o.localization[this]&&(a.tooltip=o.localization[this]),a.type){case"list":a.widget&&a.widget.jqxDropDownList("destroy");var d="formatblock"==a.command||"fontname"==a.command||"fontsize"==a.command,s=a.value||[],c=new Array,u=a.placeHolder||"Please Choose:";"fontname"==a.command?e.each(s,function(){var e=o.localization[this.label];c.push({label:e,value:this.value})}):"formatblock"==a.command?(u=o.localization.format,e.each(s,function(){if(this.label.indexOf("Header")>=0)e=this.label.replace("Header",o.localization.Header);else var e=o.localization[this.label];c.push({label:e,value:this.value})})):c=s;var g={enableBrowserBoundsDetection:!0,touchMode:o.touchMode,width:a.width||100,height:a.height||25,dropDownWidth:a.dropDownWidth||"auto",autoDropDownHeight:(a.value&&a.value.length)<12,placeHolder:u,source:c,theme:o.theme,keyboardSelection:!1,focusable:!1,disabled:o.disabled,rtl:o.rtl,selectionRenderer:"fontsize"==a.command?function(){return"<div unselectable='on' style='margin-top: 0px; padding:0px;' class='"+o.toThemeProperty("jqx-editor-toolbar-icon")+" "+o.toThemeProperty("jqx-editor-toolbar-icon-"+a.command)+"'></div>"}:null,renderer:d?function(e,t,o){return"formatblock"==a.command?"<"+o+' unselectable="on" style="padding: 0px; margin: 0px;">'+t+"</"+o+">":"fontname"==a.command?'<span unselectable="on" style="font-family: '+o+';">'+t+"<span>":"fontsize"==a.command?'<span unselectable="on" style="font-size: '+o+';">'+t+"<span>":void 0}:null},p="jqx-disableselect "+o.toThemeProperty("jqx-editor-dropdownlist")+" "+o.toThemeProperty("jqx-editor-toolbar-item");(T=e("<div unselectable='on' class='"+p+"'></div>")).appendTo(t),T.jqxDropDownList(g),a.init&&a.init(T);var r=null,h=null,m="";o.addHandler(T,"mousedown",function(t){if(e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0){var o=e(".jqx-editor-dropdownlist");e.each(o,function(t,o){o!=T[0]&&e(o).jqxDropDownList("close")})}}),o.addHandler(T,"open",function(e){o.focused||o.focus(),o.updating=!0,o.activeElement=T,r=T.val(),m=""}),o.addHandler(T,"change",function(t){o.updating=!1,o.activeElement=null,h=T.val(),m=t.args.type,e.jqx.browser.msie&&e.jqx.browser.version<9&&o.focus()}),o.addHandler(T,"close",function(e){o.updating=!1,o.activeElement=null,r!=h&&("mouse"!=m&&"keyboard"!=m||o._refreshTools())}),o._addCommandHandler(T,"change",a.command,null,a);break;case"colorPicker":a.widget&&(e(a.colorPicker).remove(),a.widget.jqxDropDownButton("destroy"));var f=e('<div unselectable="on" style="padding-top: 4px;"></div>').attr("id","picker-"+a.command),p="jqx-disableselect "+o.toThemeProperty("jqx-editor-dropdownpicker")+" "+o.toThemeProperty("jqx-editor-toolbar-item");(T=e("<div unselectable='on' class='"+p+"'></div>")).appendTo(t),T.append(f),T.jqxDropDownButton({touchMode:o.touchMode,disabled:o.disabled,enableBrowserBoundsDetection:!0,width:a.width||45,height:a.height||25,rtl:o.rtl,focusable:!1,theme:o.theme});var b=e('<div unselectable="on" style="z-index: 55;">'),v=o.toThemeProperty("jqx-editor-toolbar-icon")+" "+o.toThemeProperty("jqx-editor-toolbar-icon-"+a.command),x=e("<div unselectable='on' class='"+v+"'></div>");b.append(x);var y=e('<div unselectable="on" class="jqx-editor-color-bar">').attr("id","bar-"+a.command).css("background-color",a.value);b.append(y),T.jqxDropDownButton("setContent",b),f.append(e(o.colorPickerTemplate)),a.colorPicker=f,a.init&&a.init(T),f.find("tr").attr("role","row").attr("unselectable","on"),f.find("td").attr("role","gridcell").attr("unselectable","on").css("-webkit-user-select","none"),f.find("div").attr("unselectable","on"),o.addHandler(T,"mousedown",function(t){if(e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),e(".jqx-editor-dropdownpicker").length>0){var o=e(".jqx-editor-dropdownpicker");e.each(o,function(t,o){o!=T[0]&&e(o).jqxDropDownButton("close")})}}),o.addHandler(T,"open",function(){o.focused||o.focus(),o.updating=!0,o.activeElement=f}),o.addHandler(T,"close",function(e){o.updating=!1,o.activeElement=null,r!=h&&("mouse"!=m&&"keyboard"!=m||o._refreshTools())}),o.addHandler(f,"keydown",function(t){var o=t.keyCode,i=e(f).find(".jqx-editor-color-picker-selected-cell"),n=f.find("tr"),r=n.length,l=i.parent().children().length,d=i.index(),s=-999,c=i.parent();switch(e.each(n,function(e,t){if(this==c[0])return s=e,!1}),o){case 27:T.jqxDropDownButton("close");break;case 13:e(i).trigger("mousedown");break;case 38:s--;break;case 40:s++;break;case 39:d++;break;case 37:d--}if(s>=0&&s<=r&&d>=0&&d<=l){var c=f.find("tr")[s],u=e(c).children()[d],g=e(u).children().css("background-color");a.val(g)}});var w=e(f).find("td");a.val=function(t){var i=o._rgbToHex(t);e.each(w,function(){var t=e(this).children().css("background-color");if(o._rgbToHex(t)==i)return w.removeClass("jqx-editor-color-picker-selected-cell"),e(this).addClass("jqx-editor-color-picker-selected-cell"),e("#bar-"+a.command).css("background",t),!1})},a.val(a.value),o._addCommandHandler(w,"mousedown",a.command,null,a);break;case"button":case"toggleButton":default:a.widget&&("button"==a.type?a.widget.jqxButton("destroy"):a.widget.jqxToggleButton("destroy"));var k=a.command,_=a.action,v=o.toThemeProperty("jqx-editor-toolbar-icon")+" "+o.toThemeProperty("jqx-editor-toolbar-icon-"+k),x=e("<div unselectable='on' class='"+v+"'></div>"),T=e("<div unselectable='on'></div>").addClass("jqx-disableselect").addClass(o.toThemeProperty("jqx-editor-toolbar-button"));a.init?k&&T.append(x):T.append(x),T.appendTo(t),"button"==a.type?T.jqxButton({disabled:o.disabled,rtl:o.rtl,theme:o.theme}):"toggleButton"==a.type&&T.jqxToggleButton({disabled:o.disabled,rtl:o.rtl,uiToggle:!1,theme:o.theme}),a.init&&a.init(T),a.toggled=!1,a.toggle=function(){a.toggled=!a.toggled},o.addHandler(T,"mousedown",function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}),e.jqx.mobile.isTouchDevice()?o._addCommandHandler(T,"mousedown",k,_,a):o._addCommandHandler(T,"click",k,_,a)}if(a.widget=T,T){try{""!=a.tooltip&&(a.widget.attr("title",a.tooltip),a.widget.attr("data-tooltip",a.tooltip)),a.command&&a.widget.attr("data-command",a.command),a.widget.attr("aria-label",a.tooltip)}catch(e){}"button"!=a.type&&"toggleButton"!=a.type||(i.length>2&&(0==n?(T.css("border-right-radius","0px"),T.addClass(o.toThemeProperty("jqx-rc-l"))):n==i.length-1&&(T.css("border-left-radius","0px"),T.addClass(o.toThemeProperty("jqx-rc-r"))),T.removeClass(o.toThemeProperty("jqx-rc-all"))),0!=n&&n!=i.length-1&&i.length>2?(T.css("border-left-radius","0px"),T.css("border-right-radius","0px"),T.removeClass(o.toThemeProperty("jqx-rc-all"))):2==i.length?(0==n?(T.css("border-right-radius","0px"),T.addClass(o.toThemeProperty("jqx-rc-l"))):(T.css("border-left-radius","0px"),T.addClass(o.toThemeProperty("jqx-rc-r"))),T.removeClass(o.toThemeProperty("jqx-rc-all"))):1==i.length&&T.css("margin-right","0px"))}})};if(o.toolbar.css("direction",this.rtl?"rtl":"ltr"),0==a.length)l(o.toolbar,r);else{for(g=0;g<a.length;g++){var r=a[g].split(" "),d=o.toThemeProperty("jqx-editor-toolbar-group")+" "+o.toThemeProperty("jqx-fill-state-normal"),s=e("<div class='"+d+"'></div>");s.addClass(o.toThemeProperty("jqx-rc-all")),o.toolbar.append(s),l(s,r)}for(var c=o.toolbar.find(".jqx-editor-toolbar-group"),u=c.length,g=0;g<u;g++)0==e(c[g]).children().length&&e(c[g]).remove()}e.jqx.browser.msie&&e.jqx.browser.version<8&&(e(".jqx-editor-toolbar-group").css("float","left"),e(".jqx-editor-toolbar-group").children().css("float","left"),e(".jqx-editor-toolbar-group").css("zoom","1"),e(".jqx-editor-toolbar-group").children().css("zoom","1"))}o._arrange(),o._addHandlers()},_arrange:function(){var t=this;t.content&&(""==t.tools||0==t.tools?(t.content.height(t.container.outerHeight()-parseInt(t.container.css("padding-top"))-parseInt(t.container.css("padding-bottom"))-6),t.content.css("margin-top","4px"),t.toolbar.hide()):(t.toolbar.show(),t.content.css("margin-top","0px"),t.content.height(t.container.outerHeight()-t.toolbar.outerHeight()-parseInt(t.container.css("padding-top"))-parseInt(t.container.css("padding-bottom"))-2),"top"!=t.toolbarPosition&&(t.content.css("margin-top","4px"),t.content.css("margin-bottom","0px"))),e.jqx.browser.msie&&e.jqx.browser.version<8&&(t.content.css("margin-top","4px"),t.content.height(t.container.height()-t.toolbar.outerHeight()-2*parseInt(t.container.css("padding-bottom"))-10),t.content.width(t.container.width()-2*parseInt(t.container.css("padding-left"))-2)),t.editor.height()<t.content.height()&&t.editor.height(t.content.height()))},propertyChangedHandler:function(t,o,i,n){var r=t;void 0!=r.isInitialized&&0!=r.isInitialized&&"pasteMode"!=o&&"lineBreak"!=o&&"editable"!=o&&("disabled"==o&&t._refreshTools(),"width"!=o&&"height"!=o&&"toolbarPosition"!=o?("theme"==o&&e.jqx.utilities.setTheme(i,n,t.host),t.refresh()):t._arrange())},selectRange:function(e){var t=this;e||(e=t.getRange()),t.selection.selectRange(e)},getRange:function(){return this.selection.getRange()},getSelectedElement:function(){var e,t,o,i,n=this;try{if(n.editorDocument.getSelection){var r=n.editorDocument.getSelection();return e=r.getRangeAt(r.rangeCount-1),o=e.startContainer,i=e.endContainer,t=e.commonAncestorContainer,"#text"==o.nodeName&&(t=t.parentNode),"#text"==o.nodeName&&(o=o.parentNode),"body"==o.nodeName.toLowerCase()&&(o=o.firstChild),"#text"==i.nodeName&&(i=i.parentNode),"body"==i.nodeName.toLowerCase()&&(i=i.lastChild),o==i&&(t=o),i}if(n.editorDocument.selection){if(!(e=n.editorDocument.selection.createRange()).duplicate)return null;t=e.parentElement();var a=e.duplicate(),l=e.duplicate();return a.collapse(!0),l.moveToElementText(a.parentElement()),l.setEndPoint("EndToStart",a),o=a.parentElement(),a=e.duplicate(),(l=e.duplicate()).collapse(!1),a.moveToElementText(l.parentElement()),a.setEndPoint("StartToEnd",l),i=l.parentElement(),"body"==o.nodeName.toLowerCase()&&(o=o.firstChild),"body"==i.nodeName.toLowerCase()&&(i=i.lastChild),o==i&&(t=o),i}}catch(e){return null}return null},_addHandlers:function(){var t=this;t.addHandler(t.toolbar,"mousedown.editor"+t.element.id,function(e){return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1});var o=function(){if(t._textArea&&(t.updating||(t._textArea.value=t.val())),t.changed&&(t._raiseEvent("change"),t.changed=!1),t.focused=!1,t.inline){if(t.host.removeClass(t.toThemeProperty("jqx-fill-state-focus")),t.host.removeClass(t.toThemeProperty("jqx-editor-inline-focus")),""==t.tools||null==t.tools)return;t.toolbarContainer.fadeOut("fast")}},i=function(){if(t.focused=!0,t.inline){if(t.host.addClass(t.toThemeProperty("jqx-fill-state-focus")),t.host.addClass(t.toThemeProperty("jqx-editor-inline-focus")),t.host.addClass(t.toThemeProperty("jqx-rc-all")),""==t.tools||null==t.tools)return;t.toolbarContainer.fadeIn("fast");var e=t.host.coord();"bottom"!=t.toolbarPosition?t.toolbarContainer.offset({left:e.left,top:e.top-t.toolbarContainer.outerHeight()-5}):t.toolbarContainer.offset({left:e.left,top:e.top+5+t.host.height()})}};e.jqx.browser.mozilla&&this.addHandler(e(document),"mousedown.editor"+t.element.id,function(e){o()}),t.addHandler(t.editor,"blur.editor"+t.element.id,function(e){o()}),t.addHandler(t.editor,"focus.editor"+t.element.id,function(e){i()}),t.addHandler(t.editor,"beforedeactivate.editor"+t.element.id,function(e){t.range=t.getRange()}),t.addHandler(t.editor,"mousedown.editor"+t.element.id,function(o){o.target.href||t.linkPopup&&t.linkPopup.remove(),t.range=t.getRange(),e.jqx.browser.mozilla&&(i(),o.stopPropagation()),e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),t.inline&&t.editor.focus()}),e.jqx.mobile.isTouchDevice()&&(t.addHandler(e(t.editorDocument),"selectionchange.editor"+t.element.id,function(){t.editorDocument.activeElement!=t.editor[0]&&setTimeout(function(){t.iframe&&t.iframe[0].contentWindow.focus()},500)}),t.addHandler(e(t.editorDocument),"touchstart.editor"+t.element.id,function(){setTimeout(function(){t.iframe&&t.iframe[0].contentWindow.focus()},500)})),t.addHandler(t.editor,"mouseup.editor"+t.element.id,function(e){if("source"==t._documentMode)return!0;t.range=t.getRange(),t._refreshTools(null,!0)}),t.addHandler(t.editor,"keydown.editor"+t.element.id,function(o){if(t.keyPressed&&t.keyPressed(o),"source"==t._documentMode)return!0;if(e.jqx.browser.mozilla&&(t.focused||i()),t.changeType="keyboard",t.disabled)return o.preventDefault&&o.preventDefault(),!1;if(t.updating){if(t.activeElement){var n=e.Event("keydown");e.extend(n,o),t.activeElement.trigger(n)}return o.preventDefault&&o.preventDefault(),!1}var r=o||window.event,a=r.keyCode,l=String.fromCharCode(a).toLowerCase();if(!t.editable){d=[9,33,34,35,36,37,38,39,40,40,45];-1!=e.inArray(r.keyCode,d)||r.ctrlKey&&"c"==l||r.ctrlKey&&"a"==l||o.preventDefault()}if(t.selection.getText().length>0||t.linkPopup){var d=[8,9,13,33,34,35,36,37,38,39,40,40,45,46];(-1!=!e.inArray(r.keyCode,d)||65==r.keyCode&&r.ctrlKey&&!r.altKey&&!r.shiftKey)&&(t._refreshToolsTimer&&clearTimeout(t._refreshToolsTimer),t._refreshToolsTimer=setTimeout(function(){t._refreshTools(null,!0,r.keyCode)},10))}if(13==a&&"default"!=t.lineBreak){var s=t.getSelectedElement();if(s){switch(s.nodeName.toLowerCase()){case"pre":case"li":case"ul":case"ol":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return!0}for(var c=s;null!=c;){if("#document"==c.nodeName){c=t.editorDocument.body;break}if(c.parentNode==t.editorDocument.body||c==t.editorDocument.body)break;c=c.parentNode}}if(c){var u=t.getRange();"<div></div>"==t.editorDocument.body.innerHTML&&"br"!=t.lineBreak&&t.selection.insertContent("&#8203;"),"div"==t.lineBreak?c==t.editorDocument.body?e(c).append("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>"):e("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(c):"p"==t.lineBreak?c==t.editorDocument.body?e(c).append("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>"):e("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(c):t.execute("insertHTML","<br/>&#8203;<span id='INSERTION_MARKER'>&nbsp;</span>"),t.selectRange(u);var g=e(t.editorDocument).find("#INSERTION_MARKER");return"br"!=t.lineBreak?t.selection.selectNode(e(g).prev()[0],!0):(t.selection.selectNode(g[0],!0),t.getRange().setStartAfter&&t.getRange().setStartAfter(g[0])),g.remove(),t.selection.collapse(!1),c&&c.nodeName&&"br"==t.lineBreak&&"#text"!=c.nodeName.toLowerCase()&&(t.selection.selectNode(c,!0),t.getRange().setStartAfter&&t.getRange().setStartAfter(c),t.selection.collapse(!1)),"br"!=t.lineBreak&&(u=t.getRange()).select&&u.select(),o.preventDefault&&o.preventDefault(),!1}}if(r.ctrlKey&&("k"==l||"u"==l||"b"==l||"i"==l)){o.preventDefault&&o.preventDefault();var p=null;switch(l){case"k":p="link";break;case"u":p="underline";break;case"b":p="bold";break;case"i":p="italic"}return t.commands[p].widget&&t.commands[p].widget.trigger("click"),!1}}),t.addHandler(t.editor,"paste.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if(t.readOnly)return!0;t.updating=!0,t.readOnly=!0;try{var i=function(e,o){return o?e=t.paragraphise?(e=(e="<p>"+e+"</p>").replace(/\n/g,"</p><p>")).replace(/<p>\s<\/p>/gi,""):e.replace(/\n/g,"<br />"):((e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<html[^>]*?>(.*)/gim,"$1")).replace(/<\/html>/gi,"")).replace(/<body[^>]*?>(.*)/gi,"$1")).replace(/<\/body>/gi,"")).replace(/<style[^>]*?>[\s\S]*?<\/style[^>]*>/gi,"")).replace(/<(?:meta|link)[^>]*>\s*/gi,"")).replace(/<\\?\?xml[^>]*>/gi,"")).replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,"")).replace(/<o:p>\s*<\/o:p>/g,"")).replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;")).replace(/<\/?\w+:[^>]*>/gi,"")).replace(/<\!--[\s\S]*?-->/g,"")).replace(/<\!\[[\s\S]*?\]>/g,"")).replace(/\s*mso-[^:]+:[^;"']+;?/gi,"")).replace(/<(\w[^>]*) style='([^\']*)'([^>]*)/gim,"<$1$3")).replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gim,"<$1$3")).replace(/\s*margin: 0cm 0cm 0pt\s*;/gi,"")).replace(/\s*margin: 0cm 0cm 0pt\s*"/gi,'"')).replace(/\s*text-indent: 0cm\s*;/gi,"")).replace(/\s*text-indent: 0cm\s*"/gi,'"')).replace(/\s*text-align: [^\s;]+;?"/gi,'"')).replace(/\s*page-break-before: [^\s;]+;?"/gi,'"')).replace(/\s*font-variant: [^\s;]+;?"/gi,'"')).replace(/\s*tab-stops:[^;"']*;?/gi,"")).replace(/\s*tab-stops:[^"']*/gi,"")).replace(/\s*face="[^"']*"/gi,"")).replace(/\s*face=[^ >]*/gi,"")).replace(/\s*font-family:[^;"']*;?/gi,"")).replace(/\s*font-size:[^;"']*;?/gi,"")).replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w+)[^>]*\sstyle="[^"']*display\s?:\s?none[\s \S]*?<\/\1>/gi,"")).replace(/\s*style='\s*'/gi,"")).replace(/\s*style="\s*"/gi,"")).replace(/<span\s*[^>]*>\s*&nbsp;\s*<\/span>/gi,"&nbsp;")).replace(/<span\s*[^>]*><\/span>/gi,"")).replace(/<(\w[^>]*) align=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<span([^>]*)>([\s\S]*?)<\/span>/gi,"$2")).replace(/<font\s*>([\s\S]*?)<\/font>/gi,"$1")).replace(/<(u|i|strike)>&nbsp;<\/\1>/gi,"&nbsp;")).replace(/<h\d>\s*<\/h\d>/gi,"")).replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseover="([^\"']*)"([^>]*)/gi,"<$1$3")).replace(/<(\w[^>]*) onmouseout="([^\"']*)"([^>]*)/gi,"<$1$3")).replace(/<h(\d)([^>]*)>/gi,"<h$1>")).replace(/<(h\d)><font[^>]*>([\s\S]*?)<\/font><\/\1>/gi,"<$1>$2</$1>")).replace(/<(h\d)><em>([\s\S]*?)<\/em><\/\1>/gi,"<$1>$2</$1>")).replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>")).replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>")).replace(/<\s+[^>]*>/gi,"")).replace(/<span>([\s\S]*?)<\/span>/gi,"$1")).replace(/<span>([\s\S]*?)<\/span>/gi,"$1")).replace(/<div>([\s\S]*?)<\/div>/gi,"$1")).replace(/<div>([\s\S]*?)<\/div>/gi,"$1")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).trim&&(e=e.trim()),t.paragraphise?"<p"!==e.substr(0,2)&&(e=(e=(e="<p>"+e+"</p>").replace(/\n/g,"</p><p>")).replace(/<br[^>]*>/gi,"</p><p>")):(e.replace(/<p>/gi,"<br />"),e.replace(/<\/p>/gi,"")),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/<br>/gi,"<br />")).replace(/<br[^>]*><\/p>/gim,"</p>")).replace(/<p>&nbsp;<\/p>/gi,"")).replace(/<p>\s<\/p>/gi,"")).replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,"")).replace(/MsoNormal/gi,"")).replace(/<\/?meta[^>]*>/gi,"")).replace(/<\/?xml[^>]*>/gi,"")).replace(/<\?xml[^>]*\/>/gi,"")).replace(/<!--(.*)-->/gi,"")).replace(/<!--(.*)>/gi,"")).replace(/<!(.*)-->/gi,"")).replace(/<w:[^>]*>(.*)<\/w:[^>]*>/gi,"")).replace(/<w:[^>]*\/>/gi,"")).replace(/<\/?w:[^>]*>/gi,"")).replace(/<m:[^>]*\/>/gi,"")).replace(/<m:[^>]>(.*)<\/m:[^>]*>/gi,"")).replace(/<o:[^>]*>(.*)<\/o:[^>]*>/gi,"")).replace(/<o:[^>]*\/>/gi,"")).replace(/<\/?m:[^>]*>/gi,"")).replace(/style=\"([^>]*)\"/gi,"")).replace(/style=\'([^>]*)\'/gi,"")).replace(/class=\"(.*)\"/gi,"")).replace(/class=\'(.*)\'/gi,"")).replace(/<b>/gi,"<strong>")).replace(/<\/b>/gi,"</strong>")).replace(/<p[^>]*>/gi,"<p>")).replace(/<\/p[^>]*>/gi,"</p>")).replace(/<span[^>]*>/gi,"")).replace(/<\/span[^>]*>/gi,"")).replace(/<st1:[^>]*>/gi,"")).replace(/<\/st1:[^>]*>/gi,"")).replace(/<font[^>]*>/gi,"")).replace(/<\/font[^>]*>/gi,"")).replace("  ","")).replace(/<strong><\/strong>/gi,"")).replace(/<p><\/p>/gi,"")).replace(/\/\*(.*)\*\//gi,"")).replace(/<!--/gi,"")).replace(/-->/gi,"")).replace(/<style[^>]*>[^<]*<\/style[^>]*>/gi,"")).trim()),e},n=t.getRange();"text"!=t.pasteMode||e.jqx.browser.mozilla?t.selection.insertContent('<div class="jqx-editor-paste-element">&nbsp;</div>'):t.selection.insertContent('<textarea cols="50" contenteditable="false" class="jqx-editor-paste-element"></textarea>');var r=e(window).scrollTop(),a=e(t.editorDocument).find(".jqx-editor-paste-element");if(a.css("top",r+"px"),t.editor[0].createTextRange){o.preventDefault();var l=t.editor[0].createTextRange();l.moveToElementText(a[0]),l.execCommand("Paste")}else{var d=t.editorDocument.createRange();d.selectNodeContents(a[0]),t.selectRange(d)}"text"!=t.pasteMode||e.jqx.browser.mozilla||a.select(),t.marker=a,setTimeout(function(){t.selectRange(n);var o=function(e){var o=t.editorDocument.createElement("div"),i=t.editorDocument.createDocumentFragment();for(o.innerHTML=e;o.firstChild;)i.appendChild(o.firstChild);return i};if("text"!=t.pasteMode){var r=o(t.marker.html());if(r.firstChild&&"jqx-editor-paste-element"===r.firstChild.className){for(var a=[],l=0,d=r.childNodes.length;l<d;l++)a.push(r.childNodes[l].innerHTML);r=o(a.join("<br />"))}var s=document.createElement("div");s.appendChild(r.cloneNode(!0));c=s.innerHTML}else{c=t.marker.val();if(""!=t.marker.html()&&-1==t.marker.val().indexOf("\n")){c=(c=(c=(c=(c=(c=t.marker.html()).replace(/&nbsp;/gm,"")).replace(/\n\n/gm,"\n")).replace(/<br[^>]*>/gi,"\n")).replace(/<li[^>]*>/gi,"\n")).replace(/<p[^>]*>/gi,"\n"),t.marker.html(c);var c=t.marker.text()}}var u=i(c,"text"==t.pasteMode);t.getRange();t.selection.insertContent(u+"<span id='INSERTION_MARKER'>&nbsp;</span>"),t.marker.remove();var g=e(t.editorDocument).find("#INSERTION_MARKER");t.selection.selectNode(g[0],!0),t.getRange().setStartAfter&&t.getRange().setStartAfter(g[0]),g.remove(),t.selection.collapse(!1),g.removeAttr("id"),t._refreshTools(),t.changed=!0},100),t.updating=!1,t.readOnly=!1}catch(e){console&&console.log(e)}}),t.addHandler(t.editor,"keyup.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if(t.updating||t.disabled||!t.editable)return o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),!1;t.range=t.getRange(),t.changed=!0;var i=o||window.event,n=(i.keyCode,[8,9,13,33,34,35,36,37,38,39,40,40,45,46]);(-1!=e.inArray(i.keyCode,n)||65==i.keyCode&&i.ctrlKey&&!i.altKey&&!i.shiftKey)&&t._refreshTools(null,!0,i.keyCode)}),t.addHandler(t.editor,"click.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if(t.editImage&&(e(t.editImage).removeClass("jqx-editor-focus"),t.editImage=null),"img"==o.target.tagName.toLowerCase()){var i=o.target;t.editImage=i,e(t.editImage).addClass("jqx-editor-focus")}}),t.addHandler(t.editor,"dblclick.editor"+t.element.id,function(o){if("source"==t._documentMode)return!0;if("img"==o.target.tagName.toLowerCase()){var i=o.target;e("#imageWindow"+this.element.id).length>0&&(t.editImage=i,t._updateImageWindow())}})},_updateLinkWindow:function(){var t=this,o=e("#linkWindow"+this.element.id);o.jqxWindow({position:{center:t.widget}}),o.jqxWindow("open");var i=o.find("input"),n=o.find(".jqx-editor-link-checkbox"),r=o.find("button:first"),a=e(o.find("button")[1]);if(t.editLink&&t.editLink.href)i[0].value=t.editLink.href||"",i[1].value=e(t.editLink).text()||t.editLink.href,n.val("_blank"==e(t.editLink).attr("target")),a.show();else{if(i[0].value="",i[1].value="",!t.selection.isCollapsed()){var l=t.selection.getText();l.match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?i[0].value=l:i[1].value=l}n.val(!1),a.hide()}i[0].value.length>0?r.jqxButton({disabled:!1}):r.jqxButton({disabled:!0})},_updateImageWindow:function(){var t=this,o=t.editImage;o||(o=e("<img>")[0]);var i=e("#imageWindow"+this.element.id);i.jqxWindow({position:{center:t.widget}}),i.jqxWindow("open");var n=i.find("input"),r=e(i.find("button")[1]);t.editImage?r.show():r.hide(),n[0].value=o.src,""==n[0].value&&(n[0].value=""),n[1].value=o.alt,"auto"!=o.style.width?n[2].value=o.style.width:n[2].value="","auto"!=o.style.height?n[3].value=o.style.height:n[3].value="",o.style.marginLeft&&"0px"!=o.style.marginLeft?n[4].value=o.style.marginLeft:n[4].value="",o.style.marginTop&&"0px"!=o.style.marginTop?n[5].value=o.style.marginTop:n[5].value="";var a=i.find(".jqx-editor-align"),l=e(o).css("float");"left"==l?a.jqxDropDownList({selectedIndex:1}):"right"==l?a.jqxDropDownList({selectedIndex:2}):a.jqxDropDownList({selectedIndex:0})},_removeHandlers:function(){var e=this;e.editor&&(e.removeHandler(e.editor,"blur.editor"+e.element.id),e.removeHandler(e.editor,"focus.editor"+e.element.id),e.removeHandler(e.editor,"click.editor"+e.element.id),e.removeHandler(e.editor,"mousedown.editor"+e.element.id),e.removeHandler(e.editor,"mouseup.editor"+e.element.id),e.removeHandler(e.editor,"keyup.editor"+e.element.id),e.removeHandler(e.editor,"keydown.editor"+e.element.id),e.removeHandler(e.editor,"beforedeactivate.editor"+e.element.id),e.removeHandler(e.editor,"dblclick.editor"+e.element.id)),e.toolbar&&e.removeHandler(e.toolbar,"mousedown.editor"+e.element.id)},getParentByTag:function(e,t){var t=t.toLowerCase(),o=e;do{if(""==t||o.nodeName.toLowerCase()==t)return o}while(o=o.parentNode);return e},isStyleProperty:function(e,t,o,i){var t=t.toLowerCase(),n=e;do{if(n.nodeName.toLowerCase()==t&&n.style[o]==i)return!0}while(n=n.parentNode);return!1},setStyleProperty:function(e,t){this.style[t]=!1;var o=this.getParentByTag(e,t);o&&o.tagName.toLowerCase()==t&&(this.style[t]=!0),"del"==t&&this.getParentByTag(e,"strike")&&"strike"==this.getParentByTag(e,"strike").tagName.toLowerCase()&&(this.style.del=!0)},updateStyle:function(e){var t=this;if((e=t.getSelectedElement()?t.getSelectedElement():e)&&t.setStyleProperty)try{if(window.getComputedStyle){"#text"==e.nodeName.toLowerCase()&&(e=t.editor[0]);var o=401==(i=window.getComputedStyle(e,null)).getPropertyValue("font-weight")?700:i.getPropertyValue("font-weight");t.style={fontStyle:i.getPropertyValue("font-style"),fontSize:i.getPropertyValue("font-size"),textDecoration:i.getPropertyValue("text-decoration"),fontWeight:o,fontFamily:i.getPropertyValue("font-family"),textAlign:i.getPropertyValue("text-align"),color:t._rgbToHex(i.color),backColor:t._rgbToHex(i.backgroundColor)},t.style.fontStyle=i.getPropertyValue("font-style"),t.style.vAlign=i.getPropertyValue("vertical-align"),t.style.del=t.isStyleProperty(e,"span","textDecoration","line-through"),t.style.u=t.isStyleProperty(e,"span","textDecoration","underline");t.style.backColor||(t.style.backColor=t._rgbToHex(function(e){for(;e&&("transparent"==window.getComputedStyle(e).backgroundColor||"rgba(0, 0, 0, 0)"==window.getComputedStyle(e).backgroundColor);)e=e.parentNode;return e?window.getComputedStyle(e).backgroundColor:"transparent"}(e)))}else{var i=e.currentStyle;t.style={fontStyle:i.fontStyle,fontSize:i.fontSize,textDecoration:i.textDecoration,fontWeight:i.fontWeight,fontFamily:i.fontFamily,textAlign:i.textAlign,color:t._rgbToHex(i.color),backColor:t._rgbToHex(i.backgroundColor)}}t.setStyleProperty(e,"h1"),t.setStyleProperty(e,"h2"),t.setStyleProperty(e,"h3"),t.setStyleProperty(e,"h4"),t.setStyleProperty(e,"h5"),t.setStyleProperty(e,"h6"),t.setStyleProperty(e,"del"),t.setStyleProperty(e,"sub"),t.setStyleProperty(e,"sup"),t.setStyleProperty(e,"u"),"a"==e.nodeName.toLowerCase()&&"underline"==t.style.textDecoration&&(t.style.u=!0),(t.style.h1||t.style.h2||t.style.h3||t.style.h4||t.style.h5||t.style.h6)&&(t.style.heading=!0)}catch(e){return null}},_refreshTools:function(t,o,i){var n=this;if(!n.updating&&(t=n.getSelectedElement()?n.getSelectedElement():t)&&n.setStyleProperty){n.updateStyle(t);var r=n.readOnly;if(n.readOnly=!0,!1!==n.tools){var a=n.tools.split(" "),l=n.tools.split(" | "),d=function(t){e.each(t,function(e,t){var o=n.commands[this];if(!o)return!0;switch(o.type){case"list":o.widget.jqxDropDownList("clearSelection"),o.widget.jqxDropDownList({disabled:n.disabled});break;case"colorPicker":o.val(o.value),o.widget.jqxDropDownButton({disabled:n.disabled});break;case"toggleButton":o.widget.jqxToggleButton("unCheck"),o.widget.jqxToggleButton({disabled:n.disabled});break;case"button":default:o.widget.jqxButton({disabled:n.disabled})}})};if(0==l.length)d(a);else for(c=0;c<l.length;c++)d(a=(u=l[c]).split(" "));if(n.style){var s=function(i){e.each(i,function(i,r){var a=n.commands[this];if(!a)return!0;if(a.refresh)return a.refresh(a.widget,n.style),!0;switch(a.type){case"list":if("fontname"==a.command){for(var l=-1,d=999,s=0;s<a.value.length;s++){var r=a.value[s].label.toLowerCase(),c=n.style.fontFamily.toLowerCase().indexOf(r);c>=0&&(c<d&&(l=s),d=Math.min(d,c))}a.widget.jqxDropDownList("selectIndex",l)}else if("formatblock"==a.command){r=null;n.style.h1?r="h1":n.style.h2?r="h2":n.style.h3?r="h3":n.style.h4?r="h4":n.style.h5?r="h5":n.style.h6&&(r="h6"),a.widget.jqxDropDownList("selectItem",r)}else if("fontsize"==a.command){var u="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),g=-1;try{-1==(g=t.getAttribute("size")-1)&&(g=n.editorDocument.queryCommandValue(a.command)-1)}catch(e){}var p=u[g];a.widget.val(p)}break;case"colorPicker":var h=function(e){return"number"!=typeof e?e:"rgb("+(255&e)+", "+((65280&e)>>8)+", "+((16711680&e)>>16)+")"}(n.editorDocument.queryCommandValue(a.command));"backcolor"==a.command&&null==n.style.backColor&&(h="#FFFFFF");var m=n._rgbToHex(h);m?a.val(m):"forecolor"==a.command?a.val(n.style.color):"backcolor"==a.command&&a.val(n.style.backColor);break;case"toggleButton":if("viewsource"==a.command)return;if(!a.command)return;var f=!1,b=n.editorDocument.queryCommandState(a.command)&&n.editorDocument.queryCommandEnabled(a.command);if("createlink"==a.command&&"a"==t.nodeName.toLowerCase()){var v=!0;if(-1==e(t).text().indexOf(n.selection.getText())&&""!=n.selection.getText()&&(v=!1),v){n.linkPopup&&n.linkPopup.remove(),b=!0,n.linkPopup=e("<div class='jqx-editor-link-popup' contentEditable='false' style='overflow: hidden; white-space: nowrap; padding: 5px; height: 17px; font-size: 12px; color: #222222; background: #F5F5F5; position: absolute; z-index: 9999;'>"+n.localization["Go to link"]+": <a target='_blank' style='color:#222222;' href='"+t.href+"'>"+t.href+"</a> - <a style='color:#222222;' href='#change'>"+n.localization.Change+"</a> - <a style='color:#222222;' href='#remove'>"+n.localization.Remove+"</a></div>").appendTo(n.editor);var x=e(t).coord(),y=x.left;x.left+n.linkPopup.width()>n.editor.width()&&(y=n.editor.width()-n.linkPopup.width()-15),n.linkPopup.offset({top:e(t).height()+x.top+5,left:y}),n.addHandler(n.linkPopup,"mousedown",function(o){if(o.target&&o.target.href)switch(e(o.target).index()){case 1:n.editor.focus(),n.selection.selectNode(t,!0),n.commands.link.widget.trigger("click");break;case 2:try{n.editor.focus(),n.selection.selectNode(t),n.execute("unlink"),n.commands.underline.toggled=!1,n.selection.collapse(!1),n._refreshTools()}catch(e){}break;default:window.open(o.target.href,"_blank")}return o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation(),!1})}}"bold"==a.command?(n.style.fontWeight&&(n.style.fontWeight>=600||"bold"==n.style.fontWeight)&&(f=!0),n.selection.isCollapsed()?a.toggled=b:a.toggled=b||f,b=a.toggled):"italic"==a.command?(n.style.fontStyle&&"italic"==n.style.fontStyle&&(f=!0),o?a.toggled=b:b=a.toggled):"underline"==a.command?(n.style.u&&(f=!0),o?a.toggled=b:b=a.toggled):"justifyleft"==a.command?"left"==n.style.textAlign&&(f=!0):"justifyright"==a.command?"right"==n.style.textAlign&&(f=!0):"justifycenter"==a.command?"center"==n.style.textAlign&&(f=!0):"justifyfull"==a.command?"justify"==n.style.textAlign&&(f=!0):e.each(n.style,function(e,t){a.command==e.toLowerCase()&&(f=!0)});var w=b;f&&-1!=a.command.indexOf("justify")?a.widget.jqxToggleButton("check"):w?a.widget.jqxToggleButton("check"):f&&!1===n.range.collapsed?a.widget.jqxToggleButton("check"):e.jqx.browser.msie&&e.jqx.browser.version<9&&f&&!n.selection.isCollapsed()&&a.widget.jqxToggleButton("check");break;case"button":default:a.refresh&&a.refresh(a.widget,n.style)}})};if(0==l.length)s(a);else for(var c=0;c<l.length;c++){var u=l[c];s(a=u.split(" "))}}}n.readOnly=r}},_rgbToHex:function(e){if(e){if("#"===e.substr(0,1))return 4==e.length?"#"+(o=e.substr(1,1))+o+(i=e.substr(2,1))+i+(n=e.substr(3,1))+n:e;var t=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(e);if(!t)return null;var o=parseInt(t[2],10).toString(16),i=parseInt(t[3],10).toString(16),n=parseInt(t[4],10).toString(16);return"#"+((1==o.length?"0"+o:o)+(1==i.length?"0"+i:i)+(1==n.length?"0"+n:n))}return null},_preventDefault:function(t,o){!1!==o&&(e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close")),t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1},_addCommandHandler:function(t,o,i,n,r){var a=this;switch(!i&&r.init&&(i="custom"),i){case"custom":switch(r.type){case"list":action=function(t){"source"!=a._documentMode&&"none"!=t.args.type&&(r.value=e(this).val(),a.execute("custom",r),a.readOnly||a._refreshTools()),a._preventDefault(t,!1)};break;case"colorPicker":action=function(t){if("source"!=a._documentMode){e(r.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell");if("div"==t.target.nodeName.toLowerCase()){o=e(t.target).css("background-color");e(t.target).parent().addClass("jqx-editor-color-picker-selected-cell")}else{var o=e(t.target).find("div").css("background-color");e(t.target).addClass("jqx-editor-color-picker-selected-cell")}e("#bar-"+i).css("background",o),r.widget.val=function(){var e=function(e){return"number"!=typeof e?e:"rgb("+(255&e)+", "+((65280&e)>>8)+", "+((16711680&e)>>16)+")"}(o);return a._rgbToHex(e)},r.widget.jqxDropDownButton("close"),a.execute("custom",r)}return a._preventDefault(t),!1};break;case"button":case"toggleButton":default:action=function(t){e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(t);e(this).attr("data-command");return"source"!=a._documentMode&&(r.toggle&&r.toggle(),a.execute("custom",r),a._refreshTools()),!1}}break;case"formatblock":action=function(t){"source"!=a._documentMode&&"none"!=t.args.type&&(a.execute(e(this).attr("data-command"),"<"+e(this).val()+">",r),a.readOnly||(a.commands.bold.toggled=!1,a._refreshTools())),a._preventDefault(t,!1)};break;case"fontsize":action=function(t){if("source"!=a._documentMode&&"none"!=t.args.type){var o=e(this).val(),i="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),n=e(this).jqxDropDownList("getSelectedIndex")+1,n=1+i.indexOf(o);a.execute(e(this).attr("data-command"),n,r)}a._preventDefault(t,!1)};break;case"fontname":action=function(t){if("source"!=a._documentMode&&"none"!=t.args.type){var o=e(this).val();a.execute(e(this).attr("data-command"),o,r)}a._preventDefault(t,!1)};break;case"forecolor":case"backcolor":action=function(t){if("source"!=a._documentMode){e(r.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell");if("div"==t.target.nodeName.toLowerCase()){o=e(t.target).css("background-color");e(t.target).parent().addClass("jqx-editor-color-picker-selected-cell")}else{var o=e(t.target).find("div").css("background-color");e(t.target).addClass("jqx-editor-color-picker-selected-cell")}e("#bar-"+i).css("background",o),r.widget.jqxDropDownButton("close"),a.execute(i,o,r)}return a._preventDefault(t),!1};break;case"viewsource":action=function(t){return a.linkPopup&&a.linkPopup.remove(),r.toggle(),a.setMode(r.toggled),e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(t),!1};break;case"insertimage":action=function(e){a._insertImageAction(e,a,r)};break;case"createlink":action=function(e){a._createLinkAction(e,a,r)};break;default:action=function(t){e(".jqx-editor-dropdownpicker").length>0&&e(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),e(".jqx-editor-dropdownlist").length>0&&e(".jqx-editor-dropdownlist").jqxDropDownList("close"),a._preventDefault(t);var o=e(this).attr("data-command");if("source"!=a._documentMode){if("underline"==o&&a.getSelectedElement()){var i=a.getSelectedElement();if(i&&"a"==i.nodeName.toLowerCase())return r.toggled?e(i).css("text-decoration","none"):e(i).css("text-decoration","underline"),r.toggle(),a._refreshTools(),!1}r.toggle&&r.toggle(),a.execute(o,e(this).val(),r),a._refreshTools()}return!1}}return a.addHandler(t,o,action),!1},_createLinkAction:function(t,o,i){if("source"!=(o=this)._documentMode){o.focused||o.editor.focus(),o.range=o.getRange();var n=o.getSelectedElement();if("a"==n.nodeName.toLowerCase()?o.editLink=n:o.editLink=null,e("#linkWindow"+this.element.id).length>0)return o.editLink&&o.selection.selectNode(n,!0),o._updateLinkWindow(),o._preventDefault(t),!1;var r=e("<div class='jqx-editor-window jqx-editor-link-window'><div>"+o.localization["Insert Link"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+o.localization.URL+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.Title+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'></td><td><div class='jqx-editor-link-checkbox'>"+o.localization["Open in a new window/tab"]+"</div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>");r[0].id="linkWindow"+this.element.id;var a=r.find("input");a.addClass(o.toThemeProperty("jqx-widget")),a.addClass(o.toThemeProperty("jqx-widget-content")),a.addClass(o.toThemeProperty("jqx-input"));var l=r.find(".jqx-editor-link-checkbox").jqxCheckBox({theme:o.theme,height:23,width:180}),d=r.find("button:first").jqxButton({theme:o.theme,disabled:!0}),s=e(r.find("button")[1]).jqxButton({theme:o.theme}),c=r.find("button:last").jqxButton({theme:o.theme});d.val(o.localization.Ok),c.val(o.localization.Cancel),s.val(o.localization.Remove),o.addHandler(c,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){o.editor.focus(),o.selectRange(o.range),o._refreshTools(),o._preventDefault(e)}),(!o.editLink||o.editLink&&!o.editLink.href)&&s.hide();var u=!1;if(o.addHandler(e(a[0]),"focus",function(){u=""==a[1].value||a[1].value==a[0].value}),o.addHandler(e(a[1]),"keyup",function(e){e.keyCode&&(13==e.keyCode&&d.trigger("click"),27==e.keyCode&&c.trigger("click"))}),o.addHandler(e(a[0]),"keyup change",function(e){a[0].value.length>0?d.jqxButton({disabled:!1}):d.jqxButton({disabled:!0}),u&&(a[1].value=a[0].value),e.keyCode&&(13==e.keyCode&&d.trigger("click"),27==e.keyCode&&c.trigger("click"))}),o.addHandler(s,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(e){r.jqxWindow("close");try{o.editor.focus(),o.selection.selectNode(o.editLink),o.execute("unlink"),o.selection.collapse(!1),o.commands.underline.toggled=!1,o._refreshTools()}catch(e){}o._preventDefault(e)}),o.addHandler(d,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){var n=r.find("input"),a=e("<a>"+(n[1].value||n[0].value)+"</a>");l.val()&&a.attr("target","_blank"),a[0].href=e.trim(n[0].value),-1==n[0].value.indexOf("http")&&-1==n[0].value.indexOf("mailto")&&(a[0].href="http://"+e.trim(n[0].value)),o.focused||o.editor.focus(),o.range&&o.selectRange(o.range),o.editLink&&e(o.editLink).remove(),o.execute("insertHTML",a[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",i),o.editor.focus();var d=e(o.editorDocument).find("#INSERTION_MARKER");o.selection.selectNode(d[0],!0),o.getRange().setStartAfter&&o.getRange().setStartAfter(d[0]),d.remove(),o.selection.collapse(!1),o._refreshTools(),o._preventDefault(t)}),o.updating=!0,r.appendTo(document.body),o.addHandler(r,"open",function(){o.updating=!0,setTimeout(function(){o.range=o.getRange(),e(a[0]).focus()},25)}),r.jqxWindow({resizable:!1,width:280,okButton:d,cancelButton:c,theme:o.theme,isModal:!0,position:{center:o.widget}}),o.addHandler(r,"close",function(){o.updating=!1}),o.focused||(o.editor.focus(),o.selectRange(o.range)),o.editLink)a[0].value=o.editLink.href||"",a[1].value=e(o.editLink).text(),l.val("_blank"==e(o.editLink).attr("target"));else if(!o.selection.isCollapsed()){var g=o.selection.getText();g.match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?a[0].value=g:a[1].value=g}return a[0].value.length>0?d.jqxButton({disabled:!1}):d.jqxButton({disabled:!0}),o._preventDefault(t),!1}o._preventDefault(t)},_insertImageAction:function(t,o,i){if("source"!=o._documentMode){if(o.focused||o.editor.focus(),o.range=o.getRange(),e("#imageWindow"+this.element.id).length>0)return o._updateImageWindow(),o._preventDefault(t),!1;var n=e("<div class='jqx-editor-window jqx-editor-image-window'><div>"+o.localization["Insert Image"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+o.localization.URL+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization["Alt Text"]+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.Width+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.Height+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+o.localization.HSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-hspace'/></td><tr/><tr><td align='right'>"+o.localization.VSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-vspace'/></td><tr/><tr><td align='right'>"+o.localization.Align+":</td><td><div class='jqx-editor-align'></div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>");n[0].id="imageWindow"+this.element.id;var r=n.find("input");r.addClass(o.toThemeProperty("jqx-widget")),r.addClass(o.toThemeProperty("jqx-widget-content")),r.addClass(o.toThemeProperty("jqx-input")),n.find(".jqx-editor-align").jqxDropDownList({autoDropDownHeight:!0,selectedIndex:0,theme:o.theme,height:23,width:180,source:[o.localization["not set"],o.localization.Left,o.localization.Right]});var a=n.find("button:first").jqxButton({theme:o.theme}),l=n.find("button:last").jqxButton({theme:o.theme}),d=e(n.find("button")[1]).jqxButton({theme:o.theme});return a.val(o.localization.Ok),l.val(o.localization.Cancel),d.val(o.localization.Remove),d.hide(),o.addHandler(d,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){e(o.editImage).removeClass("jqx-editor-focus"),e(o.editImage).remove(),o.editImage=null,o._preventDefault(t),n.jqxWindow("close"),o._raiseEvent("change")}),o.addHandler(l,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){e(o.editImage).removeClass("jqx-editor-focus"),o.editImage=null,o._preventDefault(t)}),o.addHandler(a,e.jqx.mobile.isTouchDevice()?e.jqx.mobile.getTouchEventName("touchstart"):"click",function(t){e(o.editImage).removeClass("jqx-editor-focus");var r=n.find("input"),a=e(o.editImage?o.editImage:'<img style="border: 1px solid transparent;">').attr("src",r[0].value).attr("unselectable","on");r[1].value&&a.attr("alt",r[1].value).attr("title",r[1].value),r[2].value&&!isNaN(parseInt(r[2].value))?a.width(r[2].value):a.css("width","auto"),r[3].value&&!isNaN(parseInt(r[3].value))?a.height(r[3].value):a.css("height","auto"),r[4].value?"auto"==r[4].value.toString()?(a.css("margin-left","auto"),a.css("margin-right","auto")):-1!=r[4].value.toString().indexOf("%")?(a.css("margin-left",parseInt(r[4].value)+"%"),a.css("margin-right",parseInt(r[4].value)+"%")):(a.css("margin-left",parseInt(r[4].value)+"px"),a.css("margin-right",parseInt(r[4].value)+"px")):(a.css("margin-left","0px"),a.css("margin-right","0px")),r[5].value?"auto"==r[5].value.toString()?(a.css("margin-top","auto"),a.css("margin-bottom","auto")):-1!=r[5].value.toString().indexOf("%")?(a.css("margin-top",parseInt(r[5].value)+"%"),a.css("margin-bottom",parseInt(r[5].value)+"%")):(a.css("margin-top",parseInt(r[5].value)+"px"),a.css("margin-bottom",parseInt(r[5].value)+"px")):(a.css("margin-top","0px"),a.css("margin-bottom","0px"));var l=n.find(".jqx-editor-align").jqxDropDownList("selectedIndex");if(1==l?a.css("float","left"):2==l?a.css("float","right"):0==l&&a.css("float","none"),a.css("resize",!1),a[0].oncontrolselect=function(){return!1},a[0].selectstart=function(){return!1},!o.editImage){o.focused||o.editor.focus(),o.range&&o.selectRange(o.range),o.execute("insertHTML",a[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",i),o.editor.focus();var d=e(o.editorDocument).find("#INSERTION_MARKER");o.selection.selectNode(d[0],!0),o.getRange().setStartAfter&&o.getRange().setStartAfter(d[0]),d.remove(),o.selection.collapse(!1),o._refreshTools(),o._preventDefault(t)}o.editImage=null,o._preventDefault(t)}),n.appendTo(document.body),o.updating=!0,o.addHandler(n,"open",function(){o.updating=!0,setTimeout(function(){o.range=o.getRange(),e(r[0]).focus()},25)}),n.jqxWindow({resizable:!1,width:280,okButton:a,cancelButton:l,theme:o.theme,isModal:!0,position:{center:o.widget}}),o.addHandler(n,"close",function(){o.updating=!1}),o.focused||(o.editor.focus(),o.selectRange(o.range)),o._preventDefault(t),!1}o._preventDefault(t)},editmode:function(t){var o=this;if(t||o.readOnly){if(t&&o.readOnly){i=o.editor.find("#sourceText").text();o.editor.html(i),o.buttons.hasOwnProperty("html")&&o.buttons.html.removeClass("active"),o.editor.attr("contentEditable",!0),o._addHandlers()}}else{o._removeHandlers(),o.editor.attr("contentEditable",!1);var i=document.createTextNode(o.editor.html()),n=e("<pre>");n.html(i).attr({id:"sourceText",contentEditable:!0}).css("height","100%"),o.editor.html(n),o.buttons.hasOwnProperty("html")&&o.buttons.html.addClass("active"),n.focus()}o.readOnly=!t},setMode:function(t){var i=this;i.range||(i.editor.focus(),i.range=i.getRange());var n,r=i.editor[0];if(t){i._documentMode="source";var a=new o,l=a.HTMLtoXML(r.innerHTML);l=a.FormatHTML(l),n=document.createTextNode(l),r.innerHTML="";var d=document.createElement("pre");r.contentEditable=!1,d.style.height="100%",d.style.margin="0px",d.style.outline="none",d.style.display="block",d.id="sourceText",d.contentEditable=!0,d.appendChild(n),r.appendChild(d),this.readOnly=!0}else this._documentMode="html",document.all?r.innerHTML=r.innerText:r.textContent?r.innerHTML=r.textContent:((n=document.createRange()).selectNodeContents(r.firstChild),r.innerHTML=n.toString()),r.contentEditable=!0,i.readOnly=!1,i._refreshTools(),i.editor.focus(),i.selection.selectNode(i.editor[0]),i.editor.scrollTop(0),i.selection.collapse(!0);if(e.each(this.commands,function(){if(this.widget&&"viewsource"!=this.command)switch(this.type){case"list":this.widget.jqxDropDownList({disabled:t});break;case"colorPicker":this.widget.jqxDropDownButton({disabled:t});break;case"button":this.widget.jqxButton({disabled:t});break;case"toggleButton":this.widget.jqxToggleButton({toggled:!1,disabled:t})}}),i.editor.focus(),e.jqx.browser.mozilla){var s=e("<a href='#'>anchor</a>");i.editor.prepend(s),s.focus(),s.remove(),i.selection.collapse(!0)}i.commands.html.widget&&(i.commands.html.widget.jqxToggleButton({toggled:"source"==t||1==t}),i.commands.html.toggled="source"==t||1==t)},execute:function(t,o,i){var n=this;if(!n.readOnly){var r=n.editorDocument;if("source"==n._documentMode)return;n.changeType="mouse",n.linkPopup&&n.linkPopup.remove(),n.editor.focus(),e.jqx.browser.mozilla,e.jqx.mobile.isTouchDevice()&&setTimeout(function(){},25);var a=function(t){try{if(t.command&&"inserthtml"==t.command.toLowerCase()){var o=n.getRange(),i=t.value;-1==i.toString().indexOf("<")&&(i="<span>"+t.value+"</span>"),n.selection.insertContent(i+"<span id='INSERTION_MARKER'>&nbsp;</span>"),n.selectRange(o),setTimeout(function(){var t=e(n.editorDocument).find("#INSERTION_MARKER");n.selection.selectNode(e(t).prev()[0],!0),t.remove(),n.selection.collapse(!1)},10)}else if(t.command){if(!r.queryCommandEnabled(t.command))return!1;r.execCommand(t.command,!1,t.value)}else{if(!r.queryCommandEnabled(t))return!1;r.execCommand(t,!1,t)}}catch(e){}};if("custom"==t)(l=o.action(o.widget,n.editor))&&a(l);else try{if(i&&i.action){var l=i.action(i.widget,n.editor);a(l)}else if(r.queryCommandEnabled(t))r.execCommand(t,!1,o);else{if("insertHTML"!=t)return!1;n.selection.insertContent(o)}}catch(e){if("insertHTML"!=t)return!1;n.selection.insertContent(o)}e.jqx.mobile.isTouchDevice()&&setTimeout(function(){n.iframe&&n.iframe[0].contentWindow.focus()},500),n._raiseEvent("change",{command:t,args:o}),n.changed=!0,n.range=n.getRange()}},destroy:function(){var t=this;t._removeHandlers();var o=t.tools.split(" "),i=t.tools.split(" | ");e.jqx.utilities.resize(this.host,null,!0);var n=function(o){e.each(o,function(o,i){var n=t.commands[this];if(!n)return!0;switch(n.type){case"list":n.widget.jqxDropDownList("destroy");break;case"colorPicker":n.colorPicker.remove(),n.widget.jqxDropDownButton("destroy");break;case"toggleButton":n.widget.jqxToggleButton("destroy");break;case"custom":t.destroyTool&&t.destroyTool(this);break;case"button":default:n.widget.jqxToggleButton("destroy"),"insertimage"===n.command?e("#imageWindow"+t.element.id).length>0&&(e("#imageWindow"+t.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),e("#imageWindow"+t.element.id).find("button").jqxButton("destroy")):"createlink"===n.command&&e("#linkWindow"+t.element.id).length>0&&(e("#linkWindow"+t.element.id).find(".jqx-editor-align").jqxDropDownList("destroy"),e("#linkWindow"+t.element.id).find("button").jqxButton("destroy"),e("#linkWindow"+t.element.id).find(".jqx-editor-link-checkbox").jqxCheckBox("destroy"))}})};if(0==i.length)n(o);else for(var r=0;r<i.length;r++)n(o=i[r].split(" "));var a=e("#linkWindow"+this.element.id),l=e("#imageWindow"+this.element.id);a&&a.length>0&&a.jqxWindow("destroy"),l&&l.length>0&&l.jqxWindow("destroy"),t.inline?t.toolbar.remove():(t.widget.remove(),t.host.remove()),t.iframe.remove(),t.iframe=null,t.selection=null,t.editorDocument=null,t.contentEditableElement=null},val:function(e){if(void 0!==e&&"source"===e){var t=this.editor[0];"source"===this._documentMode&&(t=this.editor.find("pre:first")[0]);var i=new o,n=i.HTMLtoXML(t.innerHTML);return n=i.FormatHTML(n)}return void 0!=e&&"object"!=typeof e&&this.editor.html(e),"source"===this._documentMode?this.editor.find("pre:first").html():this.editor.html()},_raiseEvent:function(t,o){if(void 0==o&&(o={owner:null}),"source"==this._documentMode)return!0;var i=t;o.type=this.changeType,this.changeType=null,args=o,args.owner=this;var n=new e.Event(i);if(n.owner=this,n.args=args,this._textArea)r=e(this._textArea).trigger(n);else var r=this.host.trigger(n);return o=n.args,r}});var t=function(t){var o={initialize:function(e){this.document=e},getSelection:function(){return this.document.getSelection?this.document.getSelection():this.document.selection},getRange:function(){var e=this.getSelection();if(!e)return null;try{return e.rangeCount>0?e.getRangeAt(0):this.document.createRange?this.document.createRange():this.document.selection.createRange()}catch(e){return this.document.body.createTextRange()}},selectRange:function(e){if(e.select)e.select();else{var t=this.getSelection();t.addRange&&(t.removeAllRanges(),t.addRange(e))}},selectNode:function(e,t){var o=this.getRange(),i=this.getSelection();if(o.moveToElementText)o.moveToElementText(e),o.select();else if(i.addRange)try{t?o.selectNodeContents(e):o.selectNode(e),i.removeAllRanges(),i.addRange(o)}catch(e){}else i.setBaseAndExtent(e,0,e,1);return e},isCollapsed:function(){var e=this.getRange();return!e.item&&(0==e.boundingWidth||this.getSelection().isCollapsed)},collapse:function(e){var t=this.getRange(),o=this.getSelection();t.select?(t.collapse(e),t.select()):e?o.collapseToStart():o.collapseToEnd()},getContent:function(){var t=this.getRange(),o=e("<div>")[0];return this.isCollapsed()?"":(t.cloneContents?o.appendChild(t.cloneContents()):void 0!=t.item||void 0!=t.htmlText?e(o).html(t.item?t.item(0).outerHTML:t.htmlText):e(o).html(t.toString()),e(o).html())},getText:function(){var e=this.getRange(),t=this.getSelection();return this.isCollapsed()?"":e.text||(t.toString?t.toString():"")},getNode:function(){var o=this.getRange();if(!e.jqx.browser.msie||e.jqx.browser.version>=9){var i=null;if(o)for(i=o.commonAncestorContainer,o.collapsed||o.startContainer==o.endContainer&&o.startOffset-o.endOffset<2&&o.startContainer.hasChildNodes()&&(i=o.startContainer.childNodes[o.startOffset]);"element"!=typeof i;)i=i.parentNode;return t.id(i)}return t.id(o.item?o.item(0):o.parentElement())},insertContent:function(e){var t=this.getRange();if(t.pasteHTML)t.pasteHTML(e),t.collapse(!1),t.select();else if(t.insertNode)if(t.deleteContents(),t.createContextualFragment)t.insertNode(t.createContextualFragment(e));else{var o=this.document,i=o.createDocumentFragment(),n=o.createElement("div");i.appendChild(n),n.outerHTML=e,t.insertNode(i)}}};return o.initialize(t),o},o=function(){function e(e){for(var t={},o=e.split(","),i=0;i<o.length;i++)t[o[i]]=!0;return t}var t=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,o=/^<\/([-A-Za-z0-9_]+)[^>]*>/,i=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,n=e("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),r=e("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),a=e("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),l=e("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),d=e("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),s=e("script,style"),c=this.HTMLParser=function(e,c){function u(e,t){if(t)for(o=m.length-1;o>=0&&m[o].toLowerCase()!=t.toLowerCase();o--);else var o=0;if(o>=0){for(var i=m.length-1;i>=o;i--)c.end&&c.end(m[i]);m.length=o}}var g,p,h,m=[];for(m.last=function(){return this[this.length-1]};e;){if(p=!0,m.last()&&s[m.last()])e=e.replace(new RegExp("(.*)</"+m.last()+"[^>]*>"),function(e,t){return t=t.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),c.chars&&c.chars(t),""}),u(0,m.last());else if(0==e.indexOf("\x3c!--")?(g=e.indexOf("--\x3e"))>=0&&(c.comment&&c.comment(e.substring(4,g)),e=e.substring(g+3),p=!1):0==e.indexOf("</")?(h=e.match(o))&&(e=e.substring(h[0].length),h[0].replace(o,u),p=!1):0==e.indexOf("<")&&(h=e.match(t))&&(e=e.substring(h[0].length),h[0].replace(t,function(e,t,o,s){if(t=t.toLowerCase(),r[t])for(;m.last()&&a[m.last()];)u(0,m.last());if(l[t]&&m.last()==t&&u(0,t),(s=n[t]||!!s)||m.push(t),c.start){var g=[];o.replace(i,function(e,t){var o=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:d[t]?t:"";g.push({name:t,value:o,escaped:o.replace(/(^|[^\\])"/g,'$1\\"')})}),c.start&&c.start(t,g,s)}}),p=!1),p){var f=(g=e.indexOf("<"))<0?e:e.substring(0,g);e=g<0?"":e.substring(g),c.chars&&c.chars(f)}e}u()};this.HTMLtoXML=function(e){var t="";return e=e.replace(/\r/gi,""),e=e.replace(/\n/gi,""),c(e,{start:function(e,o,i){t+="<"+e;for(var n=0;n<o.length;n++)t+=" "+o[n].name+'="'+o[n].escaped+'"';t+=(i?"/":"")+">"},end:function(e){t+="</"+e+">\r\n"},chars:function(e){t+=e},comment:function(e){t+="\x3c!--"+e+"--\x3e"}}),t},this.FormatHTML=function(e,t){var o,i,n,r,a;for(i=(t=t||{}).indent_size||4,n=t.indent_char||" ",r=t.brace_style||"collapse",1/0,a=t.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],(o=new function(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(e,t){for(var o=0;o<t.length;o++)if(e===t[o])return!0;return!1}},this.get_content=function(){for(var e="",t=[],o=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return t.length?t.join(""):["","TK_EOF"];if(e=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(e,this.Utils.whitespace))t.length&&(o=!0),this.line_char_count--;else{if(o){if(this.line_char_count>=this.max_char){t.push("\n");for(var i=0;i<this.indent_level;i++)t.push(this.indent_string);this.line_char_count=0}else t.push(" "),this.line_char_count++;o=!1}t.push(e)}}return t.length?t.join(""):""},this.get_contents_to=function(e){if(this.pos==this.input.length)return["","TK_EOF"];var t="",o=new RegExp("</"+e+"\\s*>","igm");o.lastIndex=this.pos;var i=o.exec(this.input),n=i?i.index:this.input.length;return this.pos<n&&(t=this.input.substring(this.pos,n),this.pos=n),t},this.record_tag=function(e){this.tags[e+"count"]?(this.tags[e+"count"]++,this.tags[e+this.tags[e+"count"]]=this.indent_level):(this.tags[e+"count"]=1,this.tags[e+this.tags[e+"count"]]=this.indent_level),this.tags[e+this.tags[e+"count"]+"parent"]=this.tags.parent,this.tags.parent=e+this.tags[e+"count"]},this.retrieve_tag=function(e){if(this.tags[e+"count"]){for(var t=this.tags.parent;t&&e+this.tags[e+"count"]!==t;)t=this.tags[t+"parent"];t&&(this.indent_level=this.tags[e+this.tags[e+"count"]],this.tags.parent=this.tags[t+"parent"]),delete this.tags[e+this.tags[e+"count"]+"parent"],delete this.tags[e+this.tags[e+"count"]],1==this.tags[e+"count"]?delete this.tags[e+"count"]:this.tags[e+"count"]--}},this.get_tag=function(){var e,t,o="",i=[],n=!1;do{if(this.pos>=this.input.length)return i.length?i.join(""):["","TK_EOF"];o=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(o,this.Utils.whitespace)?(n=!0,this.line_char_count--):("'"!==o&&'"'!==o||i[1]&&"!"===i[1]||(o+=this.get_unformatted(o),n=!0),"="===o&&(n=!1),i.length&&"="!==i[i.length-1]&&">"!==o&&n&&(this.line_char_count>=this.max_char?(this.print_newline(!1,i),this.line_char_count=0):(i.push(" "),this.line_char_count++),n=!1),"<"===o&&(e=this.pos-1),i.push(o))}while(">"!==o);var r,l=i.join("");r=-1!=l.indexOf(" ")?l.indexOf(" "):l.indexOf(">");var d=l.substring(1,r).toLowerCase();if("/"===l.charAt(l.length-2)||this.Utils.in_array(d,this.Utils.single_token))this.tag_type="SINGLE";else if("script"===d)this.record_tag(d),this.tag_type="SCRIPT";else if("style"===d)this.record_tag(d),this.tag_type="STYLE";else if(this.Utils.in_array(d,a))s=this.get_unformatted("</"+d+">",l),i.push(s),e>0&&this.Utils.in_array(this.input.charAt(e-1),this.Utils.whitespace)&&i.splice(0,0,this.input.charAt(e-1)),t=this.pos-1,this.Utils.in_array(this.input.charAt(t+1),this.Utils.whitespace)&&i.push(this.input.charAt(t+1)),this.tag_type="SINGLE";else if("!"===d.charAt(0))if(-1!=d.indexOf("[if"))-1!=l.indexOf("!IE")&&(s=this.get_unformatted("--\x3e",l),i.push(s)),this.tag_type="START";else if(-1!=d.indexOf("[endif"))this.tag_type="END",this.unindent();else if(-1!=d.indexOf("[cdata["))s=this.get_unformatted("]]>",l),i.push(s),this.tag_type="SINGLE";else{var s=this.get_unformatted("--\x3e",l);i.push(s),this.tag_type="SINGLE"}else"/"===d.charAt(0)?(this.retrieve_tag(d.substring(1)),this.tag_type="END"):(this.record_tag(d),this.tag_type="START"),this.Utils.in_array(d,this.Utils.extra_liners)&&this.print_newline(!0,this.output);return i.join("")},this.get_unformatted=function(e,t){if(t&&-1!=t.indexOf(e))return"";var o="",i="",n=!0;do{if(this.pos>=this.input.length)return i;if(o=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(o,this.Utils.whitespace)){if(!n){this.line_char_count--;continue}if("\n"===o||"\r"===o){i+="\n",this.line_char_count=0;continue}}i+=o,this.line_char_count++,n=!0}while(-1==i.indexOf(e));return i},this.get_token=function(){var e;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var t=this.last_token.substr(7);return"string"!=typeof(e=this.get_contents_to(t))?e:[e,"TK_"+t]}return"CONTENT"===this.current_mode?"string"!=typeof(e=this.get_content())?e:[e,"TK_CONTENT"]:"TAG"===this.current_mode?"string"!=typeof(e=this.get_tag())?e:[e,"TK_TAG_"+this.tag_type]:void 0},this.get_full_indent=function(e){return(e=this.indent_level+e||0)<1?"":Array(e+1).join(this.indent_string)},this.printer=function(e,t,o,i,n){this.input=e||"",this.output=[],this.indent_character=t,this.indent_string="",this.indent_size=o,this.brace_style=n,this.indent_level=0,this.max_char=i,this.line_char_count=0;for(var r=0;r<this.indent_size;r++)this.indent_string+=this.indent_character;this.print_newline=function(e,t){if(this.line_char_count=0,t&&t.length){if(!e)for(;this.Utils.in_array(t[t.length-1],this.Utils.whitespace);)t.pop();t.push("\n");for(var o=0;o<this.indent_level;o++)t.push(this.indent_string)}},this.print_token=function(e){this.output.push(e)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}).printer(e,n,i,1/0,r);;){var l=o.get_token();if(o.token_text=l[0],o.token_type=l[1],"TK_EOF"===o.token_type)break;switch(o.token_type){case"TK_TAG_START":o.print_newline(!1,o.output),o.print_token(o.token_text),o.indent(),o.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===o.last_token&&""===o.last_text){var d=o.token_text.match(/\w+/)[0],s=o.output[o.output.length-1].match(/<\s*(\w+)/);null!==s&&s[1]===d||o.print_newline(!0,o.output)}o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var c=o.token_text.match(/^\s*<([a-z]+)/i);c&&o.Utils.in_array(c[1],a)||o.print_newline(!1,o.output),o.print_token(o.token_text),o.current_mode="CONTENT";break;case"TK_CONTENT":""!==o.token_text&&o.print_token(o.token_text),o.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==o.token_text){o.output.push("\n");var u=o.token_text;if("keep"==t.indent_scripts)g=0;else if("separate"==t.indent_scripts)g=-o.indent_level;else var g=1;var p=o.get_full_indent(g),h=u.match(/^\s*/)[0].match(/[^\n\r]*$/)[0].split(o.indent_string).length-1,m=o.get_full_indent(g-h);(u=u.replace(/^\s*/,p).replace(/\r\n|\r|\n/g,"\n"+m).replace(/\s*$/,""))&&(o.print_token(u),o.print_newline(!0,o.output))}o.current_mode="TAG"}o.last_token=o.token_type,o.last_text=o.token_text}return o.output.join("")}}}(jqxBaseFramework);


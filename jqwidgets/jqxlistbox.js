/*
jQWidgets v5.0.0 (2017-Aug)
Copyright (c) 2011-2017 jQWidgets.
License: http://jqwidgets.com/license/
*/
!function(e){e.jqx.jqxWidget("jqxListBox","",{}),e.extend(e.jqx._jqxListBox.prototype,{defineInstance:function(){var t={disabled:!1,width:null,height:null,items:new Array,multiple:!1,selectedIndex:-1,selectedIndexes:new Array,source:null,scrollBarSize:e.jqx.utilities.scrollBarSize,enableHover:!0,enableSelection:!0,visualItems:new Array,groups:new Array,equalItemsWidth:!0,itemHeight:-1,visibleItems:new Array,emptyGroupText:"Group",checkboxes:!1,hasThreeStates:!1,autoHeight:!1,autoItemsHeight:!1,roundedcorners:!0,touchMode:"auto",displayMember:"",groupMember:"",valueMember:"",searchMember:"",searchMode:"startswithignorecase",incrementalSearch:!0,incrementalSearchDelay:1e3,incrementalSearchKeyDownDelay:300,allowDrag:!1,allowDrop:!0,dropAction:"default",touchModeStyle:"auto",keyboardNavigation:!0,enableMouseWheel:!0,multipleextended:!1,selectedValues:new Array,emptyString:"",rtl:!1,rendered:null,renderer:null,dragStart:null,dragEnd:null,focusable:!0,ready:null,_checkForHiddenParent:!0,autoBind:!0,_renderOnDemand:!1,filterable:!1,filterHeight:27,filterPlaceHolder:"Looking for",filterDelay:100,filterChange:null,aria:{"aria-disabled":{name:"disabled",type:"boolean"}},events:["select","unselect","change","checkChange","dragStart","dragEnd","bindingComplete","itemAdd","itemRemove","itemUpdate"]};return this===e.jqx._jqxListBox.prototype?t:(e.extend(!0,this,t),t)},createInstance:function(t){var i=this;15!=e.jqx.utilities.scrollBarSize&&(i.scrollBarSize=e.jqx.utilities.scrollBarSize),null==i.width&&(i.width=200),null==i.height&&(i.height=200),i.renderListBox();var s=i;e.jqx.utilities.resize(i.host,function(){s._updateSize()},!1,i._checkForHiddenParent)},resize:function(e,t){this.width=e,this.height=t,this._updateSize()},render:function(){this.renderListBox(),this.refresh()},renderListBox:function(){var t=this,i=t.element.nodeName.toLowerCase();if("select"==i||"ul"==i||"ol"==i){t.field=t.element,t.field.className&&(t._className=t.field.className);var s={title:t.field.title};t.field.id.length?s.id=t.field.id.replace(/[^\w]/g,"_")+"_jqxListBox":s.id=e.jqx.utilities.createId()+"_jqxListBox";var l=e("<div></div>",s);t.width||(t.width=e(t.field).width()),t.height||(t.height=e(t.field).outerHeight()),t.element.style.cssText=t.field.style.cssText,e(t.field).hide().after(l);var r=t.host.data();if(t.host=l,t.host.data(r),t.element=l[0],t.element.id=t.field.id,t.field.id=s.id,t._className&&(t.host.addClass(t._className),e(t.field).removeClass(t._className)),t.field.tabIndex){var n=t.field.tabIndex;t.field.tabIndex=-1,t.element.tabIndex=n}}else if(t.host.find("li").length>0||t.host.find("option").length>0){var a=e.jqx.parseSourceTag(t.element);t.source=a.items}t.element.innerHTML="";var h=(t=t).element.className;h+=" "+t.toThemeProperty("jqx-listbox"),h+=" "+t.toThemeProperty("jqx-reset"),h+=" "+t.toThemeProperty("jqx-rc-all"),h+=" "+t.toThemeProperty("jqx-widget"),h+=" "+t.toThemeProperty("jqx-widget-content"),t.element.className=h;null!=t.width&&-1!=t.width.toString().indexOf("%")&&t.host.width(t.width),null!=t.height&&-1!=t.height.toString().indexOf("%")&&(t.host.height(t.height),0==t.host.height()&&t.host.height(200)),null!=t.width&&-1!=t.width.toString().indexOf("px")?t.host.width(t.width):void 0==t.width||isNaN(t.width)||(t.element.style.width=parseInt(t.width)+"px"),null!=t.height&&-1!=t.height.toString().indexOf("px")?t.host.height(t.height):void 0==t.height||isNaN(t.height)||(t.element.style.height=parseInt(t.height)+"px"),t.multiple||t.multipleextended||t.checkboxes?e.jqx.aria(t,"aria-multiselectable",!0):e.jqx.aria(t,"aria-multiselectable",!1);var o="<div style='-webkit-appearance: none; background: transparent; outline: none; width:100%; height: 100%; align:left; border: 0px; padding: 0px; margin: 0px; left: 0px; top: 0px; valign:top; position: relative;'><div style='-webkit-appearance: none; border: none; background: transparent; outline: none; width:100%; height: 100%; padding: 0px; margin: 0px; align:left; left: 0px; top: 0px; valign:top; position: relative;'><div id='filter"+t.element.id+"' style='display: none; visibility: inherit; align:left; valign:top; left: 0px; top: 0px; position: absolute;'><input style='position: absolute;'/></div><div id='listBoxContent' style='-webkit-appearance: none; border: none; background: transparent; outline: none; border: none; padding: 0px; overflow: hidden; margin: 0px; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div><div id='verticalScrollBar"+t.element.id+"' style='visibility: inherit; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div><div id='horizontalScrollBar"+t.element.id+"' style='visibility: inherit; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div><div id='bottomRight' style='align:left; valign:top; left: 0px; top: 0px; border: none; position: absolute;'/></div></div>";t.host.attr("role","listbox"),t.element.innerHTML=o,t._checkForHiddenParent&&(t._addInput(),t.host.attr("tabIndex")||t.host.attr("tabIndex",1)),t.filter=e(t.element.firstChild.firstChild.firstChild),t.filterInput=e(t.filter[0].firstChild),t.filterInput.attr("placeholder",t.filterPlaceHolder),t.filterInput.addClass(t.toThemeProperty("jqx-widget jqx-listbox-filter-input jqx-input jqx-rc-all")),t.addHandler(t.filterInput,"keyup.textchange",function(e){13==e.keyCode?t._search(e):t.filterDelay>0&&(t._filterTimer&&clearTimeout(t._filterTimer),t._filterTimer=setTimeout(function(){t._search(e)},t.filterDelay)),e.stopPropagation()});var d=e(t.element.firstChild.firstChild.firstChild.nextSibling.nextSibling);if(!t.host.jqxButton)throw new Error("jqxListBox: Missing reference to jqxbuttons.js.");if(!d.jqxScrollBar)throw new Error("jqxListBox: Missing reference to jqxscrollbar.js.");var c=parseInt(t.host.height())/2;0==c&&(c=10),t.vScrollBar=d.jqxScrollBar({_initialLayout:!0,vertical:!0,rtl:t.rtl,theme:t.theme,touchMode:t.touchMode,largestep:c});var u=e(t.element.firstChild.firstChild.firstChild.nextSibling.nextSibling.nextSibling);if(t.hScrollBar=u.jqxScrollBar({_initialLayout:!0,vertical:!1,rtl:t.rtl,touchMode:t.touchMode,theme:t.theme}),t.content=e(t.element.firstChild.firstChild.firstChild.nextSibling),t.content[0].id="listBoxContent"+t.element.id,t.bottomRight=e(t.element.firstChild.firstChild.firstChild.nextSibling.nextSibling.nextSibling.nextSibling).addClass(t.toThemeProperty("jqx-listbox-bottomright")).addClass(t.toThemeProperty("jqx-scrollbar-state-normal")),t.bottomRight[0].id="bottomRight"+t.element.id,t.vScrollInstance=e.data(t.vScrollBar[0],"jqxScrollBar").instance,t.hScrollInstance=e.data(t.hScrollBar[0],"jqxScrollBar").instance,t.isTouchDevice()&&!(e.jqx.browser.msie&&e.jqx.browser.version<9)){var m=e("<div class='overlay' unselectable='on' style='z-index: 99; -webkit-appearance: none; border: none; background: black; opacity: 0.01; outline: none; border: none; padding: 0px; overflow: hidden; margin: 0px; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div>");t.content.parent().append(m),t.overlayContent=t.host.find(".overlay"),t.filterable&&t.overlayContent.css("top","30px")}t._updateTouchScrolling(),t.host.addClass("jqx-disableselect"),t.host.jqxDragDrop&&jqxListBoxDragDrop()},_highlight:function(e,t){var i=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+i+")","ig"),function(e,t){return"<b>"+t+"</b>"})},_addInput:function(){var t=this.host.attr("name");t&&this.host.attr("name",""),this.input=e("<input type='hidden'/>"),this.host.append(this.input),this.input.attr("name",t)},_updateTouchScrolling:function(){var t=this;if(this.isTouchDevice()){t.enableHover=!1;var i=this.overlayContent?this.overlayContent:this.content;this.removeHandler(e(i),e.jqx.mobile.getTouchEventName("touchstart")+".touchScroll"),this.removeHandler(e(i),e.jqx.mobile.getTouchEventName("touchmove")+".touchScroll"),this.removeHandler(e(i),e.jqx.mobile.getTouchEventName("touchend")+".touchScroll"),this.removeHandler(e(i),"touchcancel.touchScroll"),e.jqx.mobile.touchScroll(i,t.vScrollInstance.max,function(e,i){if(null!=i&&"hidden"!=t.vScrollBar.css("visibility")){t.vScrollInstance.value;t.vScrollInstance.setPosition(i),t._lastScroll=new Date}if(null!=e&&"hidden"!=t.hScrollBar.css("visibility")){t.hScrollInstance.value;t.hScrollInstance.setPosition(e),t._lastScroll=new Date}},this.element.id,this.hScrollBar,this.vScrollBar),"visible"!=t.vScrollBar.css("visibility")&&"visible"!=t.hScrollBar.css("visibility")?e.jqx.mobile.setTouchScroll(!1,this.element.id):e.jqx.mobile.setTouchScroll(!0,this.element.id),this._arrange()}},isTouchDevice:function(){var t=e.jqx.mobile.isTouchDevice();if(1==this.touchMode){if(this.touchDevice)return!0;if(e.jqx.browser.msie&&e.jqx.browser.version<9)return!1;this.touchDevice=!0,t=!0,e.jqx.mobile.setMobileSimulator(this.element)}else 0==this.touchMode&&(t=!1);return t&&0!=this.touchModeStyle&&(this.scrollBarSize=e.jqx.utilities.touchScrollBarSize),t&&this.host.addClass(this.toThemeProperty("jqx-touch")),t},beginUpdate:function(){this.updatingListBox=!0},endUpdate:function(){this.updatingListBox=!1,this._addItems(),this._renderItems()},beginUpdateLayout:function(){this.updating=!0},resumeUpdateLayout:function(){this.updating=!1,this.vScrollInstance.value=0,this._render(!1)},propertiesChangedHandler:function(e,t,i){i.width&&i.height&&2==Object.keys(i).length&&(e._cachedItemHtml=new Array,e.refresh())},propertyChangedHandler:function(t,i,s,l){if(void 0!=this.isInitialized&&0!=this.isInitialized&&s!=l&&!(t.batchUpdate&&t.batchUpdate.width&&t.batchUpdate.height&&2==Object.keys(t.batchUpdate).length)){if("_renderOnDemand"==i&&(t._render(!1,!0),-1!=t.selectedIndex)){var r=t.selectedIndex;t.selectedIndex=-1,t._stopEvents=!0,t.selectIndex(r,!1,!0),-1==t.selectedIndex&&(t.selectedIndex=r),t._stopEvents=!1}if("filterable"==i&&t.refresh(),"filterHeight"==i&&t._arrange(),"filterPlaceHolder"==i&&t.filterInput.attr("placeholder",l),"renderer"==i&&(t._cachedItemHtml=new Array,t.refresh()),"itemHeight"==i&&t.refresh(),"source"!=i&&"checkboxes"!=i||(null==l&&s&&s.unbindBindingUpdate&&(s.unbindBindingUpdate(t.element.id),s.unbindDownloadComplete(t.element.id)),t.clearSelection(),t.refresh()),"scrollBarSize"!=i&&"equalItemsWidth"!=i||l!=s&&t._updatescrollbars(),"disabled"==i&&(t._renderItems(),t.vScrollBar.jqxScrollBar({disabled:l}),t.hScrollBar.jqxScrollBar({disabled:l})),"touchMode"==i||"rtl"==i){if(t._removeHandlers(),t.vScrollBar.jqxScrollBar({touchMode:l}),t.hScrollBar.jqxScrollBar({touchMode:l}),"touchMode"==i&&!(e.jqx.browser.msie&&e.jqx.browser.version<9)){var n=e("<div class='overlay' unselectable='on' style='z-index: 99; -webkit-appearance: none; border: none; background: black; opacity: 0.01; outline: none; border: none; padding: 0px; overflow: hidden; margin: 0px; align:left; valign:top; left: 0px; top: 0px; position: absolute;'></div>");t.content.parent().append(n),t.overlayContent=t.host.find(".overlay")}t.filterable&&t.filterInput&&("rtl"==i&&l?t.filterInput.addClass(t.toThemeProperty("jqx-rtl")):"rtl"!=i||l||t.filterInput.removeClass(t.toThemeProperty("jqx-rtl")),t._arrange()),t._updateTouchScrolling(),t._addHandlers(),t._render(!1)}if(this.updating||"width"!=i&&"height"!=i||t._updateSize(),"theme"==i&&s!=l&&(t.hScrollBar.jqxScrollBar({theme:t.theme}),t.vScrollBar.jqxScrollBar({theme:t.theme}),t.host.removeClass(),t.host.addClass(t.toThemeProperty("jqx-listbox")),t.host.addClass(t.toThemeProperty("jqx-widget")),t.host.addClass(t.toThemeProperty("jqx-widget-content")),t.host.addClass(t.toThemeProperty("jqx-reset")),t.host.addClass(t.toThemeProperty("jqx-rc-all")),t.refresh()),"selectedIndex"==i&&(t.clearSelection(),t.selectIndex(l,!0)),"displayMember"==i||"valueMember"==i){if(s!=l){var a=t.selectedIndex;t.refresh(),t.selectedIndex=a,t.selectedIndexes[a]=a}t._renderItems()}"autoHeight"==i&&(s!=l?t._render(!1):(t._updatescrollbars(),t._renderItems())),t._checkForHiddenParent&&e.jqx.isHidden(t.host)&&e.jqx.utilities.resize(this.host,function(){t._updateSize()},!1,t._checkForHiddenParent)}},loadFromSelect:function(t){if(null!=t){var i=e("#"+t);if(i.length>0){var s=e.jqx.parseSourceTag(i[0]),l=s.items,r=s.index;this.source=l,this.fromSelect=!0,this.clearSelection(),this.selectedIndex=r,this.selectedIndexes[this.selectedIndex]=this.selectedIndex,this.refresh()}}},invalidate:function(){this._cachedItemHtml=[],this._renderItems(),this.virtualSize=null,this._updateSize()},refresh:function(t){var i=this;if(void 0!=this.vScrollBar){this._cachedItemHtml=[],this.visibleItems=new Array;var s=function(e){if(1==e&&-1!=i.selectedIndex){var t=i.selectedIndex;i.selectedIndex=-1,i._stopEvents=!0,i.selectIndex(t,!1,!0),-1==i.selectedIndex&&(i.selectedIndex=t),i._stopEvents=!1}};if(null!=this.itemswrapper&&(this.itemswrapper.remove(),this.itemswrapper=null),e.jqx.dataAdapter&&null!=this.source&&this.source._source)return this.databind(this.source,t),void s(t);(this.autoBind||!this.autoBind&&!t)&&(this.field&&this.loadSelectTag(),this.items=this.loadItems(this.source)),this._render(!1,1==t),s(t),this._raiseEvent("6")}},loadSelectTag:function(){var t=e.jqx.parseSourceTag(this.field);this.source=t.items,-1==this.selectedIndex&&(this.selectedIndex=t.index)},_render:function(e,t){return this._renderOnDemand?(this.visibleItems=new Array,this.renderedVisibleItems=new Array,void this._renderItems()):(this._addItems(),this._renderItems(),this.vScrollInstance.setPosition(0),this._cachedItemHtml=new Array,(void 0==e||e)&&void 0!=this.items&&null!=this.items&&this.selectedIndex>=0&&this.selectedIndex<this.items.length&&this.selectIndex(this.selectedIndex,!0,!0,!0),this.allowDrag&&this._enableDragDrop&&(this._enableDragDrop(),this.isTouchDevice())?(this._removeHandlers(),this.overlayContent&&(this.overlayContent.remove(),this.overlayContent=null),this._updateTouchScrolling(),void this._addHandlers()):(this._updateTouchScrolling(),this.rendered&&this.rendered(),void(this.ready&&this.ready())))},_hitTest:function(e,t){this.filterable&&(t-=this.filterHeight)<0&&(t=0);var i=parseInt(this.vScrollInstance.value),s=this._searchFirstVisibleIndex(t+i,this.renderedVisibleItems);if(void 0!=this.renderedVisibleItems[s]&&this.renderedVisibleItems[s].isGroup)return null;if(this.renderedVisibleItems.length>0){var l=this.renderedVisibleItems[this.renderedVisibleItems.length-1];if(l.height+l.top<t+i)return null}return s=this._searchFirstVisibleIndex(t+i),this.visibleItems[s]},_searchFirstVisibleIndex:function(e,t){void 0==e&&(e=parseInt(this.vScrollInstance.value));var i=0;void 0!=t&&null!=t||(t=this.visibleItems);for(var s=t.length;i<=s;){mid=parseInt((i+s)/2);var l=t[mid];if(void 0==l)break;if(l.initialTop>e&&l.initialTop+l.height>e)s=mid-1;else{if(!(l.initialTop<e&&l.initialTop+l.height<=e))return mid;i=mid+1}}return 0},_renderItems:function(){if(void 0!=this.items&&0!=this.items.length){if(1!=this.updatingListBox){var t=this.isTouchDevice(),i=this.vScrollInstance,s=this.hScrollInstance,l=parseInt(i.value),r=parseInt(s.value);this.rtl&&"hidden"!=this.hScrollBar[0].style.visibility&&(r=s.max-r);this.items.length,this.host.width();var n=parseInt(this.content[0].style.width),a=n+parseInt(s.max);parseInt(this.vScrollBar[0].style.width);"hidden"==this.vScrollBar[0].style.visibility&&0,"visible"!=this.hScrollBar[0].style.visibility&&(a=n);this._getVirtualItemsCount();var h=new Array,o=0,d=parseInt(this.element.style.height)+2;-1!=this.element.style.height.indexOf("%")&&(d=this.host.outerHeight()),isNaN(d)&&(d=0);var c=0,u=0,m=0;if(0==i.value||0==this.visibleItems.length)for(w=0;w<this.items.length;w++)(j=this.items[w]).visible&&(j.top=-l,j.initialTop=-l,!j.isGroup&&j.visible&&(this.visibleItems[u++]=j,j.visibleIndex=u-1),this.renderedVisibleItems[m++]=j,j.left=-r,(x=j.top+j.height)>=0&&j.top-j.height<=d&&(h[o++]={index:w,item:j}),l-=j.height,l--);var v=l>0?this._searchFirstVisibleIndex(this.vScrollInstance.value,this.renderedVisibleItems):0,p=0;o=0;for(var g=this.vScrollInstance.value,f=0;p<100+d&&void 0!=(j=this.renderedVisibleItems[v]);){if(j.visible){j.left=-r;var x=j.top+j.height-g;x>=0&&j.initialTop-g-j.height<=2*d&&(h[o++]={index:v,item:j})}if(v++,j.visible&&(p+=j.initialTop-g+j.height-p),++f>this.items.length-1)break}if(!this._renderOnDemand)for(var b=this.toThemeProperty("jqx-listitem-state-normal")+" "+this.toThemeProperty("jqx-item"),I=this.toThemeProperty("jqx-listitem-state-group"),y=this.toThemeProperty("jqx-listitem-state-disabled")+" "+this.toThemeProperty("jqx-fill-state-disabled"),S=0,_=this,w=0;w<this.visualItems.length;w++){var k=this.visualItems[w],q=function(){var e=k[0].firstChild;_.checkboxes&&(e=k[0].lastChild),null!=e&&(e.style.visibility="hidden",e.className=""),_.checkboxes&&k.find(".chkbox").css({visibility:"hidden"})};if(w<h.length){var j=h[w].item;if(j.initialTop-g>=d){q();continue}var B=e(k[0].firstChild);if(this.checkboxes&&(B=e(k[0].lastChild)),0==B.length)continue;if(null==B[0])continue;B[0].className="",B[0].style.display="block",B[0].style.visibility="inherit";var T="";if(T=!j.isGroup&&!this.selectedIndexes[j.index]>=0?b:I,(j.disabled||this.disabled)&&(T+=" "+y),this.roundedcorners&&(T+=" "+this.toThemeProperty("jqx-rc-all")),t&&(T+=" "+this.toThemeProperty("jqx-listitem-state-normal-touch")),B[0].className=T,this.renderer)if(j.key||(j.key=this.generatekey()),this._cachedItemHtml||(this._cachedItemHtml=new Array),this._cachedItemHtml[j.key])B[0].innerHTML!=this._cachedItemHtml[j.key]&&(B[0].innerHTML=this._cachedItemHtml[j.key]);else{var H=this.renderer(j.index,j.label,j.value);B[0].innerHTML=H,this._cachedItemHtml[j.key]=B[0].innerHTML}else{if(-1!==this.itemHeight){var C=2+2*parseInt(B.css("padding-top"));B[0].style.lineHeight=j.height-C+"px",B.css("vertical-align","middle")}null!=j.html&&j.html.toString().length>0?B[0].innerHTML=j.html:null!=j.label||null!=j.value?null!=j.label?(B[0].innerHTML!==j.label&&(B[0].innerHTML=j.label),""==e.trim(j.label)&&(B[0].innerHTML=this.emptyString,""==this.emptyString&&(B[0].style.height=j.height-8+"px")),this.incrementalSearch||j.disabled||void 0!=this.searchString&&""!=this.searchString&&(B[0].innerHTML=this._highlight(j.label.toString(),this.searchString))):null===j.label?(B[0].innerHTML=this.emptyString,""==this.emptyString&&(B[0].style.height=j.height-8+"px")):B[0].innerHTML!==j.value?B[0].innerHTML=j.value:""==j.label&&(B[0].innerHTML=" "):""!=j.label&&null!=j.label||(B[0].innerHTML="",B[0].style.height=j.height-8+"px")}if(k[0].style.left=j.left+"px",k[0].style.top=j.initialTop-g+"px",j.element=B[0],j.title&&(B[0].title=j.title),this.equalItemsWidth&&!j.isGroup){if(0==c){var P=parseInt(a);P-=parseInt(B.outerWidth())-parseInt(B.width());var M=1;c=P-=2*(M=null!=M?parseInt(M):0),this.checkboxes&&"hidden"==this.hScrollBar[0].style.visibility&&(c-=18)}n>this.virtualSize.width?(B[0].style.width=c+"px",j.width=c):(B[0].style.width=-4+this.virtualSize.width+"px",j.width=this.virtualSize.width-4)}else B.width()<this.host.width()&&B.width(this.host.width()-2);if(this.rtl&&(B[0].style.textAlign="right"),this.autoItemsHeight&&(B[0].style.whiteSpace="pre-line",B.width(c),j.width=c),S=0,this.checkboxes&&!j.isGroup){0==S&&(S=(j.height-16)/2,S++),(A=e(k.children()[0]))[0].item=j,this.rtl?"0px"!=B[0].style.left&&(B[0].style.left="0px"):"18px"!=B[0].style.left&&(B[0].style.left="18px"),this.rtl&&A.css("left",8+j.width+"px"),A[0].style.top=S+"px",A[0].style.display="block",A[0].style.visibility="inherit";var V=j.checked,D=j.checked?" "+this.toThemeProperty("jqx-checkbox-check-checked"):"";A[0].firstChild&&A[0].firstChild.firstChild&&A[0].firstChild.firstChild.firstChild&&A[0].firstChild.firstChild&&(V?A[0].firstChild.firstChild.firstChild.className=D:!1===V?A[0].firstChild.firstChild.firstChild.className="":null===V&&(A[0].firstChild.firstChild.firstChild.className=this.toThemeProperty("jqx-checkbox-check-indeterminate"))),e.jqx.ariaEnabled&&(V?k[0].setAttribute("aria-selected",!0):k[0].removeAttribute("aria-selected"))}else if(this.checkboxes){var A=e(k.children()[0]);A.css({display:"none",visibility:"inherit"})}!j.disabled&&(!this.filterable&&this.selectedIndexes[j.visibleIndex]>=0||j.selected&&this.filterable)?(B.addClass(this.toThemeProperty("jqx-listitem-state-selected")),B.addClass(this.toThemeProperty("jqx-fill-state-pressed")),e.jqx.ariaEnabled&&(k[0].setAttribute("aria-selected",!0),this._activeElement=k[0])):this.checkboxes||e.jqx.ariaEnabled&&k[0].removeAttribute("aria-selected")}else q()}}}else this.visibleItems=new Array},generatekey:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},_calculateVirtualSize:function(t){if(!this._renderOnDemand){var i=0,s=2,l=0,r=document.createElement("span");this.equalItemsWidth&&e(r).css("float","left"),r.style.whiteSpace="pre";var n=0,a=void 0===t?this.host.outerHeight():t+2;document.body.appendChild(r);var h=this.items.length,o=this.host.width();if(this.autoItemsHeight&&(o-=10,"hidden"!=this.vScrollBar.css("visibility")&&(o-=20)),this.autoItemsHeight||this.renderer||this.groups.length>=1||h>0&&null!=this.items[0].html&&""!=this.items[0].html){for(l=0;l<h;l++)if((!(x=this.items[l]).isGroup||""!=x.label||""!=x.html)&&x.visible){b="";if(x.isGroup?b+=this.toThemeProperty("jqx-listitem-state-group jqx-rc-all"):b+=this.toThemeProperty("jqx-widget jqx-listitem-state-normal jqx-rc-all"),b+=" "+this.toThemeProperty("jqx-fill-state-normal"),this.isTouchDevice()&&(b+=" "+this.toThemeProperty("jqx-touch")),r.className=b,this.autoItemsHeight){r.style.whiteSpace="pre-line";I=this.checkboxes?-20:0;r.style.width=I+o+"px"}if(this.renderer){var d=this.renderer(x.index,x.label,x.value);r.innerHTML=d}else null!=x.html&&x.html.toString().length>0?r.innerHTML=x.html:null==x.label&&null==x.value||(null!=x.label?(r.innerHTML=x.label,""==x.label&&(r.innerHTML="Empty")):r.innerHTML=x.value);var c=r.offsetHeight,u=r.offsetWidth;this.itemHeight>-1&&(c=this.itemHeight),x.height=c,x.width=u,s+=++c,i=Math.max(i,u),s<=a&&n++}}else{for(var s=0,m=0,v="",p=0,g=0,f=-1,l=0;l<h;l++){var x=this.items[l];if((!x.isGroup||""!=x.label||""!=x.html)&&x.visible){var b="";if(0==++f){if(b+=this.toThemeProperty("jqx-listitem-state-normal jqx-rc-all"),b+=" "+this.toThemeProperty("jqx-fill-state-normal"),b+=" "+this.toThemeProperty("jqx-widget"),b+=" "+this.toThemeProperty("jqx-listbox"),b+=" "+this.toThemeProperty("jqx-widget-content"),this.isTouchDevice()&&(b+=" "+this.toThemeProperty("jqx-touch"),b+=" "+this.toThemeProperty("jqx-listitem-state-normal-touch")),r.className=b,this.autoItemsHeight){r.style.whiteSpace="pre-line";var I=this.checkboxes?-20:0;r.style.width=I+o+"px"}null==x.html||""==x.label||null==x.label?r.innerHTML="Item":null!=x.html&&x.html.toString().length>0?r.innerHTML=x.html:null==x.label&&null==x.value||(null!=x.label?null!=x.label.toString().match(new RegExp("\\w"))||null!=x.label.toString().match(new RegExp("\\d"))?r.innerHTML=x.label:r.innerHTML="Item":r.innerHTML=x.value);c=1+r.offsetHeight;this.itemHeight>-1&&(c=this.itemHeight),m=c}void 0!=p&&(g=p),null!=x.html&&x.html.toString().length>0?g!=(p=Math.max(p,x.html.toString().length))&&(v=x.html):null!=x.label?g!=(p=Math.max(p,x.label.length))&&(v=x.label):null!=x.value&&g!=(p=Math.max(p,x.value.length))&&(v=x.value),x.height=m,s+=m,++s<=a&&n++}}r.innerHTML=v,i=r.offsetWidth}return s+=2,n<10&&(n=10),this.filterable&&(s+=this.filterHeight),r.parentNode.removeChild(r),{width:i,height:s,itemsPerPage:n}}},_getVirtualItemsCount:function(){if(0==this.virtualItemsCount){var e=parseInt(this.host.height())/5;return e>this.items.length&&(e=this.items.length),e}return this.virtualItemsCount},_addItems:function(t){if(!this._renderOnDemand&&1!=(p=this).updatingListBox){if(void 0==p.items||0==p.items.length)return p.virtualSize={width:0,height:0,itemsPerPage:0},p._updatescrollbars(),p.renderedVisibleItems=new Array,void(p.itemswrapper&&p.itemswrapper.children().remove());var i=p.host.height();if(0==t){n=2*(r=p._calculateVirtualSize(i)).itemsPerPage;p.autoHeight&&(n=p.items.length),p.virtualItemsCount=Math.min(n,p.items.length);r.width;return p.virtualSize=r,void p._updatescrollbars()}var s=this,l=0;p.visibleItems=new Array,p.renderedVisibleItems=new Array,p._removeHandlers(),p.allowDrag&&p._enableDragDrop&&(p.itemswrapper=null),null==p.itemswrapper&&(p.content[0].innerHTML="",p.itemswrapper=e('<div style="outline: 0 none; overflow:hidden; width:100%; position: relative;"></div>'),p.itemswrapper[0].style.height=2*i+"px",p.content[0].appendChild(p.itemswrapper[0]));var r=p._calculateVirtualSize(i),n=2*r.itemsPerPage;p.autoHeight&&(n=p.items.length),p.virtualItemsCount=Math.min(n,p.items.length);p=this,r.width;p.virtualSize=r;var a=Math.max(p.host.width(),17+r.width);p.itemswrapper[0].style.width=a+"px";for(var h="",o=e.jqx.browser.msie&&e.jqx.browser.version<9?' unselectable="on"':"",d=0;d<p.virtualItemsCount;d++){m=p.items[d];if(h+="<div"+o+" role='option' id='"+("listitem"+d+p.element.id)+"' class='jqx-listitem-element'>",p.checkboxes){h+='<div style="background-color: transparent; padding: 0; margin: 0; position: absolute; float: left; width: 16px; height: 16px;" class="chkbox">';var c='<div class="'+p.toThemeProperty("jqx-checkbox-default")+" "+p.toThemeProperty("jqx-fill-state-normal")+" "+p.toThemeProperty("jqx-rc-all")+'"><div style="cursor: pointer; width: 13px; height: 13px;">';c+='<span style="width: 13px; height: 13px;" class="checkBoxCheck'+(m.checked?" "+p.toThemeProperty("jqx-checkbox-check-checked"):"")+'"></span>',h+=c+="</div></div>",h+="</div>"}h+="<span"+o+" style='white-space: pre; -ms-touch-action: none;'></span></div>"}s.WinJS?p.itemswrapper.html(h):p.itemswrapper[0].innerHTML=h;for(var u=p.itemswrapper.children(),d=0;d<p.virtualItemsCount;d++){var m=p.items[d],v=e(u[d]);if(p.allowDrag&&p._enableDragDrop&&v.addClass("draggable"),p.checkboxes){e(v.children()[0]);v.css("float","left"),e(v[0].firstChild).css("float","left")}v[0].style.height=m.height+"px",v[0].style.top=l+"px",l+=m.height+1,p.visualItems[d]=v}if(p._addHandlers(),p._updatescrollbars(),p.autoItemsHeight){n=2*(r=p._calculateVirtualSize(i)).itemsPerPage;p.autoHeight&&(n=p.items.length),p.virtualItemsCount=Math.min(n,p.items.length);var p=this;r.width;p.virtualSize=r,p._updatescrollbars()}e.jqx.browser.msie&&e.jqx.browser.version<8&&(p.host.attr("hideFocus",!0),p.host.find("div").attr("hideFocus",!0))}},_updatescrollbars:function(){var t=this;if(t.virtualSize){var i=t.virtualSize.height,s=t.virtualSize.width,l=t.vScrollInstance,r=t.hScrollInstance;t._arrange(!1);var n=!1,a=t.host.outerWidth(),h=t.host.outerHeight(),o=0;if(s>a&&(o=t.hScrollBar.outerHeight()+2),i+o>h){var d=l.max;l.max=2+parseInt(i)+o-parseInt(h-2),"inherit"!=t.vScrollBar[0].style.visibility&&(t.vScrollBar[0].style.visibility="inherit",n=!0),d!=l.max&&l._arrange()}else"hidden"!=t.vScrollBar[0].style.visibility&&(t.vScrollBar[0].style.visibility="hidden",n=!0,l.setPosition(0));var c=0;"hidden"!=t.vScrollBar[0].style.visibility&&(c=t.scrollBarSize+6);var u=t.checkboxes?20:0;if(t.autoItemsHeight)t.hScrollBar[0].style.visibility="hidden";else if(s>=a-c-u){var m=r.max;"inherit"==t.vScrollBar[0].style.visibility?r.max=u+c+parseInt(s)-t.host.width()+4:r.max=u+parseInt(s)-t.host.width()+6,"inherit"!=t.hScrollBar[0].style.visibility&&(t.hScrollBar[0].style.visibility="inherit",n=!0),m!=r.max&&r._arrange(),"inherit"==t.vScrollBar[0].style.visibility&&(l.max=2+parseInt(i)+t.hScrollBar.outerHeight()+2-parseInt(t.host.height()))}else"hidden"!=t.hScrollBar[0].style.visibility&&(t.hScrollBar[0].style.visibility="hidden",n=!0);r.setPosition(0),n&&t._arrange(),t.itemswrapper&&(t.itemswrapper[0].style.width=Math.max(0,Math.max(a-2,17+s))+"px",t.itemswrapper[0].style.height=Math.max(0,2*h)+"px"),t.isTouchDevice()&&("visible"!=t.vScrollBar.css("visibility")&&"visible"!=t.hScrollBar.css("visibility")?e.jqx.mobile.setTouchScroll(!1,t.element.id):e.jqx.mobile.setTouchScroll(!0,t.element.id))}},clear:function(){this.source=null,this.clearSelection(),this.refresh()},clearSelection:function(e){for(var t=0;t<this.selectedIndexes.length;t++)this.selectedIndexes[t]&&-1!=this.selectedIndexes[t]&&this._raiseEvent("1",{index:t,type:"api",item:this.getVisibleItem(t),originalEvent:null}),this.selectedIndexes[t]=-1;this.selectedIndex=-1,this.selectedValue=null,this.selectedValues=new Array,0!=e&&this._renderItems()},unselectIndex:function(e,t){if(!isNaN(e)){this.selectedIndexes[e]=-1;for(var i=!1,s=0;s<this.selectedIndexes.length;s++){var l=this.selectedIndexes[s];-1!=l&&void 0!=l&&(i=!0)}if(!i){this.selectedValue=null,this.selectedIndex=-1;var r=this.getVisibleItem(e);r&&this.selectedValues[r.value]&&(this.selectedValues[r.value]=null)}void 0!=t&&1!=t||(this._renderItems(),this._raiseEvent("1",{index:e,type:"api",item:this.getVisibleItem(e),originalEvent:null})),this._updateInputSelection(),this._raiseEvent("2",{index:e,type:"api",item:this.getItem(e)})}},getInfo:function(){var e=this,t=this.getItems(),i=this.getVisibleItems(),s=function(){var t=e.vScrollInstance.value;e.filterable&&(t-=e.filterHeight);for(var s=new Array,l=0;l<i.length;l++){var r=i[l];if(r){var n=r.initialTop,a=!0;(n+r.height-t<0||n-t>=e.host.height())&&(a=!1),a&&s.push(r)}}return s}();return{items:t,visibleItems:i,viewItems:s}},getItem:function(t){if(-1==t||isNaN(t)||"string"==typeof t)return-1===t?null:this.getItemByValue(t);var i=null;e.each(this.items,function(){if(this.index==t)return i=this,!1});return i},getVisibleItem:function(e){return-1==e||isNaN(e)||"string"==typeof e?-1===e?null:this.getItemByValue(e):this.visibleItems[e]},getVisibleItems:function(){return this.visibleItems},checkIndex:function(t,i,s){if(this.checkboxes&&!isNaN(t)&&!(t<0||t>=this.visibleItems.length||null!=this.visibleItems[t]&&this.visibleItems[t].disabled||this.disabled)){l=this.getItem(t);if(this.groups.length>0||this.filterable)var l=this.getVisibleItem(t);if(null!=l){e(l.checkBoxElement);l.checked=!0,void 0!=i&&1!=i||this._updateCheckedItems()}void 0!=s&&1!=s||this._raiseEvent(3,{label:l.label,value:l.value,checked:!0,item:l})}},getCheckedItems:function(){if(!this.checkboxes)return null;var t=new Array;if(void 0!=this.items)return e.each(this.items,function(){this.checked&&(t[t.length]=this)}),t},checkAll:function(t){if(this.checkboxes&&!this.disabled){var i=this;e.each(this.items,function(){var e=this;!1!==t&&!0!==e.checked&&i._raiseEvent(3,{label:e.label,value:e.value,checked:!0,item:e}),this.checked=!0}),this._updateCheckedItems()}},uncheckAll:function(t){if(this.checkboxes&&!this.disabled){var i=this;e.each(this.items,function(){var e=this;!1!==t&&!1!==e.checked&&(this.checked=!1,i._raiseEvent(3,{label:e.label,value:e.value,checked:!1,item:e})),this.checked=!1}),this._updateCheckedItems()}},uncheckIndex:function(t,i,s){if(this.checkboxes&&!isNaN(t)&&!(t<0||t>=this.visibleItems.length||null!=this.visibleItems[t]&&this.visibleItems[t].disabled||this.disabled)){l=this.getItem(t);if(this.groups.length>0||this.filterable)var l=this.getVisibleItem(t);if(null!=l){e(l.checkBoxElement);l.checked=!1,void 0!=i&&1!=i||this._updateCheckedItems()}void 0!=s&&1!=s||this._raiseEvent(3,{label:l.label,value:l.value,checked:!1,item:l})}},indeterminateIndex:function(t,i,s){if(this.checkboxes&&!isNaN(t)&&!(t<0||t>=this.visibleItems.length||null!=this.visibleItems[t]&&this.visibleItems[t].disabled||this.disabled)){l=this.getItem(t);if(this.groups.length>0||this.filterable)var l=this.getVisibleItem(t);if(null!=l){e(l.checkBoxElement);l.checked=null,void 0!=i&&1!=i||this._updateCheckedItems()}void 0!=s&&1!=s||this._raiseEvent(3,{checked:null})}},getSelectedIndex:function(){return this.selectedIndex},getSelectedItems:function(){var e=this.getVisibleItems(),t=this.selectedIndexes,i=[];for(var s in t)-1!=t[s]&&(i[i.length]=e[s]);return i},getSelectedItem:function(){var e=this.getSelectedItems();return e&&e.length>0?e[0]:null},_updateCheckedItems:function(){var t=this.selectedIndex;this.clearSelection(!1);this.getCheckedItems();this.selectedIndex=t,this._renderItems();var i=e.data(this.element,"hoveredItem");null!=i&&(e(i).addClass(this.toThemeProperty("jqx-listitem-state-hover")),e(i).addClass(this.toThemeProperty("jqx-fill-state-hover"))),this._updateInputSelection()},getItemByValue:function(t){if(null!=this.visibleItems){if(t&&t.value&&(t=t.value),this.itemsByValue)return this.itemsByValue[e.trim(t).split(" ").join("?")];for(var i=this.visibleItems,s=0;s<i.length;s++)if(i[s].value==t)return i[s]}},checkItem:function(e){if(null!=e){var t=this._getItemByParam(e);return this.checkIndex(t.visibleIndex,!0)}return!1},uncheckItem:function(e){if(null!=e){var t=this._getItemByParam(e);return this.uncheckIndex(t.visibleIndex,!0)}return!1},indeterminateItem:function(e){if(null!=e){var t=this._getItemByParam(e);return this.indeterminateIndex(t.visibleIndex,!0)}return!1},val:function(e){if(this.input){if(function(t){for(var i in t)if(t.hasOwnProperty(i))return!1;return"number"!=typeof e&&"date"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e}(e)||0==arguments.length)return this.input.val();var t=this.getItemByValue(e);return null!=t&&this.selectItem(t),this.input?this.input.val():void 0}},selectItem:function(e){if(null!=e){if(void 0==e.index){var t=this.getItemByValue(e);t&&(e=t)}return this.selectIndex(e.visibleIndex,!0)}return this.clearSelection(),!1},unselectItem:function(e){if(null!=e){if(void 0==e.index){var t=this.getItemByValue(e);t&&(e=t)}return this.unselectIndex(e.visibleIndex,!0)}return!1},selectIndex:function(e,t,i,s,l,r){if(!isNaN(e)){var n=this.selectedIndex;if(this.filterable&&(this.selectedIndex=-1),!(e<-1||e>=this.visibleItems.length||null!=this.visibleItems[e]&&this.visibleItems[e].disabled||this.disabled)){if(this.multiple||this.multipleextended||this.selectedIndex!=e||s||this.checkboxes){if(this.checkboxes){this._updateCheckedItems();d=n;this.selectedIndex!=e||this.multiple||(d=-1),void 0==l&&(l="none");var a=this.getItem(e),h=this.getItem(d);return this.visibleItems&&this.items&&this.visibleItems.length!=this.items.length&&(a=this.getVisibleItem(e),h=this.getVisibleItem(d)),this._raiseEvent("1",{index:d,type:l,item:h,originalEvent:r}),this.selectedIndex=e,this.selectedIndexes[d]=-1,this.selectedIndexes[e]=e,a&&(this.selectedValue=a.value,this.selectedValues[a.value]=a.value),this._raiseEvent("0",{index:e,type:l,item:a,originalEvent:r}),void this._renderItems()}this.focused=!0;var o=!1;this.selectedIndex!=e&&(o=!0);var d=n;this.selectedIndex!=e||this.multiple||(d=-1),void 0==l&&(l="none");var a=this.getItem(e),h=this.getItem(d);if(this.visibleItems&&this.items&&this.visibleItems.length!=this.items.length&&(a=this.getVisibleItem(e),h=this.getVisibleItem(d)),void 0!=s&&s)this._raiseEvent("1",{index:d,type:l,item:h,originalEvent:r}),this.selectedIndex=e,this.selectedIndexes[d]=-1,this.selectedIndexes[e]=e,a&&(this.selectedValue=a.value,this.selectedValues[a.value]=a.value),this._raiseEvent("0",{index:e,type:l,item:a,originalEvent:r});else{var c=this,u=function(e,t,i,s,l,r){c._raiseEvent("1",{index:t,type:i,item:s,originalEvent:r}),c.selectedIndex=e,c.selectedIndexes=[],t=e,c.selectedIndexes[e]=e,c.selectedValues=new Array,l&&(c.selectedValues[l.value]=l.value),c._raiseEvent("0",{index:e,type:i,item:l,originalEvent:r})},m=function(e,t,i,s,l,r){void 0==c.selectedIndexes[e]||-1==c.selectedIndexes[e]?(c.selectedIndexes[e]=e,c.selectedIndex=e,l&&(c.selectedValues[l.value]=l.value,c._raiseEvent("0",{index:e,type:i,item:l,originalEvent:r}))):(t=c.selectedIndexes[e],(s=c.getVisibleItem(t))&&(c.selectedValues[s.value]=null),c.selectedIndexes[e]=-1,c.selectedIndex=-1,c._raiseEvent("1",{index:t,type:i,item:s,originalEvent:r}))};if(this.multipleextended)if(this._shiftKey||this._ctrlKey){if(this._ctrlKey)"keyboard"==l&&(this.clearSelection(!1),c._clickedIndex=e),m(e,d,l,h,a,r);else if(this._shiftKey){void 0==c._clickedIndex&&(c._clickedIndex=d);var v=Math.min(c._clickedIndex,e),p=Math.max(c._clickedIndex,e);this.clearSelection(!1);for(var g=v;g<=p;g++)c.selectedIndexes[g]=g,c.selectedValues[c.getVisibleItem(g).value]=c.getVisibleItem(g).value,c._raiseEvent("0",{index:g,type:l,item:this.getVisibleItem(g),originalEvent:r});c.selectedIndex="keyboard"!=l?c._clickedIndex:e}}else"keyboard"!=l&&"mouse"!=l?(m(e,d,l,h,a,r),c._clickedIndex=e):(this.clearSelection(!1),c._clickedIndex=e,u(e,d,l,h,a,r));else this.multiple?m(e,d,l,h,a,r):(a&&(this.selectedValue=a.value),u(e,d,l,h,a,r))}return void 0!=i&&1!=i||this._renderItems(),void 0!=t&&null!=t&&1==t&&this.ensureVisible(e),this._raiseEvent("2",{index:e,item:a,oldItem:h,type:l,originalEvent:r}),this._updateInputSelection(),o}this.visibleItems&&this.items&&this.visibleItems.length!=this.items.length&&(a=this.getVisibleItem(e))&&(this.selectedValue=a.value,this.selectedValues[a.value]=a.value)}}},_updateInputSelection:function(){this._syncSelection();var t=new Array;if(this.input&&(-1==this.selectedIndex?this.input.val(""):this.items&&void 0!=this.items[this.selectedIndex]&&(this.input.val(this.items[this.selectedIndex].value),t.push(this.items[this.selectedIndex].value)),this.multiple||this.multipleextended||this.checkboxes)){var i=this.checkboxes?this.getCheckedItems():this.getSelectedItems(),s="";if(i){for(var l=0;l<i.length;l++)void 0!=i[l]&&(l==i.length-1?s+=i[l].value:s+=i[l].value+",",t.push(i[l].value));this.input.val(s)}}this.field&&this.input&&("select"==this.field.nodeName.toLowerCase()?e.each(this.field,function(i,s){e(this).removeAttr("selected"),this.selected=t.indexOf(this.value)>=0,this.selected&&e(this).attr("selected",!0)}):e.each(this.items,function(i,s){e(this.originalItem.originalItem).removeAttr("data-selected"),this.selected=t.indexOf(this.value)>=0,this.selected&&e(this.originalItem.originalItem).attr("data-selected",!0)}))},isIndexInView:function(e){if(isNaN(e))return!1;if(!this.items)return!1;if(e<0||e>=this.items.length)return!1;var t=this.vScrollInstance.value,i=0;this.filterable&&(i=this.filterHeight);var s=this.visibleItems[e];if(void 0==s)return!0;var l=s.initialTop,r=s.height;return!(l-t<i||l-t+i+r>=this.host.outerHeight())},_itemsInPage:function(){var t=0,i=this;return this.items&&e.each(this.items,function(){if(this.initialTop+this.height>=i.content.height())return!1;t++}),t},_firstItemIndex:function(){return null!=this.visibleItems?this.visibleItems[0]&&this.visibleItems[0].isGroup?this._nextItemIndex(0):0:-1},_lastItemIndex:function(){return null!=this.visibleItems?this.visibleItems[this.visibleItems.length-1]&&this.visibleItems[this.visibleItems.length-1].isGroup?this._prevItemIndex(this.visibleItems.length-1):this.visibleItems.length-1:-1},_nextItemIndex:function(e){for(indx=e+1;indx<this.visibleItems.length;indx++)if(this.visibleItems[indx]&&!this.visibleItems[indx].disabled&&!this.visibleItems[indx].isGroup)return indx;return-1},_prevItemIndex:function(e){for(indx=e-1;indx>=0;indx--)if(this.visibleItems[indx]&&!this.visibleItems[indx].disabled&&!this.visibleItems[indx].isGroup)return indx;return-1},clearFilter:function(){this.filterInput.val(""),this._updateItemsVisibility("")},_search:function(e){var t=this,i=t.filterInput.val();if(9!=e.keyCode&&"none"!=t.searchMode&&null!=t.searchMode&&"undefined"!=t.searchMode&&16!=e.keyCode&&17!=e.keyCode&&20!=e.keyCode)return 37!=e.keyCode&&39!=e.keyCode&&void(e.altKey||18==e.keyCode||e.keyCode>=33&&e.keyCode<=40||(e.ctrlKey||e.metaKey||t.ctrlKey)&&88!=e.keyCode&&86!=e.keyCode||i!==t.searchString&&t._updateItemsVisibility(i))},_updateItemsVisibility:function(t){var i=this.getItems();if(void 0==i)return{index:-1,matchItem:new Array};var s=this,l=-1,r=new Array,n=0;e.each(i,function(i){var a="";if(!this.isGroup){a=(a=this.searchLabel?this.searchLabel:this.label?this.label:this.value?this.value:this.title?this.title:"jqxItem").toString();var h=!1;switch(s.searchMode){case"containsignorecase":h=e.jqx.string.containsIgnoreCase(a,t);break;case"contains":h=e.jqx.string.contains(a,t);break;case"equals":h=e.jqx.string.equals(a,t);break;case"equalsignorecase":h=e.jqx.string.equalsIgnoreCase(a,t);break;case"startswith":h=e.jqx.string.startsWith(a,t);break;case"startswithignorecase":h=e.jqx.string.startsWithIgnoreCase(a,t);break;case"endswith":h=e.jqx.string.endsWith(a,t);break;case"endswithignorecase":h=e.jqx.string.endsWithIgnoreCase(a,t)}h||(this.visible=!1),h&&(r[n++]=this,this.visible=!0,l=this.visibleIndex),""==t&&(this.visible=!0,h=!1)}}),s.renderedVisibleItems=new Array,s.visibleItems=new Array,s.vScrollInstance.setPosition(0,!0),s._addItems(!1),s._renderItems();for(var a=0;a<s.items.length;a++)s.selectedIndexes[a]=-1;s.selectedIndex=-1;for(var h in s.selectedValues){var t=s.selectedValues[h],o=s.getItemByValue(t);o&&o.visible&&(s.selectedIndex=o.visibleIndex,s.selectedIndexes[o.visibleIndex]=o.visibleIndex)}s._syncSelection(),s.filterChange&&s.filterChange(t)},_getMatches:function(t,i){if(void 0==t||0==t.length)return-1;void 0==i&&(i=0);var s=this.getItems(),l=this,r=-1;return e.each(s,function(s){var n="";if(!this.isGroup){n=this.searchLabel?this.searchLabel.toString():this.label?this.label.toString():this.value?this.value.toString():this.title?this.title.toString():"jqxItem";var a=!1;switch(l.searchMode){case"containsignorecase":a=e.jqx.string.containsIgnoreCase(n,t);break;case"contains":a=e.jqx.string.contains(n,t);break;case"equals":a=e.jqx.string.equals(n,t);break;case"equalsignorecase":a=e.jqx.string.equalsIgnoreCase(n,t);break;case"startswith":a=e.jqx.string.startsWith(n,t);break;case"startswithignorecase":a=e.jqx.string.startsWithIgnoreCase(n,t);break;case"endswith":a=e.jqx.string.endsWith(n,t);break;case"endswithignorecase":a=e.jqx.string.endsWithIgnoreCase(n,t)}if(a&&this.visibleIndex>=i)return r=this.visibleIndex,!1}}),r},findItems:function(t){var i=this.getItems(),s=this,l=0,r=new Array;return e.each(i,function(i){var n="";if(!this.isGroup){n=this.label?this.label:this.value?this.value:this.title?this.title:"jqxItem";var a=!1;switch(s.searchMode){case"containsignorecase":a=e.jqx.string.containsIgnoreCase(n,t);break;case"contains":a=e.jqx.string.contains(n,t);break;case"equals":a=e.jqx.string.equals(n,t);break;case"equalsignorecase":a=e.jqx.string.equalsIgnoreCase(n,t);break;case"startswith":a=e.jqx.string.startsWith(n,t);break;case"startswithignorecase":a=e.jqx.string.startsWithIgnoreCase(n,t);break;case"endswith":a=e.jqx.string.endsWith(n,t);break;case"endswithignorecase":a=e.jqx.string.endsWithIgnoreCase(n,t)}a&&(r[l++]=this)}}),r},_syncSelection:function(){var e=this;if(e.filterable){if(e.items)for(t=0;t<e.items.length;t++)(i=e.items[t]).selected=!1;for(var t=0;t<e.visibleItems.length;t++){var i=e.visibleItems[t];e.selectedIndexes&&e.selectedIndexes[t]==i.visibleIndex&&(i.selected=!0)}e.itemswrapper&&e._renderItems()}},_handleKeyDown:function(e){var t=e.keyCode,i=this,s=i.selectedIndex,l=i.selectedIndex;if(this.keyboardNavigation&&this.enableSelection&&(!this.filterInput||e.target!=this.filterInput[0])){var r=function(){(i.multiple||i.checkboxes)&&i.clearSelection(!1)};if(e.altKey&&(t=-1),32==t&&this.checkboxes)return null!=(m=this.getItem(s))&&(i._updateItemCheck(m,s),e.preventDefault()),i._searchString="",i.selectIndex(m.visibleIndex,!1,!0,!0,"keyboard",e),void i._renderItems();if(i.incrementalSearch){var n=-1;i._searchString||(i._searchString=""),(8==t||46==t)&&i._searchString.length>=1&&(i._searchString=i._searchString.substr(0,i._searchString.length-1));var a=String.fromCharCode(t),h=!isNaN(parseInt(a)),o=!1;if(t>=65&&t<=97||h||8==t||32==t||46==t){e.shiftKey||(a=a.toLocaleLowerCase());var d=1+i.selectedIndex;8!=t&&32!=t&&46!=t&&(i._searchString.length>0&&i._searchString.substr(0,1)==a?(d=1+i.selectedIndex,i._searchString+=a):i._searchString+=a),32==t&&(i._searchString+=" ");c=this._getMatches(i._searchString,d);if((n=c)==i._lastMatchIndex||-1==n){var c=this._getMatches(i._searchString,0);n=c}if(i._lastMatchIndex=n,n>=0){var u=function(){r(),i.selectIndex(n,!1,!1,!1,"keyboard",e),i.isIndexInView(n)?i._renderItems():i.ensureVisible(n)};i._toSelectTimer&&clearTimeout(i._toSelectTimer),i._toSelectTimer=setTimeout(function(){u()},i.incrementalSearchKeyDownDelay)}o=!0}if(void 0!=i._searchTimer&&clearTimeout(i._searchTimer),27!=t&&13!=t||(i._searchString=""),i._searchTimer=setTimeout(function(){i._searchString="",i._renderItems()},i.incrementalSearchDelay),n>=0)return;if(o)return!1}if(33==t){v=i._itemsInPage();i.selectedIndex-v>=0?(r(),i.selectIndex(l-v,!1,!1,!1,"keyboard",e)):(r(),i.selectIndex(i._firstItemIndex(),!1,!1,!1,"keyboard",e)),i._searchString=""}if(32==t&&this.checkboxes){var m=this.getItem(s);null!=m&&(i._updateItemCheck(m,s),e.preventDefault()),i._searchString=""}if(36==t&&(r(),i.selectIndex(i._firstItemIndex(),!1,!1,!1,"keyboard",e),i._searchString=""),35==t&&(r(),i.selectIndex(i._lastItemIndex(),!1,!1,!1,"keyboard",e),i._searchString=""),34==t){var v=i._itemsInPage();i.selectedIndex+v<i.visibleItems.length?(r(),i.selectIndex(l+v,!1,!1,!1,"keyboard",e)):(r(),i.selectIndex(i._lastItemIndex(),!1,!1,!1,"keyboard",e)),i._searchString=""}if(38==t){if(i._searchString="",!(i.selectedIndex>0))return!1;if((p=i._prevItemIndex(i.selectedIndex))==i.selectedIndex||-1==p)return!0;r(),i.selectIndex(p,!1,!1,!1,"keyboard",e)}else if(40==t){if(i._searchString="",!(i.selectedIndex+1<i.visibleItems.length))return!1;var p=i._nextItemIndex(i.selectedIndex);if(p==i.selectedIndex||-1==p)return!0;r(),i.selectIndex(p,!1,!1,!1,"keyboard",e)}return 35!=t&&36!=t&&38!=t&&40!=t&&34!=t&&33!=t||(i.isIndexInView(i.selectedIndex)?i._renderItems():i.ensureVisible(i.selectedIndex),!1)}},_updateItemCheck:function(e,t){if(!this.disabled)switch(1==e.checked?e.checked=!(!e.hasThreeStates||!this.hasThreeStates)&&null:e.checked=null!=e.checked,e.checked){case!0:this.checkIndex(t);break;case!1:this.uncheckIndex(t);break;default:this.indeterminateIndex(t)}},wheel:function(e,t){if(t.autoHeight||!t.enableMouseWheel)return e.returnValue=!0,!0;if(t.disabled)return!0;var i=0;if(e||(e=window.event),e.originalEvent&&e.originalEvent.wheelDelta&&(e.wheelDelta=e.originalEvent.wheelDelta),e.wheelDelta?i=e.wheelDelta/120:e.detail&&(i=-e.detail/3),i){var s=t._handleDelta(i);return s&&(e.preventDefault&&e.preventDefault(),null!=e.originalEvent&&(e.originalEvent.mouseHandled=!0),void 0!=e.stopPropagation&&e.stopPropagation()),!!s&&(s=!1,e.returnValue=s,s)}e.preventDefault&&e.preventDefault(),e.returnValue=!1},_handleDelta:function(e){var t=this.vScrollInstance.value;return e<0?this.scrollDown():this.scrollUp(),t!=this.vScrollInstance.value},focus:function(){try{this.focused=!0,this.host.focus();var e=this;setTimeout(function(){e.host.focus()},25)}catch(e){}},_removeHandlers:function(){this.removeHandler(e(document),"keydown.listbox"+this.element.id),this.removeHandler(e(document),"keyup.listbox"+this.element.id),this.removeHandler(this.vScrollBar,"valueChanged"),this.removeHandler(this.hScrollBar,"valueChanged"),this._mousewheelfunc?this.removeHandler(this.host,"mousewheel",this._mousewheelfunc):this.removeHandler(this.host,"mousewheel"),this.removeHandler(this.host,"keydown"),this.removeHandler(this.content,"mouseleave"),this.removeHandler(this.content,"focus"),this.removeHandler(this.content,"blur"),this.removeHandler(this.host,"focus"),this.removeHandler(this.host,"blur"),this.removeHandler(this.content,"mouseenter"),this.removeHandler(this.content,"mouseup"),this.removeHandler(this.content,"mousedown"),this.removeHandler(this.content,"touchend"),this._mousemovefunc?this.removeHandler(this.content,"mousemove",this._mousemovefunc):this.removeHandler(this.content,"mousemove"),this.removeHandler(this.content,"selectstart"),this.overlayContent&&this.removeHandler(this.overlayContent,e.jqx.mobile.getTouchEventName("touchend"))},_updateSize:function(){this.virtualSize||(this._oldheight=null,this.virtualSize=this._calculateVirtualSize());var e=this;if(e._arrange(),e.host.height()!=e._oldheight||e.host.width()!=e._oldwidth){e.host.width(),e._oldwidth;if(e.autoItemsHeight)e._render(!1);else if(e.items)if(e.items.length>0&&e.virtualItemsCount*e.items[0].height<e._oldheight-2)e._render(!1);else{var t=e.vScrollInstance.value;e._updatescrollbars(),e._renderItems(),t<e.vScrollInstance.max?e.vScrollInstance.setPosition(t):e.vScrollInstance.setPosition(e.vScrollInstance.max)}e._oldwidth=e.host.width(),e._oldheight=e.host.height()}},_addHandlers:function(){var t=this;this.focused=!1;new Date;n=this.isTouchDevice();this.addHandler(this.vScrollBar,"valueChanged",function(i){e.jqx.browser.msie&&e.jqx.browser.version>9?setTimeout(function(){t._renderItems()},1):t._renderItems()}),this.addHandler(this.hScrollBar,"valueChanged",function(){t._renderItems()}),this._mousewheelfunc&&this.removeHandler(this.host,"mousewheel",this._mousewheelfunc),this._mousewheelfunc=function(e){t.wheel(e,t)},this.addHandler(this.host,"mousewheel",this._mousewheelfunc),this.addHandler(e(document),"keydown.listbox"+this.element.id,function(e){t._ctrlKey=e.ctrlKey||e.metaKey,t._shiftKey=e.shiftKey}),this.addHandler(e(document),"keyup.listbox"+this.element.id,function(e){t._ctrlKey=e.ctrlKey||e.metaKey,t._shiftKey=e.shiftKey}),this.addHandler(this.host,"keydown",function(e){return t._handleKeyDown(e)}),this.addHandler(this.content,"mouseleave",function(i){t.focused=!1;var s=e.data(t.element,"hoveredItem");null!=s&&(e(s).removeClass(t.toThemeProperty("jqx-listitem-state-hover")),e(s).removeClass(t.toThemeProperty("jqx-fill-state-hover")),e.data(t.element,"hoveredItem",null))}),this.addHandler(this.content,"focus",function(e){t.disabled||(t.host.addClass(t.toThemeProperty("jqx-fill-state-focus")),t.focused=!0)}),this.addHandler(this.content,"blur",function(e){t.focused=!1,t.host.removeClass(t.toThemeProperty("jqx-fill-state-focus"))}),this.addHandler(this.host,"focus",function(e){t.disabled||(t.host.addClass(t.toThemeProperty("jqx-fill-state-focus")),t.focused=!0)}),this.addHandler(this.host,"blur",function(i){e.jqx.browser.msie&&e.jqx.browser.version<9&&t.focused||(t.host.removeClass(t.toThemeProperty("jqx-fill-state-focus")),t.focused=!1)}),this.addHandler(this.content,"mouseenter",function(e){t.focused=!0});var i=e.jqx.utilities.hasTransform(this.host);if(this.enableSelection){var s=t.isTouchDevice()&&!0!==this.touchMode,l=s?"touchend":"mousedown";if(this.overlayContent)this.addHandler(this.overlayContent,e.jqx.mobile.getTouchEventName("touchend"),function(i){if(!t.enableSelection)return!0;if(s&&(t._newScroll=new Date,t._newScroll-t._lastScroll<500))return!0;var l=e.jqx.mobile.getTouches(i)[0];if(void 0!=l){var r=t.host.offset(),n=parseInt(l.pageX),a=parseInt(l.pageY);1==t.touchMode&&void 0!=l._pageX&&(n=parseInt(l._pageX),a=parseInt(l._pageY)),n-=r.left,a-=r.top;var h=t._hitTest(n,a);if(null!=h&&!h.isGroup){if(t._newScroll=new Date,t._newScroll-t._lastScroll<500)return!1;if(t.checkboxes)return void t._updateItemCheck(h,h.visibleIndex);if(-1==h.html.indexOf("href"))return t.selectIndex(h.visibleIndex,!1,!0,!1,"mouse",i),i.preventDefault&&i.preventDefault(),t.content.trigger("click"),!1;setTimeout(function(){return t.selectIndex(h.visibleIndex,!1,!0,!1,"mouse",i),t.content.trigger("click"),!1},100)}}});else{var r=!1;this.addHandler(this.content,l,function(n){if(!t.enableSelection)return!0;if(r=!0,s&&(t._newScroll=new Date,t._newScroll-t._lastScroll<500))return!1;if(t.focused=!0,!t.isTouchDevice()&&t.focusable&&t.host.focus(),n.target.id!="listBoxContent"+t.element.id&&t.itemswrapper[0]!=n.target){var a=n.target,h=e(a).offset(),o=t.host.offset();if(i){var d=e.jqx.mobile.getLeftPos(a),c=e.jqx.mobile.getTopPos(a);h.left=d,h.top=c,d=e.jqx.mobile.getLeftPos(t.element),c=e.jqx.mobile.getTopPos(t.element),o.left=d,o.top=c}var u=parseInt(h.top)-parseInt(o.top),m=parseInt(h.left)-parseInt(o.left),v=t._hitTest(m,u);if(null!=v&&!v.isGroup){var p=function(e,i){if(t._shiftKey||(t._clickedIndex=e.visibleIndex),t.checkboxes)if(m=20+i.pageX-h.left,t.rtl){"hidden"!=t.hScrollBar.css("visibility")?t.hScrollInstance.max:t.host.width();m<=t.host.width()-20&&(t.allowDrag?setTimeout(function(){t._dragItem||r||(t._updateItemCheck(e,e.visibleIndex),t.selectIndex(e.visibleIndex,!1,!0,!1,"mouse",i))},200):(t._updateItemCheck(e,e.visibleIndex),t.selectIndex(e.visibleIndex,!1,!0,!1,"mouse",i)))}else m+t.hScrollInstance.value>=20&&(t.allowDrag?setTimeout(function(){t._dragItem||r||(t._updateItemCheck(e,e.visibleIndex),t.selectIndex(e.visibleIndex,!1,!0,!1,"mouse",i))},200):(t._updateItemCheck(e,e.visibleIndex),t.selectIndex(e.visibleIndex,!1,!0,!1,"mouse",i)));else t.selectIndex(e.visibleIndex,!1,!0,!1,"mouse",i)};v.disabled||(-1!=v.html.indexOf("href")?setTimeout(function(){p(v,n)},100):p(v,n))}if("mousedown"==l){var g=!1;return n.which?g=3==n.which:n.button&&(g=2==n.button),!!g}}return!0})}this.addHandler(this.content,"mouseup",function(e){t.vScrollInstance.handlemouseup(t,e),r=!1}),e.jqx.browser.msie&&this.addHandler(this.content,"selectstart",function(e){return!1})}var n=this.isTouchDevice();this.enableHover&&!n&&(this._mousemovefunc=function(s){if(n)return!0;if(!t.enableHover)return!0;1==e.jqx.browser.msie&&e.jqx.browser.version;if(null==s.target)return!0;if(t.disabled)return!0;if(t.focused=!0,!t.vScrollInstance.isScrolling()&&s.target.id!="listBoxContent"+t.element.id&&t.itemswrapper[0]!=s.target){var l=s.target,r=e(l).offset(),a=t.host.offset();if(i){var h=e.jqx.mobile.getLeftPos(l),o=e.jqx.mobile.getTopPos(l);r.left=h,r.top=o,h=e.jqx.mobile.getLeftPos(t.element),o=e.jqx.mobile.getTopPos(t.element),a.left=h,a.top=o}var d=parseInt(r.top)-parseInt(a.top),c=parseInt(r.left)-parseInt(a.left),u=t._hitTest(c,d);if(null!=u&&!u.isGroup&&!u.disabled){var m=e.data(t.element,"hoveredItem");null!=m&&(e(m).removeClass(t.toThemeProperty("jqx-listitem-state-hover")),e(m).removeClass(t.toThemeProperty("jqx-fill-state-hover"))),e.data(t.element,"hoveredItem",u.element);var v=e(u.element);v.addClass(t.toThemeProperty("jqx-listitem-state-hover")),v.addClass(t.toThemeProperty("jqx-fill-state-hover"))}}},this.addHandler(this.content,"mousemove",this._mousemovefunc))},_arrange:function(e){void 0==e&&(e=!0);var t=this,i=null,s=null,l=t.filterable?t.filterHeight:0,r=function(e){return 0==(e=t.host.height())&&(e=200,t.host.height(e)),e};null!=t.width&&-1!=t.width.toString().indexOf("px")?i=t.width:void 0==t.width||isNaN(t.width)||(i=t.width),null!=t.height&&-1!=t.height.toString().indexOf("px")?s=t.height:void 0==t.height||isNaN(t.height)||(s=t.height),null!=t.width&&-1!=t.width.toString().indexOf("%")&&(t.host.css("width",t.width),i=t.host.width()),null!=t.height&&-1!=t.height.toString().indexOf("%")&&(t.host.css("height",t.height),s=r(s)),null!=i&&(i=parseInt(i),parseInt(t.element.style.width)!=parseInt(t.width)&&t.host.width(t.width)),t.autoHeight?t.virtualSize&&("hidden"!=t.hScrollBar.css("visibility")?(t.host.height(t.virtualSize.height+parseInt(t.scrollBarSize)+3),t.height=t.virtualSize.height+parseInt(t.scrollBarSize)+3,s=t.height):(t.host.height(t.virtualSize.height),t.height=t.virtualSize.height,s=t.virtualSize.height)):null!=s&&(s=parseInt(s),parseInt(t.element.style.height)!=parseInt(t.height)&&(t.host.height(t.height),r(s)));var n=t.scrollBarSize;isNaN(n)&&(n=parseInt(n),isNaN(n)?n="17px":n+="px"),n=parseInt(n);var a=2,h=1;if(t.vScrollBar&&("hidden"!=t.vScrollBar[0].style.visibility?h=n+4:t.vScrollInstance.setPosition(0),0==n&&(h=1,a=1),t.hScrollBar)){"hidden"!=t.hScrollBar[0].style.visibility?a=n+4:t.hScrollInstance.setPosition(0),t.autoItemsHeight&&(t.hScrollBar[0].style.visibility="hidden",a=0),null==s&&(s=0);var o=parseInt(s)-4-n;o<0&&(o=0),parseInt(t.hScrollBar[0].style.height)!=n&&(parseInt(n)<0&&(n=0),t.hScrollBar[0].style.height=parseInt(n)+"px"),t.hScrollBar[0].style.top!=o+"px"&&(t.hScrollBar[0].style.top=o+"px",t.hScrollBar[0].style.left="0px");var d=i-n-4;d<0&&(d=0);var c=d+"px";if(t.hScrollBar[0].style.width!=c&&(t.hScrollBar[0].style.width=c),h<=1&&i>=2&&(t.hScrollBar[0].style.width=parseInt(i-2)+"px"),n!=parseInt(t.vScrollBar[0].style.width)&&(t.vScrollBar[0].style.width=parseInt(n)+"px"),parseInt(s)-a!=parseInt(t.vScrollBar[0].style.height)){var u=parseInt(s)-a;u<0&&(u=0),t.vScrollBar[0].style.height=u+"px"}null==i&&(i=0);var m=parseInt(i)-parseInt(n)-4+"px";m!=t.vScrollBar[0].style.left&&(parseInt(m)>=0&&(t.vScrollBar[0].style.left=m),t.vScrollBar[0].style.top="0px");var v=t.vScrollInstance;v.disabled=t.disabled,e&&v._arrange();var p=t.hScrollInstance;if(p.disabled=t.disabled,e&&p._arrange(),"hidden"!=t.vScrollBar[0].style.visibility&&"hidden"!=t.hScrollBar[0].style.visibility?(t.bottomRight[0].style.visibility="inherit",t.bottomRight[0].style.left=1+parseInt(t.vScrollBar[0].style.left)+"px",t.bottomRight[0].style.top=1+parseInt(t.hScrollBar[0].style.top)+"px",t.rtl&&t.bottomRight.css({left:0}),t.bottomRight[0].style.width=parseInt(n)+3+"px",t.bottomRight[0].style.height=parseInt(n)+3+"px"):t.bottomRight[0].style.visibility="hidden",parseInt(t.content[0].style.width)!=parseInt(i)-h){var g=parseInt(i)-h;g<0&&(g=0),t.content[0].style.width=g+"px"}if(t.rtl&&(t.vScrollBar.css({left:"0px",top:"0px"}),t.hScrollBar.css({left:t.vScrollBar.width()+2+"px"}),"hidden"!=t.vScrollBar[0].style.visibility?t.content.css("margin-left",4+t.vScrollBar.width()):(t.content.css("margin-left",0),t.hScrollBar.css({left:"0px"})),t.filterable&&t.filterInput&&t.filterInput.css({left:t.vScrollBar.width()+6+"px"})),parseInt(t.content[0].style.height)!=parseInt(s)-a){var f=parseInt(s)-a;f<0&&(f=0),t.content[0].style.height=f+"px",t.content[0].style.top="0px"}l>0&&(t.content[0].style.top=l+"px",t.content[0].style.height=parseInt(t.content[0].style.height)-l+"px"),t.filterable?(t.filterInput[0].style.height=l-6+"px",t.filterInput[0].style.top="3px",t.rtl||(t.filterInput[0].style.left=parseInt(t.content.css("left"))+3+"px"),t.filterInput[0].style.width=parseInt(t.content.css("width"))-7+"px",t.filter[0].style.display="block"):t.filter[0].style.display="none",t.overlayContent&&(t.overlayContent.width(parseInt(i)-h),t.overlayContent.height(parseInt(s)-a))}},ensureVisible:function(t,i){if(isNaN(t)&&(s=this.getItemByValue(t))&&(t=s.index),this.isIndexInView(t)){if(i)for(indx=0;indx<this.visibleItems.length;indx++){var s=this.visibleItems[indx];if(s.visibleIndex==t&&!s.isGroup){var l=this.vScrollInstance.value,r=s.initialTop;this.filterable&&(r=this.filterHeight+2+s.initialTop),l+this.host.height()<this.vScrollInstance.max&&this.vScrollInstance.setPosition(r)}}}else{if(t<0)return;if(this.autoHeight)(n=e.data(this.vScrollBar[0],"jqxScrollBar").instance).setPosition(0);else for(indx=0;indx<this.visibleItems.length;indx++)if((s=this.visibleItems[indx]).visibleIndex==t&&!s.isGroup){var n=e.data(this.vScrollBar[0],"jqxScrollBar").instance,l=n.value,a=this.filterable?this.filterHeight+2:0,h="hidden"===this.hScrollBar.css("visibility")?0:this.scrollBarSize+4;if(s.initialTop<l)n.setPosition(s.initialTop),0==indx&&n.setPosition(0);else if(s.initialTop+s.height>l+this.host.height()-a){var o=this.host.height();if(this.filterable?n.setPosition(this.filterHeight+2+s.initialTop+s.height+2-o+h):(n.setPosition(s.initialTop+s.height+2-o+h),indx===this.visibleItems.length-1&&n.setPosition(n.max)),i){var l=n.value,r=s.initialTop;this.filterable&&(r=this.filterHeight+2+s.initialTop),l+o<n.max&&n.setPosition(r)}}break}}this._renderItems()},scrollTo:function(e,t){"hidden"!=this.vScrollBar.css("visibility")&&this.vScrollInstance.setPosition(t),"hidden"!=this.hScrollBar.css("visibility")&&this.hScrollInstance.setPosition(e)},scrollDown:function(){if("hidden"==this.vScrollBar.css("visibility"))return!1;var e=this.vScrollInstance;return e.value+e.largestep<=e.max?(e.setPosition(e.value+e.largestep),!0):(e.setPosition(e.max),!0)},scrollUp:function(){if("hidden"==this.vScrollBar.css("visibility"))return!1;var e=this.vScrollInstance;return e.value-e.largestep>=e.min?(e.setPosition(e.value-e.largestep),!0):e.value!=e.min&&(e.setPosition(e.min),!0)},databind:function(t,i){this.records=new Array;var s=!!t._source,l=new e.jqx.dataAdapter(t,{autoBind:!1});s&&(l=t,t=t._source);var r=function(t,i){var s=function(i){var s=null;if("string"==typeof i)var l=i,r=i,n="";else if(void 0!=t.displayMember&&""!=t.displayMember)var r=i[t.valueMember],l=i[t.displayMember];n="";if(t.groupMember?n=i[t.groupMember]:i&&void 0!=i.group&&(n=i.group),t.searchMember?s=i[t.searchMember]:i&&void 0!=i.searchLabel&&(s=i.searchLabel),t.valueMember||t.displayMember||"string"==e.type(i)&&(l=r=i.toString()),i&&void 0!=i.label)l=i.label;if(i&&void 0!=i.value)r=i.value;var a=!1;i&&void 0!=i.checked&&(a=i.checked);var h="";i&&void 0!=i.html&&(h=i.html);var o=!0;i&&void 0!=i.visible&&(o=i.visible);var d=!1;i&&void 0!=i.disabled&&(d=i.disabled);var c=!1;i&&void 0!=i.hasThreeStates&&(c=i.hasThreeStates);var u={};return u.label=l,u.value=r,u.searchLabel=s,u.html=h,u.visible=o,u.originalItem=i,u.group=n,u.groupHtml="",u.disabled=d,u.checked=a,u.hasThreeStates=c,u};if(void 0!=i&&l._changedrecords[0])e.each(l._changedrecords,function(){var e=this.index,l=this.record;if("remove"!=i)var r=s(l);switch(i){case"update":t.updateAt(r,e);break;case"add":t.insertAt(r,e);break;case"remove":t.removeAt(e)}});else{t.records=l.records;for(var r=t.records.length,n=new Array,a=0;a<r;a++){var h=t.records[a],o=s(h);o.index=a,n[a]=o}t.items=t.loadItems(n,!0),t._render(),t._raiseEvent("6")}};void 0!=t.type&&(l._options.type=t.type),void 0!=t.formatdata&&(l._options.formatData=t.formatdata),void 0!=t.contenttype&&(l._options.contentType=t.contenttype),void 0!=t.async&&(l._options.async=t.async);var n=this;switch(t.datatype){case"local":case"array":default:(null!=t.localdata||e.isArray(t))&&(l.unbindBindingUpdate(this.element.id),(this.autoBind||!this.autoBind&&!i)&&l.dataBind(),r(this),l.bindBindingUpdate(this.element.id,function(e){r(n,e)}));break;case"json":case"jsonp":case"xml":case"xhtml":case"script":case"text":case"csv":case"tab":if(null!=t.localdata)return l.unbindBindingUpdate(this.element.id),(this.autoBind||!this.autoBind&&!i)&&l.dataBind(),r(this),void l.bindBindingUpdate(this.element.id,function(){r(n)});var a={};l._options.data?e.extend(l._options.data,a):(t.data&&e.extend(a,t.data),l._options.data=a);l.unbindDownloadComplete(n.element.id),l.bindDownloadComplete(n.element.id,function(){r(n)}),(this.autoBind||!this.autoBind&&!i)&&l.dataBind()}},loadItems:function(t,i){if(null==t)return this.groups=new Array,this.items=new Array,void(this.visualItems=new Array);var s=this,l=0,r=0,n=0;this.groups=new Array,this.items=new Array,this.visualItems=new Array;var a=new Array;this.itemsByValue=new Array,e.map(t,function(t){if(void 0==t)return null;var h=new e.jqx._jqxListBox.item,o=t.group,d=t.groupHtml,c=t.title,u=null;if(s.searchMember?u=t[s.searchMember]:t&&void 0!=t.searchLabel&&(u=t.searchLabel),null!=c&&void 0!=c||(c=""),null!=o&&void 0!=o||(o=""),s.groupMember&&(o=t[s.groupMember]),null!=d&&void 0!=d||(d=""),!s.groups[o]){s.groups[o]={items:new Array,index:-1,caption:o,captionHtml:d};var m=++l+"jqxGroup";s.groups[m]=s.groups[o],r++,s.groups.length=r}var v=s.groups[o];return v.index++,v.items[v.index]=h,"string"==typeof t?(h.label=t,h.value=t,arguments.length>1&&arguments[1]&&"string"==e.type(arguments[1])&&(h.label=t,h.value=arguments[1])):null==t.label&&null==t.value&&null==t.html&&null==t.group&&null==t.groupHtml?(h.label=t.toString(),h.value=t.toString()):(h.label=t.label,h.value=t.value,void 0===h.label&&(h.label=t.value),void 0===h.value&&(h.value=t.label)),"string"!=typeof t&&(void 0===t.label&&""!=s.displayMember&&(void 0!=t[s.displayMember]?h.label=t[s.displayMember]:h.label=""),void 0===t.value&&""!=s.valueMember&&(h.value=t[s.valueMember])),h.hasThreeStates=void 0==t.hasThreeStates||t.hasThreeStates,h.originalItem=t,i&&(h.originalItem=t.originalItem),h.title=c,c&&void 0===h.value&&void 0===h.label&&(h.value=h.label=c),h.html=t.html||"",t.html&&t.html,h.group=o,h.checked=t.checked||!1,h.groupHtml=t.groupHtml||"",h.disabled=t.disabled||!1,h.visible=void 0==t.visible||t.visible,h.searchLabel=u,h.index=n,a[n]=h,n++,h});var h=new Array,o=0;if(void 0==this.fromSelect||0==this.fromSelect)for(var d=0;d<r;d++){var c=(l=d+1)+"jqxGroup",u=this.groups[c];if(void 0==u||null==u)break;if(0==d&&""==u.caption&&""==u.captionHtml&&r<=1){for(var m=0;m<u.items.length;m++){g=u.items[m].value;void 0!=u.items[m].value&&null!=u.items[m].value||(g=m),this.itemsByValue[e.trim(g).split(" ").join("?")]=u.items[m]}return u.items}var v=new e.jqx._jqxListBox.item;v.isGroup=!0,v.label=u.caption,""==u.caption&&""==u.captionHtml&&(u.caption=this.emptyGroupText,v.label=u.caption),v.html=u.captionHtml,h[o]=v,o++;for(var p=0;p<u.items.length;p++){h[o]=u.items[p];var g=u.items[p].value;""!=u.items[p].value&&null!=u.items[p].value||(g=o),s.itemsByValue[e.trim(g).split(" ").join("?")]=u.items[p],o++}}else{var o=0,f=new Array;e.each(a,function(){if(!f[this.group]&&""!=this.group){var t=new e.jqx._jqxListBox.item;t.isGroup=!0,t.label=this.group,h[o]=t,o++,f[this.group]=!0}h[o]=this;var i=this.value;""!=this.value&&null!=this.value||(i=o-1),s.itemsByValue[e.trim(i).split(" ").join("?")]=this,o++})}return h},_mapItem:function(t){var i=new e.jqx._jqxListBox.item;return this.displayMember&&(void 0==t.label&&(t.label=t[this.displayMember]),void 0==t.value&&(t.value=t[this.valueMember])),"string"==typeof t?(i.label=t,i.value=t):"number"==typeof t?(i.label=t.toString(),i.value=t.toString()):(i.label=void 0!==t.label?t.label:t.value,i.value=void 0!==t.value?t.value:t.label),void 0==i.label&&void 0==i.value&&void 0==i.html&&(i.label=i.value=t),i.html=t.html||"",i.group=t.group||"",i.checked=t.checked||!1,i.title=t.title||"",i.groupHtml=t.groupHtml||"",i.disabled=t.disabled||!1,i.visible=t.visible||!0,i},addItem:function(e){return this.insertAt(e,this.items?this.items.length:0)},_getItemByParam:function(e){if(null!=e&&void 0==e.index){var t=this.getItemByValue(e);t&&(e=t)}return e},insertItem:function(e,t){var i=this._getItemByParam(e);return this.insertAt(i,t)},updateItem:function(e,t){var i=this._getItemByParam(t);return!(!i||void 0==i.index)&&this.updateAt(e,i.index)},updateAt:function(t,i){if(null!=t){var s=this._mapItem(t);this.itemsByValue[e.trim(s.value).split(" ").join("?")]=this.items[i],this.items[i].value=s.value,this.items[i].label=s.label,this.items[i].html=s.html,this.items[i].disabled=s.disabled,this._raiseEvent("9",{item:this.items[i]})}this._cachedItemHtml=[],this._renderItems(),this.rendered&&this.rendered()},insertAt:function(t,i){if(null==t)return!1;if(this._cachedItemHtml=[],void 0==this.items||0==this.items.length){this.source=new Array,this.refresh(),(s=this._mapItem(t)).index=0,this.items[this.items.length]=s,this._addItems(!0),this._renderItems(),this.rendered&&this.rendered(),this.allowDrag&&this._enableDragDrop&&this._enableDragDrop();o=s.value;return""!=s.value&&null!=s.value||(o=i),this.itemsByValue[e.trim(o).split(" ").join("?")]=s,!1}var s=this._mapItem(t);if(-1==i||void 0==i||null==i||i>=this.items.length)s.index=this.items.length,this.items[this.items.length]=s;else{for(var l=new Array,r=0,n=!1,a=0,h=0;h<this.items.length;h++)0==this.items[h].isGroup&&a>=i&&!n&&(l[r++]=s,s.index=i,a++,n=!0),l[r]=this.items[h],this.items[h].isGroup||(l[r].index=a,a++),r++;this.items=l}var o=s.value;""!=s.value&&null!=s.value||(o=i),this.itemsByValue[e.trim(o).split(" ").join("?")]=s,this.visibleItems=new Array,this.renderedVisibleItems=new Array;var d=e.data(this.vScrollBar[0],"jqxScrollBar").instance,c=d.value;return d.setPosition(0),this.allowDrag&&this._enableDragDrop||this.virtualSize&&this.virtualSize.height<10+this.host.height()?this._addItems(!0):this._addItems(!1),this.groups.length,this._renderItems(),this.allowDrag&&this._enableDragDrop&&this._enableDragDrop(),d.setPosition(c),this._raiseEvent("7",{item:s}),this.rendered&&this.rendered(),!0},removeAt:function(t){if(t<0||t>this.items.length-1)return!1;if(void 0==t)return!1;var i=this.items[t].height;""!=(m=this.items[t].value)&&null!=m||(m=t),this.itemsByValue[e.trim(m).split(" ").join("?")]=null;var s=this.items[t];if(this.groups.length>1){for(var l=new Array,r=0;r<this.items.length;r++)this.items[r].isGroup||l.push({item:this.items[r],key:r});if(!l[t])return!1;this.items.splice(l[t].key,1)}else this.items.splice(t,1);for(var n=new Array,a=0,h=0,r=0;r<this.items.length;r++)n[a]=this.items[r],this.items[r].isGroup||(n[a].index=h,h++),a++;this.items=n;var o=e.data(this.vScrollBar[0],"jqxScrollBar").instance,d=(o=e.data(this.vScrollBar[0],"jqxScrollBar").instance).value;if(o.setPosition(0),this.visibleItems=new Array,this.renderedVisibleItems=new Array,this.items.length>0){if(this.virtualSize){this.virtualSize.height-=i;var c=2*this.virtualSize.itemsPerPage;this.autoHeight&&(c=this.items.length),this.virtualItemsCount=Math.min(c,this.items.length)}this._updatescrollbars()}else this._addItems();this._renderItems(),this.allowDrag&&this._enableDragDrop&&this._enableDragDrop(),"hidden"!=this.vScrollBar.css("visibility")?o.setPosition(d):o.setPosition(0),this.itemsByValue=new Array;for(var u=0;u<this.items.length;u++){var m=this.items[u].value;""!=this.items[u].value&&null!=this.items[u].value||(m=u),this.itemsByValue[e.trim(m).split(" ").join("?")]=this.items[u]}return this._raiseEvent("8",{item:s}),0===this.items.length&&(this.selectedIndex=-1,this.selectedValue=null,this._updateInputSelection()),this.rendered&&this.rendered(),!0},removeItem:function(e,t){var i=this._getItemByParam(e),s=-1;if(i&&void 0!=i.index&&!0!==t){for(var l=0;l<this.items.length;l++)if(this.items[l].label==i.label&&this.items[l].value==i.value){s=l;break}if(-1!=s)return this.removeAt(s)}if(-1==s)return this.removeAt(i.index)},getItems:function(){return this.items},disableItem:function(e){var t=this._getItemByParam(e);this.disableAt(t.index)},enableItem:function(e){var t=this._getItemByParam(e);this.enableAt(t.index)},disableAt:function(e){return!!this.items&&(!(e<0||e>this.items.length-1)&&(this.items[e].disabled=!0,this._renderItems(),!0))},enableAt:function(e){return!!this.items&&(!(e<0||e>this.items.length-1)&&(this.items[e].disabled=!1,this._renderItems(),!0))},destroy:function(){this.source&&this.source.unbindBindingUpdate&&this.source.unbindBindingUpdate(this.element.id),this._removeHandlers(),this.vScrollBar.jqxScrollBar("destroy"),this.hScrollBar.jqxScrollBar("destroy"),this.vScrollBar.remove(),this.hScrollBar.remove(),this.content.remove(),e.jqx.utilities.resize(this.host,null,!0);var t=e.data(this.element,"jqxListBox");delete this.hScrollInstance,delete this.vScrollInstance,delete this.vScrollBar,delete this.hScrollBar,delete this.content,delete this.bottomRight,delete this.itemswrapper,delete this.visualItems,delete this.visibleItems,delete this.items,delete this.groups,delete this.renderedVisibleItems,delete this._mousewheelfunc,delete this._mousemovefunc,delete this._cachedItemHtml,delete this.itemsByValue,delete this._activeElement,delete this.source,delete this.events,this.input&&(this.input.remove(),delete this.input),t&&delete t.instance,this.host.removeData(),this.host.removeClass(),this.host.remove(),this.element=null,delete this.element,this.host=null,delete this.set,delete this.get,delete this.call,delete this.host},_raiseEvent:function(t,i){if(1==this._stopEvents)return!0;void 0==i&&(i={owner:null});var s=this.events[t];args=i,args.owner=this,this._updateInputSelection();var l=new e.Event(s);if(l.owner=this,l.args=args,null!=this.host)var r=this.host.trigger(l);return r}})}(jqxBaseFramework),function(e){e.jqx.parseSourceTag=function(t){var i=new Array,s=e(t).find("option"),l=e(t).find("optgroup"),r=!1;0===s.length&&(s=e(t).find("li")).length>0&&(r=!0);var n=null,n=-1,a=new Array;if(e.each(s,function(t){var s=l.find(this).length>0,h=null;null==this.text||null!=this.label&&""!=this.label||(this.label=this.text),!0===r&&(this.label=e(this).text(),this.selected=e(this).attr("data-selected"),this.checked=this.selected,this.value=e(this).attr("data-value")||t,this.disabled=e(this).attr("disabled"));var o={style:this.style.cssText,selected:this.selected,html:this.innerHTML,classes:this.className,disabled:this.disabled,value:this.value,label:this.label,title:this.title,originalItem:this};e.jqx.browser.msie&&e.jqx.browser.version<8&&!r&&""==o.value&&null!=this.text&&this.text.length>0&&(o.value=this.text),s&&(h=l.find(this).parent()[0].label,o.group=h,a[h]||(a[h]=new Array,a.length++),a[h].push(o)),this.selected&&(n=t),o.checked=this.selected,void 0!==o.label&&i.push(o)}),a.length>0){var h=new Array;for(var o in a)if("indexOf"!==o){for(var d=0;d<l.length;d++)if(o===l[d].label||l[d].text){l[d];break}e.each(a[o],function(e,t){void 0!==this.label&&h.push(this)})}}return h&&h.length>0?{items:h,index:n}:{items:i,index:n}},e.jqx._jqxListBox.item=function(){return{group:"",groupHtml:"",selected:!1,isGroup:!1,highlighted:!1,value:null,label:"",html:null,visible:!0,disabled:!1,element:null,width:null,height:null,initialTop:null,top:null,left:null,title:"",index:-1,checkBoxElement:null,originalItem:null,checked:!1,visibleIndex:-1}}}(jqxBaseFramework);


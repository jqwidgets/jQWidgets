/*
jQWidgets v20.0.0 (2024-Sep)
Copyright (c) 2011-2024 jQWidgets.
License: https://jqwidgets.com/license/
*/
/* eslint-disable */

(function(){if(typeof document==="undefined"){return}(function(a){a.jqx.jqxWidget("jqxPivotDesigner","",{});a.extend(a.jqx._jqxPivotDesigner.prototype,{defineInstance:function(){var b={type:"pivotGrid",target:null,dataFields:null};a.extend(true,this,b);return b},_instanceId:0,createInstance:function(e){var g=this.element;var h=this.host;var d=this;if(this.target&&this.target.getInstance){this.target=this.target.getInstance()}var j=[{widget:"jqxWindow",src:"jqxwindow.js"},{widget:"jqxButton",src:"jqxbuttons.js"},{widget:"jqxCheckBox",src:"jqxcheckbox.js"},{widget:"jqxInput",src:"jqxinput.js"},{widget:"jqxScrollBar",src:"jqxscrollbar.js"},{widget:"jqxListBox",src:"jqxlistbox.js"},{widget:"jqxDropDownList",src:"jqxdropdownlist.js"},{widget:"jqxDragDrop",src:"jqxdragdrop.js"}];for(var f in j){if(!window[j[f].widget]){throw new Error("Please include "+j[f].src)}}var c="";if(this._isTouchDevice()){c="class='jqx-grid-menu-item-touch'"}var b="jqx-rc-all jqx-widget jqx-pivotgrid jqx-designer-host"+this.toThemeProperty("jqx-widget-content");h.append("<div class='"+b+"' style='width: 100%; height: 100%; overflow:hidden; onselectstart='return false;' oncontextmenu='return false;''><div class='labelFields jqx-widget' style='position: absolute;'>Pivot Table Fields</div><div class='labelFilters jqx-widget' style='position: absolute;'>Filters</div><div class='labelColumns jqx-widget' style='position: absolute;'>Columns</div><div class='labelRows jqx-widget' style='position: absolute;'>Rows</div><div class='labelValues jqx-widget' style='position: absolute;'>Values</div><div class='divFields' style='position: absolute;'></div><div class='divFilters' style='position: absolute;'></div><div class='divColumns' style='position: absolute;'></div><div class='divRows' style='position: absolute;'></div><div class='divValues' style='position: absolute;'></div></div>");this._listBoxes={fields:d.host.find(".divFields"),rows:d.host.find(".divRows"),columns:d.host.find(".divColumns"),values:d.host.find(".divValues"),filters:d.host.find(".divFilters")};a.jqx.utilities.resize(d.host,function(){d._resize()},false)},destroy:function(){var b=this;a.jqx.utilities.resize(this.host,null,true);if(b.target){delete b.target._pivotDesigner}},_getLocalizedString:function(c){var b=this.target?this.target._localizedStrings:{};switch(c){case"fields":return b.fieldslabel||"Pivot Fields";break;case"calculation":return b.calculation||"Calculation";break;case"filters":return b.filterslabel||"Filters";break;case"rows":return b.rowslabel||"Rows";break;case"columns":return b.columnslabel||"Columns";break;case"values":return b.valueslabel||"Values";break;case"of":return b.of||"of";break;case"to":return b.to||"to";break;case"move":return b.move||"Move";break;case"remove":return b.remove||"Remove";break;case"count":return b.count||"Count";break;case"sum":return b.sum||"Sum";break;case"average":return b.avgerage||"Average";break;case"product":return b.product||"Product";break;case"min":return b.min||"Min";break;case"max":return b.max||"Max";break}if(b[c]){return b[c]}return c},_isTouchDevice:function(){if(this.touchDevice!=undefined){return this.touchDevice}var b=a.jqx.mobile.isTouchDevice();this.touchDevice=b;if(this.touchmode==true){if(a.jqx.browser.msie&&a.jqx.browser.version<9){this.enablehover=false;return false}b=true;a.jqx.mobile.setMobileSimulator(this.element);this.touchDevice=b}else{if(this.touchmode==false){b=false}}if(b&&this.touchModeStyle!=false){this.touchDevice=true;this.host.addClass(this.toThemeProperty("jqx-touch"));this.host.find("jqx-widget-content").addClass(this.toThemeProperty("jqx-touch"));this.host.find("jqx-widget-header").addClass(this.toThemeProperty("jqx-touch"));this.scrollbarsize=this.touchscrollbarsize}return b},_resize:function(){var p=this;var s=p._listBoxes;var n=5;var o=this.host;var q=o.height()-2*n;var r=o.width()-2*n;var d=a("<span style='white-space:nowrap;'></span>");this.host.append(d);var w=0;var f=["fields","filters","rows","columns","values"];for(var t=0;t<f.length;t++){d.text(this._getLocalizedString(f[t]));var u=d.height();if(u>w){w=u}}d.remove();var z=this.host.position();var l=z.left+n,j=z.top+n;j+=n;var c=o.find(".labelFields");c.css({left:l,top:j,width:r-10,height:w});j+=w;var g=(q-3*(w+2*n))/3;var k=(r-n)/2;s.fields.css({left:l,top:j,background:"white"});s.fields.jqxListBox({width:r,height:g,allowDrop:true,allowDrag:true});j+=g+2*n;var v=o.find(".labelFilters");v.css({left:l,top:j,width:k,height:w});var m=o.find(".labelColumns");m.css({left:l+k+n,top:j,width:k,height:w});j+=w;s.filters.css({left:l,top:j});s.filters.jqxListBox({width:k,height:g});s.columns.css({left:l+k+n,top:j});s.columns.jqxListBox({width:k,height:g});j+=g+2*n;var e=o.find(".labelRows");e.css({left:l,top:j,width:k,height:w});var b=o.find(".labelValues");b.css({left:l+k+n,top:j,width:k,height:w});j+=w;o.find(".divRows").css({left:l,top:j});o.find(".divRows").jqxListBox({width:k,height:g});o.find(".divValues").css({left:l+k+n,top:j});o.find(".divValues").jqxListBox({width:k,height:g})},_setupListBoxes:function(){var b=this;var d=b.host;var e=b._listBoxes;for(var c in e){var f=e[c];f.off();f.jqxListBox({allowDrag:true,allowDrop:true,renderer:function(h,g,i){return b._getCustomRendererElement(g,b._listBoxes.fields[0]!=this.host[0])}}).on("dragStart",function(g){e.rows.jqxListBox({dropAction:"copy"});e.columns.jqxListBox({dropAction:"copy"});e.filters.jqxListBox({dropAction:"copy"});e.values.jqxListBox({dropAction:"copy"});e.fields.jqxListBox({dropAction:"copy"})}).on("dragEnd",function(g){b._moveElement(a(this),g.args.dropTargetElement,g.args.index,g.args.value)})}},_moveElement:function(b,g,d,f){var k=this;var c=k._listBoxes;if(g){if(b[0]!=c.fields[0]){b.jqxListBox("removeAt",d)}if(g==c.fields[0]){c.fields.jqxListBox("clear");k._populateListBox(c.fields,k._allFields,"all")}else{if(b[0]!=c.fields[0]||g!=c.values[0]){if(c.rows[0]!=g){k._removeItem(c.rows,f)}if(c.columns[0]!=g){k._removeItem(c.columns,f)}}if(g==c.values[0]){var h=c.values.jqxListBox("getItems");for(var e=0;e<h.length;e++){c.values.jqxListBox("updateAt",{label:h[e].label,value:a.extend({},h[e].value)},e)}k._autoAssignAggregationFunctions()}k._removeDuplicates(c.rows);k._removeDuplicates(c.columns);k._removeDuplicates(c.filters)}k._updateCurrentSettings();k._updateListBoxLabels();var j=a(g).jqxListBox("width");a(g).jqxListBox("width",j+1);a(g).jqxListBox("width",j-1);var j=b.jqxListBox("width");b.jqxListBox("width",j+1);b.jqxListBox("width",j-1);k._updateListBoxLabels();k._refreshPivotGrid(k._targetCurrentSettings)}},refresh:function(){var b=this;if(b.target){b.target._pivotDesigner=this}b._readPivotSettings();b._setupListBoxes();b._resize();b._updateListBoxLabels()},_updateCurrentSettings:function(){var q=this;var e=q._listBoxes;var m=a.extend({},q._targetCurrentSettings);var d={};var h=["rows","columns","values","filters"];for(var g in h){var k=m[h[g]];if(!k){continue}for(var f=0;f<k.length;f++){var n=k[f].dataField+"_"+(k[f]["function"]||"");d[n]=a.extend({},k[f]);delete d[n].dataField;delete d[n].text}}m=a.extend({},q._targetInitSettings);for(var g in h){var k=m[h[g]];if(!k){continue}for(var f=0;f<k.length;f++){var n=k[f].dataField+"_"+(k[f]["function"]||"");d[n]=a.extend(d[n]||{},k[f]);delete d[n].dataField;delete d[n].text}}for(var g in e){var c=e[g];var k=c.jqxListBox("getItems");m[g]=[];for(var f=0;f<k.length;f++){var r=k[f].value.dataField;var o=k[f].value.text;var l=(g=="values")?k[f].value["function"]:undefined;var p={dataField:r,text:o||r};if(l){p["function"]=l}p.text=q._getFieldLabel(l,r);var n=p.dataField+"_"+(l||"");var b=d[n];if(b){a.extend(p,b)}m[g].push(p)}}q._targetCurrentSettings=m},_refreshPivotGrid:function(e){var d=this;var c=new a.jqx.pivot(d.target.source.dataAdapter,e);a(d.target.element).jqxPivotGrid({source:c});var b=a(d.target.element).jqxPivotGrid("getInstance");b._pivotRows.autoResize();b._pivotColumns.autoResize();b.refresh();d._targetCurrentSettings=e},_autoAssignAggregationFunctions:function(){var f=this;var c=f.host.find(".divValues");var e=c.jqxListBox("getItems");var d={};for(var h=0;h<e.length;h++){if(e[h].value["function"]){if(!d[e[h].value.dataField]){d[e[h].value.dataField]={}}d[e[h].value.dataField][e[h].value["function"]]=true}}var k=f.target.source.getFunctions();for(var h=0;h<e.length;h++){var b=false;if(!e[h].value["function"]){if(!d[e[h].value.dataField]){d[e[h].value.dataField]={}}for(var g in k){if(!d[e[h].value.dataField][g]){d[e[h].value.dataField][g]=true;e[h].value["function"]=g;b=true;break}}if(!b){for(var g in k){e[h].value["function"]=g;break}}}}},_updateListBoxLabels:function(){var c=this;c.host.find(".pivot-designer-item-button").off();var g=c._listBoxes;for(var e in g){var h=g[e];var b=h.jqxListBox("getItems");if(!b){continue}for(var d=0;d<b.length;d++){var f=undefined;if(e=="values"){f=b[d].value["function"];if(!f){throw"Unspecified pivot aggregation function"}}b[d].label=c._getFieldLabel(f,b[d].value.dataField);h.jqxListBox("updateAt",{label:b[d].label,value:b[d].value},d)}}c.host.find(".pivot-designer-item-button").off();c.host.find(".pivot-designer-item-button").on("click",function(o){for(var n in g){var p=g[n];var l=p.jqxListBox("getItems");for(var m=0;m<l.length;m++){var k=a(l[m].element).find(".pivot-designer-item-button");if(k.length>0&&k[0]==this){c._showDesignerItemContextMenu(n,m);return}}}})},_showDesignerItemContextMenu:function(e,d){var b=this;if(b._isWindowOpen()){return}var g=b._listBoxes;var f={moveOperations:{}};for(var c in g){if(c==e){continue}f.moveOperations[b._getLocalizedString("move")+" "+b._getLocalizedString("to")+" "+b._getLocalizedString(c)]={dropTarget:c}}if(e=="values"){var j=b.target.source.getFunctions();var h={};for(var c in j){h[b._getLocalizedString(c)]={"function":c}}f.functions=h}b._windowData={type:e,itemIndex:d,fieldSettings:f};if(e=="filters"){if(!this._filtersWindow){this._createFiltersWindow()}this._filtersWindow.jqxWindow("open");this._updateFiltersWindowData()}else{if(!this._settingsWindow){this._createSettingsWindow()}this._settingsWindow.jqxWindow("open");this._updateWindowData()}},_isWindowOpen:function(){return(this._settingsWindow&&this._settingsWindow.jqxWindow("isOpen"))||(this._filtersWindow&&this._filtersWindow.jqxWindow("isOpen"))},_getFieldLabel:function(e,g){if(e){return this._getValueFieldLabel(e,g)}var f=this._targetInitSettings;for(var d in f){if(d=="values"){continue}var c=f[d];for(var b in c){if(c[b].dataField==g&&c[b].text){return c[b].text}}}return g},_getValueFieldLabel:function(e,g){var c=this;var h=c._getLocalizedString(e)||e;var d=undefined;var f=c._targetInitSettings;if(f.values){for(var b in f.values){if(f.values[b].dataField==g&&f.values[b]["function"]==e){d=f.values[b].text;if(d!=undefined){break}}}}return d||h+" "+c._getLocalizedString("of")+" "+g},_removeItem:function(f,g){var b=f.jqxListBox("getItems");var d=0;for(var c=0;c<b.length;c++){var e=f.jqxListBox("getItem",c);if(e.value.dataField==g.dataField){f.jqxListBox("removeAt",c-d);d++}}},_getCustomRendererElement:function(c,b){if(!b){return"<div><div style='height: 16px; float:left; margin-top: 2px;'></div><div>"+c+"</div></div>"}return"<div><div style='width: 16px;height: 16px; float:left; margin-top: 1px;' class='pivot-designer-item-button jqx-pivotgrid-settings-icon'></div><div>"+c+"</div></div>"},_readPivotSettings:function(){var j=this;if(!j.target){return}var b=j.target.source;if(!b){return}var g=b.dataAdapter;if(!g){return}var e=g._source;if(!e){return}j._targetCurrentSettings=a.extend({},j.target.source._initSettings);j._targetInitSettings=a.extend({},j.target.source._initSettings);var f={};var d={dataFields:this.dataFields,adapterDataFields:e.datafields,rows:j.target.source.rows,columns:j.target.source.columns,values:j.target.source.values,filters:j.target.source.filters};function h(k,n,l){if(!Array.isArray(k)){return}for(var m=0;m<k.length;m++){var o=k[m].name||k[m].dataField;if(!o||o.length==0){continue}if(!n[o]){n[o]={text:o,dataField:o}}if(undefined!=k[m].text&&l!="values"){n[o].text=k[m].text}n[o]["function"]=k[m]["function"]}}if(Array.isArray(d.dataFields)){h(d.dataFields,f)}else{h(d.adapterDataFields,f)}h(d.filters,f,"filters");h(d.rows,f,"rows");h(d.columns,f,"columns");h(d.values,f,"values");this._allFields=f;var i=j.host;var c=j._listBoxes;j._populateListBox(c.fields,f,"all");j._populateListBox(c.filters,d.filters,"filters");j._populateListBox(c.rows,d.rows,"rows");j._populateListBox(c.columns,d.columns,"columns");j._populateListBox(c.values,d.values,"values")},_populateListBox:function(f,b,c){var d=[];var j=0;for(var e in b){var h=b[e].dataField;var g=b[e].text||this._allFields[h].text||h;d[j]={text:g,value:{text:g,dataField:h,"function":b[e]["function"]||undefined}};if(c!="values"){d[j].value["function"]=undefined}j++}f.jqxListBox({source:d,displayMember:"text",valueMember:"value"})},_removeDuplicates:function(f){var b=f.jqxListBox("getItems");var g={};var e=false;for(var c=0;c<b.length;c++){var d=b[c].label;if(g[d]!=undefined){f.jqxListBox("removeAt",c);b.splice(c,1);c--}else{g[d]=true}}},_createSettingsWindow:function(){var d=this;var c="<div id='pivotFieldSettingsWindow' style='width: 300px; height: 200px'><table style='width: 100%;'><tr><td style='height: 30px;'>"+d._getLocalizedString("move")+" "+d._getLocalizedString("to")+"</td><td><div style='width: 100%;' class='lbPivotFieldMoveTo'></div></td></tr><tr><td style='height: 30px;'>"+d._getLocalizedString("alignment")+"</td><td><div style='width: 100%;' class='lbAlignment'></div></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("calculation")+"</td><td><div style='width: 100%;' class='lbCalculation'></div></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("numberformat")+"</td><td></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("cellalignment")+"</td><td><div style='width: 100%;' class='lbCellsAlignment'></div></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("prefix")+"</td><td><input type='text' style='width: 100%;' class='txtPrefix'></input></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("decimalplacestext")+"</td><td><input type='text' style='width: 100%;' class='txtDecimalPlaces'></input></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("thousandsseparatortext")+"</td><td><input type='text' style='width: 100%;' class='txtThousandsSeparator'></input></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("decimalseparatortext")+"</td><td><input type='text' style='width: 100%;' class='txtDecimalSeparator'></input></td></tr><tr class='valueField'><td style='height: 30px;'>"+d._getLocalizedString("nagativebracketstext")+"</td><td><div style='width: 100%;' class='checkBoxNagativeWithBrackets'></input></td></tr><tr><td style='height: 30px;' colspan=2 align=middle><input class='btnOk' type='button' value='"+d._getLocalizedString("ok")+"'></input><input class='btnCancel' style='margin-left: 10px;' type='button' value='"+d._getLocalizedString("cancel")+"'></input></td></tr></table>";d.host.append(c);var e=380;var b=360;d._settingsWindow=d.host.find("#pivotFieldSettingsWindow").jqxWindow({title:d._getLocalizedString("fieldsettings"),position:{x:0,y:0},showCollapseButton:true,autoOpen:false,minWidth:e,maxWidth:e,width:e,height:b,initContent:function(){d._updateWindowData();var g=d._settingsWindow.find(".btnCancel").jqxButton({width:80});var f=d._settingsWindow.find(".btnOk").jqxButton({width:80});g.on("click",function(){d._settingsWindow.jqxWindow("close")});f.on("click",function(){d._applySettingsWindowChanges();d._settingsWindow.jqxWindow("close")})}})},_applySettingsWindowChanges:function(){var j=this;var t=j._windowData.itemIndex;var v=j._windowData.type;var l=j._listBoxes[v];var s=l.jqxListBox("getItem",t);var c=j._settingsWindow.find(".lbPivotFieldMoveTo");var e=c.jqxDropDownList("selectedIndex");if(e!=-1){var o=undefined;for(var q in j._windowData.fieldSettings.moveOperations){o=j._windowData.fieldSettings.moveOperations[q].dropTarget;if(--e==-1){break}}var w=j._listBoxes[o];var m=s.value;if(w!=j._listBoxes.fields){w.jqxListBox("addItem",{label:s.label,value:m})}j._moveElement(l,w[0],t,m);return}var r=j._settingsWindow.find(".lbAlignment");var b=r.jqxDropDownList("getSelectedItem");j._targetCurrentSettings[v][t].align=b.value;delete j._targetCurrentSettings[v][t]["function"];if(v=="values"){var f=j._settingsWindow.find(".lbCalculation");var b=f.jqxDropDownList("getSelectedItem");j._targetCurrentSettings[v][t].text=s.value.text=s.label=j._getFieldLabel(b.value,s.value.dataField);j._targetCurrentSettings[v][t]["function"]=s.value["function"]=b.value;l.jqxListBox("updateAt",{label:s.value.text,value:s.value},t);j._updateListBoxLabels()}if(v=="values"){var k=j._settingsWindow.find(".lbCellsAlignment");var b=k.jqxDropDownList("getSelectedItem");var n=j._targetCurrentSettings[v][t].formatSettings||{};n.align=b.value;j._targetCurrentSettings[v][t].formatSettings=n}if(v=="values"){var g=j._settingsWindow.find(".txtPrefix");var n=j._targetCurrentSettings[v][t].formatSettings||{};n.prefix=g.val();j._targetCurrentSettings[v][t].formatSettings=n}if(v=="values"){var h=j._settingsWindow.find(".txtDecimalPlaces");var n=j._targetCurrentSettings[v][t].formatSettings||{};n.decimalPlaces=h.val();j._targetCurrentSettings[v][t].formatSettings=n}if(v=="values"){var u=j._settingsWindow.find(".txtThousandsSeparator");var n=j._targetCurrentSettings[v][t].formatSettings||{};n.thousandsSeparator=u.val();j._targetCurrentSettings[v][t].formatSettings=n}if(v=="values"){var p=j._settingsWindow.find(".txtDecimalSeparator");var n=j._targetCurrentSettings[v][t].formatSettings||{};n.decimalSeparator=p.val();j._targetCurrentSettings[v][t].formatSettings=n}if(v=="values"){var d=j._settingsWindow.find(".checkBoxNagativeWithBrackets");var n=j._targetCurrentSettings[v][t].formatSettings||{};n.negativeWithBrackets=d.val();j._targetCurrentSettings[v][t].formatSettings=n}j._refreshPivotGrid(j._targetCurrentSettings)},_updateWindowData:function(){var t=this;var y=t._windowData.fieldSettings;var n=t._listBoxes[t._windowData.type].jqxListBox("getItem",t._windowData.itemIndex).value;var H=t.target.source[t._windowData.type];var d=undefined;for(var B=0;B<H.length;B++){if(H[B]["dataField"]==n.dataField&&H[B]["function"]==n["function"]){d=H[B];break}}var s=[];for(var B in y.moveOperations){s.push({text:B,value:y.moveOperations[B]})}var c=t._settingsWindow.find(".lbPivotFieldMoveTo");c.jqxDropDownList({source:s,displayMember:"text",selectedIndex:-1,valueMember:"value",autoDropDownHeight:true});var I=s=[{text:t._getLocalizedString("left"),value:"left"},{text:t._getLocalizedString("center"),value:"center"},{text:t._getLocalizedString("right"),value:"right"}];var h=0;if(d){for(var z=0;z<s.length;z++){if(s[z].value==d.align){h=z;break}}}var C=t._settingsWindow.find(".lbAlignment");C.jqxDropDownList({source:s,selectedIndex:h,displayMember:"text",valueMember:"value",autoDropDownHeight:true});var p=390;if(y.functions){var D=n["function"];t._settingsWindow.find(".valueField").show();s=[];h=-1;var w=0;for(var B in y.functions){var o=y.functions[B]["function"];s.push({text:B,value:o});if(D==o){h=w}w++}var m=t._settingsWindow.find(".lbCalculation");m.jqxDropDownList({source:s,displayMember:"text",valueMember:"value",autoDropDownHeight:true,selectedIndex:h});s=I;var h=2;var r="right";if(d){if(d.formatSettings&&d.formatSettings.align){r=d.formatSettings.align}for(var z=0;z<s.length;z++){if(s[z].value==r){h=z;break}}}var u=t._settingsWindow.find(".lbCellsAlignment");u.jqxDropDownList({source:s,selectedIndex:h,displayMember:"text",valueMember:"value",autoDropDownHeight:true});var x="";if(d&&d.formatSettings&&d.formatSettings.prefix!=undefined){x=d.formatSettings.prefix}var v=t._settingsWindow.find(".txtPrefix");v.jqxInput({value:x,height:23,width:195});var b=2;try{if(d&&d.formatSettings&&d.formatSettings.decimalPlaces!=undefined){b=parseInt(d.formatSettings.decimalPlaces)}}catch(E){b=2}var F=t._settingsWindow.find(".txtDecimalPlaces");F.jqxInput({value:b,height:23,width:195});var f=t._getLocalizedString("thousandsseparator");if(d&&d.formatSettings&&d.formatSettings.thousandsSeparator!=undefined){f=d.formatSettings.thousandsSeparator}var A=t._settingsWindow.find(".txtThousandsSeparator");A.jqxInput({value:f,height:23,width:195});var l=t._getLocalizedString("decimalseparator");if(d&&d.formatSettings&&d.formatSettings.decimalSeparator!=undefined){l=d.formatSettings.decimalSeparator}var q=t._settingsWindow.find(".txtDecimalSeparator");q.jqxInput({value:l,height:23,width:195});var G=false;if(d&&d.formatSettings&&d.formatSettings.negativeWithBrackets!=undefined){G=d.formatSettings.negativeWithBrackets==true}var g=t._settingsWindow.find(".checkBoxNagativeWithBrackets");g.jqxCheckBox({checked:G})}else{p=160;t._settingsWindow.find(".valueField").hide()}t._settingsWindow.jqxWindow({height:p})},_createFiltersWindow:function(){var d=this;var c="<div id='pivotFieldFiltersWindow' style='width: 300px; height: 340px;'><div style='padding: 5; margin: 5; width: 100%; height: 100%;'><table style='width: 100%; height: 100%; margin:0; padding:0;' cellspacing=0; cellpadding=0><tr style='height: auto;'><td style='height: 100%;'><div style='padding: 0px; margin: 0px; display:inline-block;position:relative;' class='listBoxFilters'></div></td></tr><tr style='height: 5px;'><td></td></tr><tr style='height: 30px;'><td colspan=2 align=middle><input class='btnOk' type='button' value='"+d._getLocalizedString("ok")+"'></input><input class='btnCancel' style='margin-left: 10px;' type='button' value='"+d._getLocalizedString("cancel")+"'></input></td></tr></div></table>";d.host.append(c);var e=300;var b=360;d._filtersWindow=d.host.find("#pivotFieldFiltersWindow").jqxWindow({title:d._getLocalizedString("fieldsettings"),position:{x:0,y:0},showCollapseButton:true,autoOpen:false,minWidth:e,maxWidth:e,width:e,height:b,initContent:function(){d._updateFiltersWindowData();var g=d._filtersWindow.find(".btnCancel").jqxButton({width:80});var f=d._filtersWindow.find(".btnOk").jqxButton({width:80});g.on("click",function(){d._filtersWindow.jqxWindow("close")});f.on("click",function(){d._applyFiltersWindowChanges();d._filtersWindow.jqxWindow("close")})}})},_updateFiltersWindowData:function(){var k=this;var e=k._windowData.fieldSettings;var d=k._listBoxes[k._windowData.type].jqxListBox("getItem",k._windowData.itemIndex).value;var g=k.target.source[k._windowData.type];var j=undefined;for(var f=0;f<g.length;f++){if(g[f]["dataField"]==d.dataField&&g[f]["function"]==d["function"]){j=g[f];break}}var c=[];for(var f in e.moveOperations){c.push({text:f,value:e.moveOperations[f]})}c=[];var h=k.target.source.getItemsFilterStatus(j.dataField);for(var f in h){c.push({label:f,value:h[f]})}var b=k._filtersWindow.find(".listBoxFilters");b.jqxListBox({source:c,checkBoxes:true,displayMember:"label",selectedIndex:-1,valueMember:"value",width:"100%",height:"100%"});b.jqxListBox("beginUpdate");b.jqxListBox("checkAll");for(var f=0;f<c.length;f++){if(c[f].value){b.jqxListBox("uncheckIndex",f)}}b.jqxListBox("endUpdate")},_applyFiltersWindowChanges:function(){var m=this;var d=m._filtersWindow.find(".listBoxFilters");var j=d.jqxListBox("getItems");var f=[];for(var e=0;e<j.length;e++){if(!j[e].checked){f.push(j[e].label)}}var k="filterFunction = function(value) {";for(var e=0;e<f.length;e++){k+="if (value == '"+f[e]+"') return true;"}k+="return false;";k+="}";var c=m._windowData.itemIndex;var h=m._windowData.type;var b=m._listBoxes[h];var l=b.jqxListBox("getItem",c);var g=m._targetCurrentSettings;for(var e=0;e<g.filters.length;e++){if(g.filters[e].dataField==l.value.dataField){g.filters[e].filterFunction=a.globalEval(k)}}m._refreshPivotGrid(m._targetCurrentSettings)}})})(jqxBaseFramework)})();

